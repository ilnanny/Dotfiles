<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.gentoo.org/wiki/Handbook:AMD64/Working/Initscripts/ru by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Jan 2016 17:42:19 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Handbook:AMD64/Working/Initscripts - Gentoo Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgCanonicalNamespace":"Handbook","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":560,"wgPageName":"Handbook:AMD64/Working/Initscripts/ru","wgTitle":"AMD64/Working/Initscripts/ru","wgCurRevisionId":189774,"wgRevisionId":189774,"wgArticleId":76702,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":!1,"wgPageContentLanguage":"ru","wgPageContentModel":"wikitext","wgSeparatorTransformTable":[",\t."," \t,"],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","январь","февраль","март","апрель","май","июнь","июль","август","сентябрь","октябрь","ноябрь","декабрь"],"wgMonthNamesShort":["","янв","фев","мар","апр","май","июн","июл","авг","сен","окт","ноя","дек"],"wgRelevantPageName":"Handbook:AMD64/Working/Initscripts/ru","wgRelevantArticleId":76702,
"wgIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[],"sfgAutocompleteValues":[],"sfgAutocompleteOnAllChars":!1,"sfgFieldProperties":[],"sfgCargoFields":[],"sfgDependentFields":[],"sfgShowOnSelect":[],"sfgScriptPath":"/extensions/SemanticForms","edgValues":null,"sfgEDSettings":null,"wgWikiEditorEnabledModules":{"toolbar":!0,"dialogs":!0,"preview":!0,"publish":!1},"wgULSAcceptLanguageList":["en","*"],"wgULSCurrentAutonym":"English","wgTranslatePageTranslation":"translation"});mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});mw.loader.load(["ext.translate","ext.smw.style","mediawiki.page.startup","mediawiki.legacy.wikibits","ext.uls.init"]);
} );</script>
<link rel="stylesheet" href="https://wiki.gentoo.org/load.php?debug=false&amp;lang=en&amp;modules=ext.pygments%7Cext.uls.nojs%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.tyrian.styles&amp;only=styles&amp;skin=tyrian" />
<link rel="stylesheet" href="https://wiki.gentoo.org/load.php?debug=false&amp;lang=en&amp;modules=ext.smw.style%7Cext.smw.tooltip.styles&amp;only=styles&amp;skin=tyrian" />
<link rel="stylesheet" href="https://1b9a50f4f9de4348cd9f-e703bc50ba0aa66772a874f8c7698be7.ssl.cf5.rackcdn.com/bootstrap.min.css" />
<link rel="stylesheet" href="https://1b9a50f4f9de4348cd9f-e703bc50ba0aa66772a874f8c7698be7.ssl.cf5.rackcdn.com/tyrian.min.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="https://wiki.gentoo.org/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=tyrian" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}</style>
<script async="" src="https://wiki.gentoo.org/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=tyrian"></script>
<meta name="generator" content="MediaWiki 1.26.2-gentoo" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#54487a" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#54487a" />
<link rel="ExportRDF" type="application/rdf+xml" title="Handbook:AMD64/Working/Initscripts/ru" href="https://wiki.gentoo.org/index.php?title=Special:ExportRDF/Handbook:AMD64/Working/Initscripts/ru&amp;xmlmime=rdf" />
<link rel="shortcut icon" href="https://wiki.gentoo.org/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="https://wiki.gentoo.org/opensearch_desc.php" title="Gentoo Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://wiki.gentoo.org/api.php?action=rsd" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="Gentoo Wiki Atom feed" href="https://wiki.gentoo.org/index.php?title=Special:RecentChanges&amp;feed=atom" />
</head>
<body class="mediawiki ltr sitedir-ltr ns-560 ns-subject page-Handbook_AMD64_Working_Initscripts_ru skin-tyrian action-view">
	<div class="mw-jump sr-only">
		Jump to:		<a href="#top">content</a>
	</div>
	<header>
		<div class="site-title">
			<div class="container">
				<div class="row">
					<div class="site-title-buttons">
						<div class="btn-group btn-group-sm">
							<a href="https://get.gentoo.org/" role="button" class="btn get-gentoo"><span class="fa fa-fw fa-download"></span> <strong>Get Gentoo!</strong></a>
							<div class="btn-group btn-group-sm">
								<a class="btn gentoo-org-sites dropdown-toggle" data-toggle="dropdown" data-target="#" href="#">
									<span class="fa fa-fw fa-map-o"></span> <span class="hidden-xs">gentoo.org sites</span> <span class="caret"></span>
								</a>
								<ul class="dropdown-menu dropdown-menu-right">
									<li><a href="https://www.gentoo.org/" title="Main Gentoo website"><span class="fa fa-home fa-fw"></span> gentoo.org</a></li>
									<li><a href="https://wiki.gentoo.org/" title="Find and contribute documentation"><span class="fa fa-file-text-o fa-fw"></span> Wiki</a></li>
									<li><a href="https://bugs.gentoo.org/" title="Report issues and find common issues"><span class="fa fa-bug fa-fw"></span> Bugs</a></li>
									<li><a href="https://forums.gentoo.org/" title="Discuss with the community"><span class="fa fa-comments-o fa-fw"></span> Forums</a></li>
									<li><a href="https://packages.gentoo.org/" title="Find software for your Gentoo"><span class="fa fa-hdd-o fa-fw"></span> Packages</a></li>
									<li class="divider"></li>
									<li><a href="https://planet.gentoo.org/" title="Find out what's going on in the developer community"><span class="fa fa-rss fa-fw"></span> Planet</a></li>
									<li><a href="https://archives.gentoo.org/" title="Read up on past discussions"><span class="fa fa-archive fa-fw"></span> Archives</a></li>
									<li><a href="https://sources.gentoo.org/" title="Browse our source code"><span class="fa fa-code fa-fw"></span> Sources</a></li>
									<li class="divider"></li>
									<li><a href="https://infra-status.gentoo.org/" title="Get updates on the services provided by Gentoo"><span class="fa fa-server fa-fw"></span> Infra Status</a></li>
								</ul>
							</div>
						</div>
					</div>
					<div class="logo">
						<a href="https://wiki.gentoo.org/" title="Back to the homepage" class="site-logo"><object data="https://1b9a50f4f9de4348cd9f-e703bc50ba0aa66772a874f8c7698be7.ssl.cf5.rackcdn.com/site-logo.svg" type="image/svg+xml">
							<img src="https://1b9a50f4f9de4348cd9f-e703bc50ba0aa66772a874f8c7698be7.ssl.cf5.rackcdn.com/site-logo.png" alt="Gentoo Linux Logo">
						</object></a>
						<span class="site-label">Wiki</span>
					</div>
				</div>
			</div>
		</div>
		<nav class="tyrian-navbar" role="navigation">
			<div class="container">
				<div class="row">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
					</div>
					<div class="collapse navbar-collapse navbar-main-collapse">
						<ul class="nav navbar-nav">
							<li id="n-mainpage-description"><a href="../../../Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li><li id="n-recentchanges"><a href="../../../Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-help"><a href="../../../Special_MyLanguage/Help_Contents.html" title="The place to find out">Help</a></li>			<li class="dropdown">
				<a href="../../../Gentoo_Wiki_Menu-Gentoo.html" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Gentoo <span class="caret"></span></a>
				<ul class="dropdown-menu" role="menu">
		<li id="n-Gentoo-Projects"><a href="../../../Project_Gentoo.html">Gentoo Projects</a></li>				</ul>
			</li>
					<li class="dropdown">
				<a href="../../../Gentoo_Wiki_Menu-Documentation.html" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Documentation <span class="caret"></span></a>
				<ul class="dropdown-menu" role="menu">
		<li id="n-Gentoo-Handbook"><a href="../../../Handbook_Main_Page.html">Gentoo Handbook</a></li><li id="n-Gentoo-FAQ"><a href="../../../FAQ.html">Gentoo FAQ</a></li><li id="n-Featured-Documents"><a href="../../../Project_Documentation/Overview.html">Featured Documents</a></li><li role="presentation" class="divider"></li><li role="presentation" class="dropdown-header">Topics</li><li id="n-Core-system"><a href="../../../Category_Core_system.html">Core system</a></li><li id="n-Hardware"><a href="../../../Category_Hardware.html">Hardware</a></li><li id="n-Software"><a href="../../../Category_Software.html">Software</a></li><li id="n-Desktop"><a href="../../../Category_Desktop.html">Desktop</a></li><li id="n-Server-.26-Security"><a href="../../../Category_Server_and_Security.html">Server &amp; Security</a></li><li id="n-Project-.26-Community"><a href="../../../Category_Project_and_Community.html">Project &amp; Community</a></li>				</ul>
			</li>
								</ul>
						<ul class="nav navbar-nav navbar-right hidden-xs">
									<li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-cog"></i> Tools <span class="caret"></span></a>
			<ul class="dropdown-menu" role="menu">
				<li id="t-whatlinkshere"><a href="../../../Special_WhatLinksHere/Handbook_AMD64/Working/Initscripts/ru.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="../../../Special_RecentChangesLinked/Handbook_AMD64/Working/Initscripts/ru.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="../../../Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Working/Initscripts/ru&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Working/Initscripts/ru&amp;oldid=189774" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Working/Initscripts/ru&amp;action=info" title="More information about this page">Page information</a></li><li id="t-smwbrowselink"><a href="../../../Special_Browse/Handbook_AMD64-2FWorking-2FInitscripts-2Fru.html" rel="smw-browse">Browse properties</a></li>			</ul>
		</li>
			<li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
				<span class="glyphicon glyphicon-user" aria-label="Personal tools"></span>
				User				<span class="caret"></span>
			</a>
			<ul class="dropdown-menu" role="menu">
				<li id="pt-createaccount"><a href="https://wiki.gentoo.org/index.php?title=Special:UserLogin&amp;returnto=Handbook%3AAMD64%2FWorking%2FInitscripts%2Fru&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="https://wiki.gentoo.org/index.php?title=Special:UserLogin&amp;returnto=Handbook%3AAMD64%2FWorking%2FInitscripts%2Fru" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>			</ul>
		</li>
								</ul>
					</div>
				</div>
			</div>
		</nav>
		
		<nav class="navbar navbar-grey navbar-stick" id="wiki-actions" role="navigation">
			<div class="container"><div class="row">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#gw-toolbar">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
				</div>
				<div class="collapse navbar-collapse" id="gw-toolbar">
					<ul class="nav navbar-nav">
					<li id="ca-nstab-handbook" class="selected active"><a href="ru.html">Handbook</a></li><li id="ca-talk" class="new"><a href="https://wiki.gentoo.org/index.php?title=Handbook_Talk:AMD64/Working/Initscripts/ru&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>					</ul>
							<form action="https://wiki.gentoo.org/index.php" id="searchform" class="navbar-form navbar-right" role="search">
			<input type='hidden' name="title" value="Special:Search"/>

				<div class="input-group">
					<input type="search" name="search" placeholder="Search" title="Search Gentoo Wiki [f]" accesskey="f" id="searchInput" class="form-control" />					<div class="input-group-btn"><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton btn btn-default" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton btn btn-default" /></div>
				</div>
		</form>
						<ul class="nav navbar-nav navbar-right hidden-xs">
					<li id="ca-viewsource"><a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Working/Initscripts/ru&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">more <span class="caret"></span></a>
						<ul class="dropdown-menu" role="menu">
					<li id="ca-history"><a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Working/Initscripts/ru&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>							</ul>
						</li>
					</ul>
				</div>
			</div></div>
		</nav>
		</header>
	
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div id="content" class="mw-body" role="main">
						<a id="top"></a>
						
						<h1 id="firstHeading" class="first-header" lang="ru">
							<span dir="auto">Handbook:AMD64/Working/Initscripts</span>
						</h1>

						<div id="bodyContent" class="mw-body-content">
							<div id="siteSub">From Gentoo Wiki</div>
							<div id="contentSub">
								<span class="subpages"><a href="../../../Special_MyLanguage/Handbook_AMD64.html" title="Special:MyLanguage/Handbook:AMD64">Handbook:AMD64</a></span>							</div>
																					<div id="jump-to-nav" class="mw-jump">
								Jump to:								<a href="#column-one">navigation</a>, 								<a href="#searchInput">search</a>
							</div>

							<!-- start content -->
							<div id="mw-content-text" lang="ru" dir="ltr" class="mw-content-ltr"><div class="mw-translate-page-info" lang="en" dir="ltr">This page is a <span class="plainlinks"><a rel="nofollow" class="external text" href="http://wiki.gentoo.org/index.php?title=Special:Translate&amp;group=page-Handbook%3AAMD64%2FWorking%2FInitscripts&amp;action=page&amp;filter=&amp;language=ru">translated version</a></span> of the page <a href="../Initscripts.html" title="Handbook:AMD64/Working/Initscripts">Handbook:AMD64/Working/Initscripts</a> and the translation is 100% complete.</div>
<hr /><div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Arbeiten/Initskripts (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Initscripts.html" title="Handbook:AMD64/Working/Initscripts (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Working/Initscripts/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/ワーキング/Initscripts (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Working/Initscripts/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">русский</span> • ‎<a href="zh-cn.html" title="手册：AMD64/使用Gentoo/初始化脚本（Initscript）系统 (100% translated)" class="mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</a></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Установка
</th></tr>
<tr>
<td> <a href="../../Installation/About/ru.html" title="Handbook:AMD64/Installation/About/ru">Об установке</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media/ru.html" title="Handbook:AMD64/Installation/Media/ru">Выбор подходящего источника для установки</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking/ru.html" title="Handbook:AMD64/Installation/Networking/ru">Настройка сети</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks/ru.html" title="Handbook:AMD64/Installation/Disks/ru">Подготовка дисков</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage/ru.html" title="Handbook:AMD64/Installation/Stage/ru">Установка stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base/ru.html" title="Handbook:AMD64/Installation/Base/ru">Установка базовой системы</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel/ru.html" title="Handbook:AMD64/Installation/Kernel/ru">Настройка ядра</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System/ru.html" title="Handbook:AMD64/Installation/System/ru">Настройка системы</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools/ru.html" title="Handbook:AMD64/Installation/Tools/ru">Установка системных средств</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader/ru.html" title="Handbook:AMD64/Installation/Bootloader/ru">Настройка начального загрузчика</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing/ru.html" title="Handbook:AMD64/Installation/Finalizing/ru">Завершение</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Работа с Gentoo
</th></tr>
<tr>
<td> <a href="../Portage/ru.html" title="Handbook:AMD64/Working/Portage/ru">Введение в Portage</a>
</td></tr>
<tr>
<td> <a href="../USE/ru.html" title="Handbook:AMD64/Working/USE/ru">USE-флаги</a>
</td></tr>
<tr>
<td> <a href="../Features/ru.html" title="Handbook:AMD64/Working/Features/ru">Возможности Portage</a>
</td></tr>
<tr>
<td> <strong class="selflink">Сценарии инициализации</strong>
</td></tr>
<tr>
<td> <a href="../EnvVar/ru.html" title="Handbook:AMD64/Working/EnvVar/ru">Переменные окружения</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Работа с Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files/ru.html" title="Handbook:AMD64/Portage/Files/ru">Файлы и каталоги</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables/ru.html" title="Handbook:AMD64/Portage/Variables/ru">Переменные</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches/ru.html" title="Handbook:AMD64/Portage/Branches/ru">Смешение ветвей программного обеспечения</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools/ru.html" title="Handbook:AMD64/Portage/Tools/ru">Дополнительные средства</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree/ru.html" title="Handbook:AMD64/Portage/CustomTree/ru">Отступление от официального дерева</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced/ru.html" title="Handbook:AMD64/Portage/Advanced/ru">Расширенные возможности</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Настройка сети
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction/ru.html" title="Handbook:AMD64/Networking/Introduction/ru">Начальная настройка</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced/ru.html" title="Handbook:AMD64/Networking/Advanced/ru">Расширенная настройка</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular/ru.html" title="Handbook:AMD64/Networking/Modular/ru">Модульное построение сети</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless/ru.html" title="Handbook:AMD64/Networking/Wireless/ru">Беспроводная сеть</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending/ru.html" title="Handbook:AMD64/Networking/Extending/ru">Добавляем функциональность</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic/ru.html" title="Handbook:AMD64/Networking/Dynamic/ru">Динамическое управление</a>
</td></tr></table>
<p><br />
</p>
<div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#.D0.A3.D1.80.D0.BE.D0.B2.D0.BD.D0.B8_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0"><span class="tocnumber">1</span> <span class="toctext">Уровни запуска</span></a>
<ul>
<li class="toclevel-2"><a href="#.D0.9F.D1.80.D0.BE.D1.86.D0.B5.D1.81.D1.81_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B8_.D1.81.D0.B8.D1.81.D1.82.D0.B5.D0.BC.D1.8B"><span class="tocnumber">1.1</span> <span class="toctext">Процесс загрузки системы</span></a></li>
<li class="toclevel-2"><a href="#.D0.A1.D1.86.D0.B5.D0.BD.D0.B0.D1.80.D0.B8.D0.B8_.D0.B8.D0.BD.D0.B8.D1.86.D0.B8.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8"><span class="tocnumber">1.2</span> <span class="toctext">Сценарии инициализации</span></a></li>
<li class="toclevel-2"><a href="#.D0.9A.D0.B0.D0.BA_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82_init"><span class="tocnumber">1.3</span> <span class="toctext">Как работает init</span></a></li>
<li class="toclevel-2"><a href="#.D0.A1.D1.83.D1.89.D0.B5.D1.81.D1.82.D0.B2.D1.83.D1.8E.D1.89.D0.B8.D0.B5_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D0.B8_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0"><span class="tocnumber">1.4</span> <span class="toctext">Существующие уровни запуска</span></a></li>
<li class="toclevel-2"><a href="#.D0.A0.D0.B0.D0.B1.D0.BE.D1.82.D0.B0_.D1.81.D0.BE_.D1.81.D1.86.D0.B5.D0.BD.D0.B0.D1.80.D0.B8.D1.8F.D0.BC.D0.B8_.D0.B8.D0.BD.D0.B8.D1.86.D0.B8.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8"><span class="tocnumber">1.5</span> <span class="toctext">Работа со сценариями инициализации</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.D0.9E.D0.B1.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D0.B5.D0.B9_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0"><span class="tocnumber">2</span> <span class="toctext">Обновление уровней запуска</span></a>
<ul>
<li class="toclevel-2"><a href="#rc-update"><span class="tocnumber">2.1</span> <span class="toctext">rc-update</span></a></li>
<li class="toclevel-2"><a href="#.D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8_.D1.83.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81.D0.BB.D1.83.D0.B6.D0.B1"><span class="tocnumber">2.2</span> <span class="toctext">Добавление и удаление служб</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D1.81.D0.BB.D1.83.D0.B6.D0.B1"><span class="tocnumber">3</span> <span class="toctext">Настройка служб</span></a>
<ul>
<li class="toclevel-2"><a href="#.D0.9F.D0.BE.D1.87.D0.B5.D0.BC.D1.83_.D0.BD.D0.B5.D0.BE.D0.B1.D1.85.D0.BE.D0.B4.D0.B8.D0.BC.D0.B0_.D0.B4.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D0.B0.D1.8F_.D0.BD.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0"><span class="tocnumber">3.1</span> <span class="toctext">Почему необходима дополнительная настройка</span></a></li>
<li class="toclevel-2"><a href="#.D0.9A.D0.B0.D1.82.D0.B0.D0.BB.D0.BE.D0.B3_conf.d"><span class="tocnumber">3.2</span> <span class="toctext">Каталог conf.d</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.D0.9D.D0.B0.D0.BF.D0.B8.D1.81.D0.B0.D0.BD.D0.B8.D0.B5_.D1.81.D1.86.D0.B5.D0.BD.D0.B0.D1.80.D0.B8.D0.B5.D0.B2_.D0.B8.D0.BD.D0.B8.D1.86.D0.B8.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8"><span class="tocnumber">4</span> <span class="toctext">Написание сценариев инициализации</span></a>
<ul>
<li class="toclevel-2"><a href="#.D0.AD.D1.82.D0.BE_.D0.BD.D0.B5.D0.BE.D0.B1.D1.85.D0.BE.D0.B4.D0.B8.D0.BC.D0.BE.3F"><span class="tocnumber">4.1</span> <span class="toctext">Это необходимо?</span></a></li>
<li class="toclevel-2"><a href="#.D0.A1.D1.82.D1.80.D1.83.D0.BA.D1.82.D1.83.D1.80.D0.B0"><span class="tocnumber">4.2</span> <span class="toctext">Структура</span></a></li>
<li class="toclevel-2"><a href="#.D0.97.D0.B0.D0.B2.D0.B8.D1.81.D0.B8.D0.BC.D0.BE.D1.81.D1.82.D0.B8"><span class="tocnumber">4.3</span> <span class="toctext">Зависимости</span></a></li>
<li class="toclevel-2"><a href="#.D0.9F.D0.BE.D1.80.D1.8F.D0.B4.D0.BE.D0.BA_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0"><span class="tocnumber">4.4</span> <span class="toctext">Порядок запуска</span></a></li>
<li class="toclevel-2"><a href="#.D0.A1.D1.82.D0.B0.D0.BD.D0.B4.D0.B0.D1.80.D1.82.D0.BD.D1.8B.D0.B5_.D1.84.D1.83.D0.BD.D0.BA.D1.86.D0.B8.D0.B8"><span class="tocnumber">4.5</span> <span class="toctext">Стандартные функции</span></a></li>
<li class="toclevel-2"><a href="#.D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B4.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D0.BF.D0.B0.D1.80.D0.B0.D0.BC.D0.B5.D1.82.D1.80.D0.BE.D0.B2"><span class="tocnumber">4.6</span> <span class="toctext">Добавление дополнительных параметров</span></a></li>
<li class="toclevel-2"><a href="#.D0.9F.D0.B5.D1.80.D0.B5.D0.BC.D0.B5.D0.BD.D0.BD.D1.8B.D0.B5_.D0.B4.D0.BB.D1.8F_.D0.BD.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B8_.D1.81.D0.BB.D1.83.D0.B6.D0.B1"><span class="tocnumber">4.7</span> <span class="toctext">Переменные для настройки служб</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D0.BE.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D1.8F_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D0.B5.D0.B9_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0"><span class="tocnumber">5</span> <span class="toctext">Изменение поведения уровней запуска</span></a>
<ul>
<li class="toclevel-2"><a href="#.D0.9A.D1.82.D0.BE_.D0.BC.D0.BE.D0.B6.D0.B5.D1.82_.D0.BE.D1.82_.D1.8D.D1.82.D0.BE.D0.B3.D0.BE_.D0.B2.D1.8B.D0.B8.D0.B3.D1.80.D0.B0.D1.82.D1.8C.3F"><span class="tocnumber">5.1</span> <span class="toctext">Кто может от этого выиграть?</span></a></li>
<li class="toclevel-2"><a href="#Using_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.BD.D0.BE.D0.B3.D0.BE_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D1.8F_.28softlevel.29"><span class="tocnumber">5.2</span> <span class="toctext">Using программного уровня (softlevel)</span></a></li>
<li class="toclevel-2"><a href="#.D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BE.D1.87.D0.BD.D0.BE.D0.B3.D0.BE_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D1.8F_.28bootlevel.29"><span class="tocnumber">5.3</span> <span class="toctext">Использование загрузочного уровня (bootlevel)</span></a></li>
</ul>
</li>
</ul>
</div>

<h2><span class="mw-headline" id=".D0.A3.D1.80.D0.BE.D0.B2.D0.BD.D0.B8_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0">Уровни запуска</span></h2>
<h3><span class="mw-headline" id=".D0.9F.D1.80.D0.BE.D1.86.D0.B5.D1.81.D1.81_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BA.D0.B8_.D1.81.D0.B8.D1.81.D1.82.D0.B5.D0.BC.D1.8B">Процесс загрузки системы</span></h3>
<p>При загрузке вашей системы по экрану пробегает много текста. Если присмотреться, заметно, что этот текст (обычно) не меняется от загрузки к загрузке. Последовательность всех этих действий называется последовательностью  загрузки и в той или иной степени постоянна.
</p><p>Во-первых, загрузчик размещает в памяти образ ядра, который вы указали в файле его конфигурации. После этого начальный загрузчик просит процессор запустить ядро. Когда ядро загружено и запущено, оно инициализирует относящиеся к ядру структуры и задания, и запускает процесс init.
</p><p>Этот процесс удостоверяется, что все файловые системы (определенные в <span style="font-family: monospace; font-size: 95%">/etc/fstab</span>) смонтированы и готовы к использованию. Затем он выполняет несколько сценариев, находящихся в каталоге <span style="font-family: monospace; font-size: 95%">/etc/init.d/</span>, которые запускают службы, необходимые для нормального запуска системы.
</p><p>И, наконец, когда все сценарии выполнены, init подключает терминалы (чаще всего просто виртуальные консоли, которые видны при нажатии <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Alt</kbd>+<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F1</kbd>, <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Alt</kbd>+<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F2</kbd> и т.д.), прикрепляя к каждой консоли специальный процесс под названием <span style="font-family: monospace; font-size: 95%; font-weight: bold;">agetty</span>. Этот процесс впоследствии обеспечивает возможность входа в систему через эти терминалы с помощью login.
</p>
<h3><span class="mw-headline" id=".D0.A1.D1.86.D0.B5.D0.BD.D0.B0.D1.80.D0.B8.D0.B8_.D0.B8.D0.BD.D0.B8.D1.86.D0.B8.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8">Сценарии инициализации</span></h3>
<p>Сейчас процесс init запускает сценарии из каталога <span style="font-family: monospace; font-size: 95%">/etc/init.d/</span> не просто в случайном порядке. Более того, запускаются не все сценарии из <span style="font-family: monospace; font-size: 95%">/etc/init.d/</span>, а только те, которые предписано исполнять. Решение о запуске сценария принимается в результате просмотра каталога <span style="font-family: monospace; font-size: 95%">/etc/runlevels/</span>.
</p><p>Во-первых, init запускает все сценарии из <span style="font-family: monospace; font-size: 95%">/etc/init.d/</span>, на которые есть символьные ссылки из <span style="font-family: monospace; font-size: 95%">/etc/runlevels/boot/</span>. Обычно сценарии запускаются в алфавитном порядке, но в некоторых сценариях имеется информация о зависимостях от других сценариев, указывающая системе на необходимость их предварительного запуска.
</p><p>Когда все сценарии, указанные в <span style="font-family: monospace; font-size: 95%">/etc/runlevels/boot/</span>, будут выполнены, init переходит к запуску сценариев, на которые есть символьные ссылки из <span style="font-family: monospace; font-size: 95%">/etc/runlevels/default/</span>. И снова запуск происходит в алфавитном порядке, пока в сценарии не встретится информация о	зависимостях; тогда порядок изменяется для обеспечения правильного порядка запуска. Именно по данной причине команды, используемые во время установки Gentoo Linux, используют <code>default</code>, как в команде <span style="font-family: monospace; font-size: 95%; font-weight: bold;">rc-update add sshd default</span>.
</p>
<h3><span class="mw-headline" id=".D0.9A.D0.B0.D0.BA_.D1.80.D0.B0.D0.B1.D0.BE.D1.82.D0.B0.D0.B5.D1.82_init">Как работает init</span></h3>
<p>Конечно, init не принимает решений сам по себе. Ему необходим конфигурационный файл, где описаны необходимые действия. Этот файл - <span style="font-family: monospace; font-size: 95%">/etc/inittab</span>.
</p><p>Если вы запомнили последовательность загрузки, описанную чуть ранее, вы вспомните, что первое действие init - это монтирование всех файловых систем. Это определяется в следующей строке файла <span style="font-family: monospace; font-size: 95%">/etc/inittab</span>:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">Файл</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/inittab</code></strong><strong>Строка инициализации</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>si::sysinit:/sbin/rc sysinit
</pre></div></pre>
<p>Этой строкой процессу init предписывается выполнить <span style="font-family: monospace; font-size: 95%; font-weight: bold;">/sbin/rc sysinit</span> для инициализации системы. Самой инициализацией занимается сценарий <span style="font-family: monospace; font-size: 95%">/sbin/rc</span>, так что можно сказать, что init делает не слишком много - он просто делегирует задачу по инициализации системы другому процессу.
</p><p>Во-вторых, init выполняет все сценарии, на которые есть символьные ссылки из <span style="font-family: monospace; font-size: 95%">/etc/runlevels/boot/</span>. Это определяется следующей строкой:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">Файл</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/inittab</code></strong><strong>Выполнение загрузочных команд</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>rc::bootwait:/sbin/rc boot
</pre></div></pre>
<p>И снова все необходимые действия выполняются сценарием rc. Заметьте, что параметр, переданный rc (boot), совпадает с названием используемого подкаталога в <span style="font-family: monospace; font-size: 95%">/etc/runlevels/</span>.
</p><p>Теперь init проверяет свой конфигурационный файл, чтобы определить, какой уровень запуска нужно запустить. Для этого из <span style="font-family: monospace; font-size: 95%">/etc/inittab</span> считывается строка:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">Файл</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/inittab</code></strong><strong>Выбор уровня запуска по умолчанию</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>id:3:initdefault:
</pre></div></pre>
<p>В приведенном примере (который подходит для подавляющего большинства пользователей Gentoo) номер уровня запуска - 3. Пользуясь этой информацей, init проверяет, что нужно выполнить для запуска уровня запуска 3:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">Файл</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/inittab</code></strong><strong>Определения уровней запуска</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>l0:0:wait:/sbin/rc shutdown
l1:S1:wait:/sbin/rc single
l2:2:wait:/sbin/rc nonetwork
l3:3:wait:/sbin/rc default
l4:4:wait:/sbin/rc default
l5:5:wait:/sbin/rc default
l6:6:wait:/sbin/rc reboot
</pre></div></pre>
<p>В строке, определяющей уровень 3, для запуска служб снова используется сценарий rc (на этот раз с аргументом <code>default</code>). Опять-таки, обратите внимание, что аргумент, передаваемый сценарию rc, совпадает с названием подкаталога из <span style="font-family: monospace; font-size: 95%">/etc/runlevels/</span>.
</p><p>По окончании работы rc, init принимает решение о том, какие виртуальные консоли включить и какие команды выполнить в каждой из них:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">Файл</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/inittab</code></strong><strong>Определение виртуальных консолей</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>c1:12345:respawn:/sbin/agetty 38400 tty1 linux
c2:12345:respawn:/sbin/agetty 38400 tty2 linux
c3:12345:respawn:/sbin/agetty 38400 tty3 linux
c4:12345:respawn:/sbin/agetty 38400 tty4 linux
c5:12345:respawn:/sbin/agetty 38400 tty5 linux
c6:12345:respawn:/sbin/agetty 38400 tty6 linux
</pre></div></pre>
<h3><span class="mw-headline" id=".D0.A1.D1.83.D1.89.D0.B5.D1.81.D1.82.D0.B2.D1.83.D1.8E.D1.89.D0.B8.D0.B5_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D0.B8_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0">Существующие уровни запуска</span></h3>
<p>В предыдущем разделе мы увидели, что init применяет нумерацию для определения уровня запуска, который надо использовать. Уровень запуска - это то состояние, в котором запускается ваша система, он содержит набор сценариев (сценариев уровня запуска или сценариев инициализации), которые следует выполнять, при входе и выходе из определенного уровня запуска.
</p><p>В Gentoo определено семь уровней запуска: три служебных и четыре определяемых пользователем. Служебные называются <i>sysinit</i>, <i>shutdown</i> и <i>reboot</i>. Действия, совершаемые ими, в точности соответствуют их названиям: инициализация системы, выключение системы и ее перезагрузка.
</p><p>Определяемые пользователем уровни - это те, которым соответствуют подкаталоги в <span style="font-family: monospace; font-size: 95%">/etc/runlevels/</span>: <i>boot</i>, <i>default</i>, <i>nonetwork</i> и <i>single</i>. Уровень <i>boot</i> запускает все службы, необходимые системе и используемые всеми остальными уровнями. Остальные уровни отличаются друг от друга запускаемыми службами: <i>default</i> используется для повседневной работы, <i>nonetwork</i> - для тех случаев, когда не требуется сеть, а <i>single</i> используется при необходимости восстановления системы.
</p>
<h3><span class="mw-headline" id=".D0.A0.D0.B0.D0.B1.D0.BE.D1.82.D0.B0_.D1.81.D0.BE_.D1.81.D1.86.D0.B5.D0.BD.D0.B0.D1.80.D0.B8.D1.8F.D0.BC.D0.B8_.D0.B8.D0.BD.D0.B8.D1.86.D0.B8.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8">Работа со сценариями инициализации</span></h3>
<p>Сценарии, запускаемые процессом rc, называются сценариями инициализации. Каждый сценарий из <span style="font-family: monospace; font-size: 95%">/etc/init.d/</span> может запускаться с аргументами <code>start</code>, <code>stop</code>, <code>restart</code>, <code>zap</code>, <code>status</code>, <code>ineed</code>, <code>iuse</code>, <code>needsme</code>, <code>usesme</code> или <code>broken</code>.
</p><p>Для запуска, остановки или перезапуска службы (и всех, зависящих от нее) следует использовать <code>start</code>, <code>stop</code> и <code>restart</code>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>/etc/init.d/postfix start</code></div></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Заметка</strong><br />Останавливаются или перезапускаются только те службы, которым необходима данная служба. Остальные зависимые службы (те, которые используют службу, но не нуждаются в ней) эта операция не затрагивает.</div>
<p>Если вы хотите остановить службу, но оставить зависимые от нее работающими, можно использовать опцию <code>--nodeps</code> вместе с аргументом stop:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>/etc/init.d/postfix --nodeps stop</code></div></div>
<p>Чтобы узнать текущее состояние службы (запущена, остановлена, и т.д.), можно использовать аргумент <code>status</code>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>/etc/init.d/postfix status</code></div></div>
<p>Если указано, что служба работает, но вы знаете, что это не так, можно сбросить состояние на <i>stopped </i>, используя аргумент <code>zap</code>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>/etc/init.d/postfix zap</code></div></div>
<p>Для того, чтобы выяснить зависимости службы, можно использовать аргументы <code>iuse</code> или <code>ineed</code>. С помощью <code>ineed</code> вы увидите те службы, которые действительно необходимы для правильного функционирования интересующей вас службы. С другой стороны, <code>iuse</code> покажет те службы, которые могут использоваться нашей службой, но не обязательны для ее корректной работы.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>/etc/init.d/postfix ineed</code></div></div>
<p>Аналогично вы можете узнать, какие службы нуждаются в данной службе (<code>needsme</code>) или могут ее использовать (<code>usesme</code>):
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>/etc/init.d/postfix needsme</code></div></div>
<p>Наконец, можно просмотреть список служб, требующихся для данной, но отсутствующих в системе:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>/etc/init.d/postfix broken</code></div></div>
<h2><span class="mw-headline" id=".D0.9E.D0.B1.D0.BD.D0.BE.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D0.B5.D0.B9_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0">Обновление уровней запуска</span></h2>
<h3><span class="mw-headline" id="rc-update">rc-update</span></h3>
<p>Система инициализации Gentoo использует дерево зависимостей для определения служб, которые запускаются в первую очередь. Так как это очень утомительное занятие, и мы бы не хотели, чтобы пользователь занимался этим вручную, мы разработали инструменты, упрощающие управление уровнями запуска и сценариями инициализации.
</p><p>Используя <span style="font-family: monospace; font-size: 95%; font-weight: bold;">rc-update</span>, можно включать и исключать сценарии инициализации из уровней запуска. Из <span style="font-family: monospace; font-size: 95%; font-weight: bold;">rc-update</span> автоматически запускается сценарий <span style="font-family: monospace; font-size: 95%">depscan.sh</span> для перестроения дерева зависимостей.
</p>
<h3><span class="mw-headline" id=".D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B8_.D1.83.D0.B4.D0.B0.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D1.81.D0.BB.D1.83.D0.B6.D0.B1">Добавление и удаление служб</span></h3>
<p>В процессе установки Gentoo вы уже добавляли сценарии инициализации в уровень запуска <i>default</i>. Ранее в данном документе было объяснено, что означает <i>default</i>. Кроме уровня запуска, сценарию <span style="font-family: monospace; font-size: 95%; font-weight: bold;">rc-update</span> требуется второй аргумент, определяющий действие: <code>add</code> (добавить), <code>del</code> (удалить) или <code>show</code> (показать).
</p><p>Для того, чтобы добавить или удалить сценарий, просто введите <span style="font-family: monospace; font-size: 95%; font-weight: bold;">rc-update</span> с аргументом <code>add</code> или <code>del</code>, затем название сценария и уровня запуска. Например:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>rc-update del postfix default</code></div></div>
<p>По команде <span style="font-family: monospace; font-size: 95%; font-weight: bold;">rc-update -v show</span> выводится список всех доступных сценариев с указанием соответствующих уровней запуска:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>rc-update -v show</code></div></div>
<p>Вы также можете запустить <span style="font-family: monospace; font-size: 95%; font-weight: bold;">rc-update show</span> (без <code>-v</code>) чтобы просто просмотреть включенные инициализационные скрипты и их уровни запуска.
</p>
<h2><span class="mw-headline" id=".D0.9D.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0_.D1.81.D0.BB.D1.83.D0.B6.D0.B1">Настройка служб</span></h2>
<h3><span class="mw-headline" id=".D0.9F.D0.BE.D1.87.D0.B5.D0.BC.D1.83_.D0.BD.D0.B5.D0.BE.D0.B1.D1.85.D0.BE.D0.B4.D0.B8.D0.BC.D0.B0_.D0.B4.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D0.B0.D1.8F_.D0.BD.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B0">Почему необходима дополнительная настройка</span></h3>
<p>Сценарии инициализации могут быть весьма сложны. Поэтому нежелательно допускать непосредственное редактирование сценария пользователями, т.к. это может привнести в систему множество ошибок. Но, с другой стороны, необходимо правильно настроить службу. Например, может понадобиться передать службе дополнительные параметры.
</p><p>Вторая причина, по которой настройки хранятся отдельно от самого сценария - это возможность обновления сценария без опасения, что все ваши настройки будут утеряны.
</p>
<h3><span class="mw-headline" id=".D0.9A.D0.B0.D1.82.D0.B0.D0.BB.D0.BE.D0.B3_conf.d">Каталог conf.d</span></h3>
<p>В Gentoo предусмотрен очень простой способ настройки служб: для каждого сценария, предполагающего настройку, в каталоге <span style="font-family: monospace; font-size: 95%">/etc/conf.d/</span> есть конфигурационный файл. Например, у сценария, запускающего <span style="font-family: monospace; font-size: 95%">apache2</span> (под названием <span style="font-family: monospace; font-size: 95%">/etc/init.d/apache2</span>) есть настроечный файл <span style="font-family: monospace; font-size: 95%">/etc/conf.d/apache2</span>, где могут храниться нужные вам параметры, передаваемые серверу Apache 2 при запуске:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">Файл</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/conf.d/apache2</code></strong><strong>Пример настроек для скрипта инициализации apache2</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nv">APACHE2_OPTS</span><span class="o">=</span><span class="s2">&quot;-D PHP5&quot;</span>
</pre></div></pre>
<p>Такие файлы настроек содержат <i>только</i> переменные (наподобие <span style="font-family: monospace; font-size: 95%">/etc/portage/make.conf</span>), облегчая настройку служб. Это также позволяет нам давать больше информации о переменных (в комментариях).
</p>
<h2><span class="mw-headline" id=".D0.9D.D0.B0.D0.BF.D0.B8.D1.81.D0.B0.D0.BD.D0.B8.D0.B5_.D1.81.D1.86.D0.B5.D0.BD.D0.B0.D1.80.D0.B8.D0.B5.D0.B2_.D0.B8.D0.BD.D0.B8.D1.86.D0.B8.D0.B0.D0.BB.D0.B8.D0.B7.D0.B0.D1.86.D0.B8.D0.B8">Написание сценариев инициализации</span></h2>
<h3><span class="mw-headline" id=".D0.AD.D1.82.D0.BE_.D0.BD.D0.B5.D0.BE.D0.B1.D1.85.D0.BE.D0.B4.D0.B8.D0.BC.D0.BE.3F">Это необходимо?</span></h3>
<p>Нет, написание сценариев инициализации обычно не требуется, т.к. Gentoo содержит готовые сценарии для всех поддерживаемых служб. Однако, вы можете установить какую-либо службу, не используя систему Portage; в таком случае, вероятно, вам придется создавать сценарий инициализации самостоятельно.
</p><p>Не используйте сценарий, идущий со службой, если он не написан специально для Gentoo: сценарии инициализации Gentoo не совместимы со сценариями, используемыми в других дистрибутивах!
</p>
<h3><span class="mw-headline" id=".D0.A1.D1.82.D1.80.D1.83.D0.BA.D1.82.D1.83.D1.80.D0.B0">Структура</span></h3>
<p>Основная структура сценария инициализации показана ниже.
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">Код</span> <strong>Пример структуры сценарий</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="c">#!/sbin/runscript</span>
  
depend<span class="o">()</span> <span class="o">{</span>
  <span class="o">(</span>Информация о зависимостях<span class="o">)</span>
<span class="o">}</span>
  
start<span class="o">()</span> <span class="o">{</span>
  <span class="o">(</span>Команды, необходимые для запуска службы<span class="o">)</span>
<span class="o">}</span>
  
stop<span class="o">()</span> <span class="o">{</span>
  <span class="o">(</span>Команды, необходимые для остановки службы<span class="o">)</span>
<span class="o">}</span>
</pre></div></pre></div>
<p>В любом сценарии должна быть определена функция start(). Все остальные разделы необязательны.
</p>
<h3><span class="mw-headline" id=".D0.97.D0.B0.D0.B2.D0.B8.D1.81.D0.B8.D0.BC.D0.BE.D1.81.D1.82.D0.B8">Зависимости</span></h3>
<p>Существуют две настройки, работающие с зависимостями, которые вы можете определить, и они будут влиять на порядок запуска инициализационных скриптов: <i>use</i> (использую) и <i>need</i> (нуждаюсь). Кроме этих двух, существуют еще два влияющих на порядок загрузки метода, называющихся <i>before</i> (перед) и <i>after</i> (после). Последние два определяют не зависимости, они не заставят выдать ошибку скрипт, если тот скрипт, что в них описан вообще не должен запуститься (или не запустится).
</p>
<ul><li> Настройка <i>use</i> информирует систему init, что данный скрипт использует функциональность некоторого скрипта, но строго от него не зависит. Хорошим примером будет <i>use logger</i> или <i>use dns</i>. Если эти сервисы есть, они будут хорошо использоваться, но если у вас нет логгера, или DNS-сервера, сервисы все равно будут работать. Если сервисы существуют, они будут запущены до того, как запустится скрипт, использующий их.</li>
<li> Настройка <i>need</i> это жесткая зависимость. Она означает, что скрипт, которому нужен другой скрипт, не запустится, пока другой скрипт не запустится успешно. Также, если другой скрипт будет перезапущен, то этот тоже будет перезапущен.</li>
<li> При использовании <i>before</i>, данный скрипт запускается до некоторого скрипта, если выбранный скрипт это часть того же	уровня инициализации. Так, инициализационный скрипт xdm, который определен <i>before alsasound</i> будет запущен до скрипта alsasound, но только если alsasound запланирован запуститься на том же уровне инициализации. Если alsasound не запланирован запуститься, то эта конкретная настройка не будет иметь эффекта, и xdm запустится в тот момент времени, который система init посчитает лучшим вариантом.</li>
<li> Похожим образом, <i>after</i> информирует систему init, что данный скрипт нужно запустить после некоторого скрипта, если выбранный скрипт является частью того же уровня инициализации. Если нет, то настройка не имеет эффекта, и скрипт будет запущен системой init в момент времени, который, как она посчитает, будет наилучшим.</li></ul>
<p>Из вышенаписанного должно быть ясно, что <i>need</i> это единственная <i>действительная</i> настройка зависимостей, так как она влияет на то, будет ли запущен скрипт или нет. Все остальные являются больше указателями системе init, говорящими в каком порядке скрипты могут (или должны) запускаться.
</p><p>Теперь, если вы посмотрите на многие из существующих инициализационных скриптов Gentoo, вы заметите, что некоторые из них имеют зависимости от вещей, которые не являются инициализационными скриптами. Эти <i>вещи</i> мы называем виртуальными.
</p><p><i>Виртуальная зависимость</i> - это зависимость от функций, предоставляемых службой, но не какой-то единственной службой. Сценарий может зависеть от службы системного журнала, но таких достаточно много (metalogd, syslog-ng, sysklogd и т.п.). Поскольку нельзя нуждаться в каждой из них (ни в одной вразумительной системе они не запущены все сразу), мы обеспечили предоставление виртуальной зависимости всеми этими службами.
</p><p>Например, давайте взглянем на информацию о зависимостях postfix.
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">Файл</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/init.d/postfix</code></strong><strong>Информация о зависимостях сервиса Postfix</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>depend<span class="o">()</span> <span class="o">{</span>
  need net
  use logger dns
  provide mta
<span class="o">}</span>
</pre></div></pre>
<p>Как можно увидеть, сервис postfix:
</p>
<ul><li> требует сеть (net): виртуальная зависимость, удовлетворяемая, например, <span style="font-family: monospace; font-size: 95%">/etc/init.d/net.eth0</span></li>
<li> использует журнал (logger): виртуальная зависимость, удовлетворяемая, например, <span style="font-family: monospace; font-size: 95%">/etc/init.d/syslog-ng</span></li>
<li> использует службу имен (dns): виртуальная зависимость, удовлетворяемая, например, <span style="font-family: monospace; font-size: 95%">/etc/init.d/named</span></li>
<li> предоставляет почтовый агент (mta): виртуальная зависимость, общая для всех программ - почтовых серверов</li></ul>
<h3><span class="mw-headline" id=".D0.9F.D0.BE.D1.80.D1.8F.D0.B4.D0.BE.D0.BA_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0">Порядок запуска</span></h3>
<p>Как мы описали в предыдущем разделе, вы можете сказать системе init, в каком порядке она должна запускать (или останавливать) скрипты. Этот порядок поддерживается как через настройки зависимостей use и need, так и через настройки порядка before и after. Так как мы описали их ранее, давайте посмотрим на сервис Portmap, как на пример такого инициализационного скрипта.
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">Файл</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/init.d/portmap</code></strong><strong>Информация о зависимостях сервиса portmap</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>depend<span class="o">()</span> <span class="o">{</span>
  need net
  before inetd
  before xinetd
<span class="o">}</span>
</pre></div></pre>
<p>Также можно использовать знак "*", чтобы охватить все службы данного уровня запуска, хотя это не рекомендуется.
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">Код</span> <strong>Использование символа *</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>depend<span class="o">()</span> <span class="o">{</span>
  before *
<span class="o">}</span>
</pre></div></pre></div>
<p>Если ваш сервис должен писать на локальные диски, он должен потребовать localmount. Если он что-либо поместит в <span style="font-family: monospace; font-size: 95%">/var/run/</span>, например, pid-файл, он должен запускаться после bootmisc:
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">Код</span> <strong>Настройка зависимостей - нам нужен localmount и мы стартуем после bootmisc</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>depend<span class="o">()</span> <span class="o">{</span>
  need localmount
  after bootmisc
<span class="o">}</span>
</pre></div></pre></div>
<h3><span class="mw-headline" id=".D0.A1.D1.82.D0.B0.D0.BD.D0.B4.D0.B0.D1.80.D1.82.D0.BD.D1.8B.D0.B5_.D1.84.D1.83.D0.BD.D0.BA.D1.86.D0.B8.D0.B8">Стандартные функции</span></h3>
<p>Следом за разделом <code>depend()</code> вам потребуется определить функцию <code>start()</code>. В ней содержатся все команды, необходимые для запуска вашей службы. Рекомендуется применять функции <code>ebegin</code> и <code>eend</code> для сообщений пользователю о том, что происходит:
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">Код</span> <strong>Пример функции start()</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>start<span class="o">()</span> <span class="o">{</span>
  <span class="k">if</span> <span class="o">[</span> <span class="s2">&quot;</span><span class="si">${</span><span class="nv">RC_CMD</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">=</span> <span class="s2">&quot;restart&quot;</span> <span class="o">]</span><span class="p">;</span>
  <span class="k">then</span>
    <span class="c"># Что-нибудь сделать, если рестарт требует больше, чем просто последовательный запуск stop и start</span>
  <span class="k">fi</span>
  
  ebegin <span class="s2">&quot;Запуск - моя_служба&quot;</span>
  start-stop-daemon --start --exec /path/to/my_service <span class="se">\</span>
    --pidfile /path/to/my_pidfile
  eend <span class="nv">$?</span>
<span class="o">}</span>
</pre></div></pre></div>
<p>Как <code>--exec</code>, так и <code>--pidfile</code> должны использоваться в функциях start и stop. Если сервис не создает pid-файл, тогда используйте <code>--make-pidfile</code>, если возможно, хотя лучше протестировать это, чтобы быть уверенным. Иначе, не используйте pid-файлы. Вы также можете добавить <code>--quiet</code> к опциям start-stop-daemon, но это не рекомендуется, если только сервис не очень многословный. Использование <code>--quiet</code> может скрыть информацию если сервис не сможет запуститься.
</p><p>Другой интересной настройкой, используемой в вышеприведенном примере является проверка содержимого переменной <var>RC_CMD</var>. В отличие от предыдущей инициализационной системы, новая система openrc не поддерживает отдельную функциональность restart для каждого скрипта. Вместо этого, скрипт должен проверить содержимое переменной <var>RC_CMD</var>, чтобы проверить, вызывается ли функция (как <code>start()</code>, так и <code>stop()</code>) как часть restart, или нет.
</p>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Заметка</strong><br />Удостоверьтесь, что <code>--exec</code> действительно вызывает сервис, а не shell-скрипт, который запускает сервисы и выходит — это должен делать сам инициализационный скрипт.</div>
<p>Если вам нужны дополнительные примеры функции <code>start()</code>, пожалуйста, прочитайте исходные коды сценариев инициализации, находящихся в каталоге <span style="font-family: monospace; font-size: 95%">/etc/init.d/</span>.
</p><p>Еще одной функцией, которую можно определить (но вы не обязаны это делать), является <code>stop()</code>. Система инициализации, применяемая нами, достаточно развита и в состоянии самостоятельно заполнить эту функцию, если вы используете start-stop-daemon.
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">Код</span> <strong>Пример функции stop()</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>stop<span class="o">()</span> <span class="o">{</span>
  ebegin <span class="s2">&quot;Останавливаю Мой_сервис&quot;</span>
  start-stop-daemon --stop --exec /path/to/my_service <span class="se">\</span>
    --pidfile /path/to/my_pidfile
  eend <span class="nv">$?</span>
<span class="o">}</span>
</pre></div></pre></div>
<p>Если ваш сервис запускает некоторый другой скрипт (например, на Bash, Python или Perl), и этот скрипт позднее изменяет имя (например, с <span style="font-family: monospace; font-size: 95%">foo.py</span> на foo), тогда вам нужно добавить <code>--name</code> к start-stop-daemon. Вы должны определить имя, на которое имя файла будет изменено. В приведенном примере, сервис запускает <span style="font-family: monospace; font-size: 95%">foo.py</span>, а потом это имя меняется на foo:
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">Код</span> <strong>Пример определения сервиса, который запускает скрипт foo</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>start<span class="o">()</span> <span class="o">{</span>
  ebegin <span class="s2">&quot;Запускаю мой_скрипт&quot;</span>
  start-stop-daemon --start --exec /path/to/my_script <span class="se">\</span>
    --pidfile /path/to/my_pidfile --name foo
  eend <span class="nv">$?</span>
<span class="o">}</span>
</pre></div></pre></div>
<p>У start-stop-daemon есть отличная man-страница, которую вы можете посмотреть, если вам нужна дополнительная информация.
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">user $</code><span class="tripleclick-separator"></span><code>man start-stop-daemon</code></div></div>
<p>Синтаксис сценариев инициализации, применяемых в Gentoo, основан на оболочке POSIX, поэтому вы можете свободно использовать внутри своих сценариев sh-совместимые конструкции. Остальные конструкции, вроде тех, которые 	специфичны только для bash, выносите за пределы инициализационных сценариев, чтобы быть уверенным, что скрипты будут работать независимо от того, что Gentoo может сделать со своей системой инициализации.
</p>
<h3><span class="mw-headline" id=".D0.94.D0.BE.D0.B1.D0.B0.D0.B2.D0.BB.D0.B5.D0.BD.D0.B8.D0.B5_.D0.B4.D0.BE.D0.BF.D0.BE.D0.BB.D0.BD.D0.B8.D1.82.D0.B5.D0.BB.D1.8C.D0.BD.D1.8B.D1.85_.D0.BF.D0.B0.D1.80.D0.B0.D0.BC.D0.B5.D1.82.D1.80.D0.BE.D0.B2">Добавление дополнительных параметров</span></h3>
<p>Если вы хотите ввести в сценарий дополнительные параметры, кроме упоминавшихся, нужно добавить к переменной extra_commands название параметра и создать функцию	с названием, соответствующим параметру. Например, для поддержки параметра restartdelay:
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">Код</span> <strong>Пример определения метода restartdelay</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nv">extra_commands</span><span class="o">=</span><span class="s2">&quot;restartdelay&quot;</span>
  
restartdelay<span class="o">()</span> <span class="o">{</span>
  stop
  sleep <span class="m">3</span>    <span class="c"># пауза в 3 секунды перед повторным запуском</span>
  start
<span class="o">}</span>
</pre></div></pre></div>
<div class="alert alert-warning gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-exclamation-circle"></i> Важно</strong><br />Функция restart не может быть переназначена в openrc!</div>
<h3><span class="mw-headline" id=".D0.9F.D0.B5.D1.80.D0.B5.D0.BC.D0.B5.D0.BD.D0.BD.D1.8B.D0.B5_.D0.B4.D0.BB.D1.8F_.D0.BD.D0.B0.D1.81.D1.82.D1.80.D0.BE.D0.B9.D0.BA.D0.B8_.D1.81.D0.BB.D1.83.D0.B6.D0.B1">Переменные для настройки служб</span></h3>
<p>Для поддержки настроечных файлов из каталога <span style="font-family: monospace; font-size: 95%">/etc/conf.d/</span> ничего дополнительно делать не нужно: при запуске вашего сценария инициализации автоматически подключаются следующие файлы (т.е., переменные из них становятся доступны):
</p>
<ul><li> <span style="font-family: monospace; font-size: 95%">/etc/conf.d/ВАШ_СКРИПТ_ИНИЦИАЛИЗАЦИИ</span></li>
<li> <span style="font-family: monospace; font-size: 95%">/etc/conf.d/basic</span></li>
<li> <span style="font-family: monospace; font-size: 95%">/etc/rc.conf</span></li></ul>
<p>Кроме того, если ваш инициализационный сценарий предоставляет виртуальную зависимость (например, net), то также подключается файл, соответствующий этой зависимости (например, <span style="font-family: monospace; font-size: 95%">/etc/conf.d/net</span>).
</p>
<h2><span class="mw-headline" id=".D0.98.D0.B7.D0.BC.D0.B5.D0.BD.D0.B5.D0.BD.D0.B8.D0.B5_.D0.BF.D0.BE.D0.B2.D0.B5.D0.B4.D0.B5.D0.BD.D0.B8.D1.8F_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D0.B5.D0.B9_.D0.B7.D0.B0.D0.BF.D1.83.D1.81.D0.BA.D0.B0">Изменение поведения уровней запуска</span></h2>
<h3><span class="mw-headline" id=".D0.9A.D1.82.D0.BE_.D0.BC.D0.BE.D0.B6.D0.B5.D1.82_.D0.BE.D1.82_.D1.8D.D1.82.D0.BE.D0.B3.D0.BE_.D0.B2.D1.8B.D0.B8.D0.B3.D1.80.D0.B0.D1.82.D1.8C.3F">Кто может от этого выиграть?</span></h3>
<p>Большинству пользователей ноутбуков знакома ситуация: дома вам нужен запуск net.eth0, и наоборот, в дороге запуск net.eth0 не нужен (так как сеть недоступна). В Gentoo можно изменять поведение уровней запуска по своему усмотрению.
</p><p>Например вы можете создать второй загружаемый уровень запуска <i>default</i>, в котором будут другие сценарии. Затем при загрузке вы сможете выбрать, какой из уровней default следует использовать.
</p>
<h3><span class="mw-headline" id="Using_.D0.BF.D1.80.D0.BE.D0.B3.D1.80.D0.B0.D0.BC.D0.BC.D0.BD.D0.BE.D0.B3.D0.BE_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D1.8F_.28softlevel.29">Using программного уровня (softlevel)</span></h3>
<p>Прежде всего, создайте каталог для своего второго уровня запуска <i>default</i>. Например, создадим уровень запуска <i>offline</i>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mkdir /etc/runlevels/offline</code></div></div>
<p>Добавьте необходимые сценарии инициализации в только что созданный уровень запуска. Например, чтобы получить точную копию уровня default, за исключением net.eth0:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>cd /etc/runlevels/default
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>for service in *; do rc-update add $service offline; done
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>rc-update del net.eth0 offline
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>rc-update show offline</code></div><pre>
(Partial sample Output)
               acpid | offline
          domainname | offline
               local | offline
            net.eth0 |
</pre></div>
<p>Даже несмотря на то, что net.eth0 был удален с уровня запуска offline, udev может попытаться запустить любые устройства, которые найдет, и запустить соответствующие сервисы. Данная функциональность называется hotplugging. По умолчанию, Gentoo отключает hotplugging.
</p><p>Если вы хотите включить hotplugging, но только для конкретного набора скриптов, используйте переменную <var>rc_hotplug</var> в <span style="font-family: monospace; font-size: 95%">/etc/rc.conf</span>:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">Файл</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/rc.conf</code></strong><strong>Включение hotplugging на интерфейсе WLAN</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nv">rc_hotplug</span><span class="o">=</span><span class="s2">&quot;net.wlan !net.*&quot;</span>
</pre></div></pre>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Заметка</strong><br />Для более детальной информации о сервисах, инициируемых устройствами, просмотрите комментарии в <span style="font-family: monospace; font-size: 95%">/etc/rc.conf</span>.</div>
<p>Теперь необходимо отредактировать конфигурацию загрузчика, добавив новую запись для уровня запуска offline. В данной записи добавьте <code>softlevel=offline</code> в качестве параметра загрузки.
</p>
<h3><span class="mw-headline" id=".D0.98.D1.81.D0.BF.D0.BE.D0.BB.D1.8C.D0.B7.D0.BE.D0.B2.D0.B0.D0.BD.D0.B8.D0.B5_.D0.B7.D0.B0.D0.B3.D1.80.D1.83.D0.B7.D0.BE.D1.87.D0.BD.D0.BE.D0.B3.D0.BE_.D1.83.D1.80.D0.BE.D0.B2.D0.BD.D1.8F_.28bootlevel.29">Использование загрузочного уровня (bootlevel)</span></h3>
<p>Использование загрузочного уровня полностью аналогично использованию программного уровня. Единственная разница состоит в том, что вы определяете второй уровень <i>boot</i> вместо второго уровня <i>default</i>.
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../Features/ru.html" title="Предыдущая часть" class="btn btn-default">&#8592; </a> <a href="../../ru.html" title="Handbook:AMD64/ru" class="btn btn-default">К содержанию</a> <a href="../EnvVar/ru.html" title="Следующая часть" class="btn btn-default">Environment variables &#8594;</a></div>
<p><br />
</p>
<!-- 
NewPP limit report
Cached time: 20160112153916
Cache expiry: 86400
Dynamic content: false
CPU time usage: 0.544 seconds
Real time usage: 0.593 seconds
Preprocessor visited node count: 2359/1000000
Preprocessor generated node count: 3639/1000000
Post‐expand include size: 96399/2097152 bytes
Template argument size: 13178/2097152 bytes
Highest expansion depth: 11/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00%  439.296      1 - Handbook:Parts/Working/Initscripts/ru
100.00%  439.296      1 - -total
 35.29%  155.022      1 - Handbook:Parts/TOC/ru
 21.42%   94.118     11 - Template:RootCmd
 18.95%   83.226     12 - Template:GenericCmd
 12.24%   53.788     16 - Template:PreBox
  9.49%   41.685      9 - Template:FileBox
  6.58%   28.920      7 - Template:CodeBox
  4.49%   19.727      1 - Handbook:Parts/Navigator/ru
  4.35%   19.088     15 - Template:GenericCmd/Line
-->

<!-- Saved in parser cache with key gentoo-wiki:pcache:idhash:76702-0!*!0!!en!*!* and timestamp 20160112153915 and revision id 189774
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://wiki.gentoo.org/index.php?title=Handbook:AMD64/Working/Initscripts/ru&amp;oldid=189774">http://wiki.gentoo.org/index.php?title=Handbook:AMD64/Working/Initscripts/ru&amp;oldid=189774</a>"</div>
															<div id='catlinks' class='catlinks catlinks-allhidden'></div>														<!-- end content -->

													</div>
					</div>
				</div>
			</div>
		</div>

			<footer>
		<div class="container">
			<div class="row">
				<div class="col-xs-12 col-md-offset-2 col-md-7">
											<div class="spacer"></div>
						<ul id="f-list">
																							<li id="lastmod"> This page was last modified on 27 December 2014, at 09:13.</li>
																															<li id="privacy"><a href="../../../Gentoo_Wiki_Privacy_policy.html" title="Gentoo Wiki:Privacy policy">Privacy policy</a></li>
																							<li id="about"><a href="../../../Gentoo_Wiki_About.html" title="Gentoo Wiki:About">About Gentoo Wiki</a></li>
																							<li id="disclaimer"><a href="../../../Gentoo_Wiki_General_disclaimer.html" title="Gentoo Wiki:General disclaimer">Disclaimers</a></li>
													</ul>
									</div>
				<div class="col-xs-12 col-md-3">
					<!-- No questions or comments, the Wiki has enough information on how to contact us. -->
				</div>
			</div>
			<div class="row">
				<div class="col-xs-3 col-md-2">
					<ul class="footerlinks three-icons">
						<li><a href="https://twitter.com/gentoo" title="@Gentoo on Twitter"><span class="fa fa-twitter fa-fw"></span></a></li>
						<li><a href="https://plus.google.com/+Gentoo" title="+Gentoo on Google+"><span class="fa fa-google-plus fa-fw"></span></a></li>
						<li><a href="https://www.facebook.com/gentoo.org" title="Gentoo on Facebook"><span class="fa fa-facebook fa-fw"></span></a></li>
					</ul>
				</div>
				<div class="col-xs-9 col-md-9">
					<strong>&copy; 2001&ndash;2016 Gentoo Foundation, Inc.</strong><br />
					<small>
						Gentoo is a trademark of the Gentoo Foundation, Inc.
						The contents of this document, unless otherwise expressly stated, are licensed under the
						<a href="https://creativecommons.org/licenses/by-sa/3.0/" rel="license">CC-BY-SA-3.0</a> license.
						The <a href="https://www.gentoo.org/inside-gentoo/foundation/name-logo-guidelines.html">Gentoo Name and Logo Usage Guidelines</a> apply.
					</small>
				</div>
			</div>
		</div>
	</footer>
	
		<script>
			window.RLQ = window.RLQ || []; window.RLQ.push( function () {
				$.getScript("https://1b9a50f4f9de4348cd9f-e703bc50ba0aa66772a874f8c7698be7.ssl.cf5.rackcdn.com/bootstrap.min.js");
			} );
		</script>
		<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.state({"user":"ready","user.groups":"ready"});
} );</script>
<link rel="stylesheet" href="https://wiki.gentoo.org/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.skinning.content.externallinks&amp;only=styles&amp;skin=tyrian" />
<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.load(["ext.smw.tooltips","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.uls.pt"]);
} );</script><script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['setDocumentTitle', "Handbook:AMD64/Working/Initscripts/ru"]);
  _paq.push(['setIgnoreClasses', 'image']);
  _paq.push(['trackPageView']);
  _paq.push(['disableCookies']);
  _paq.push(['enableLinkTracking']);
  
  (function() {
    var u="http://piwik.gentoo.org//";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="http://piwik.gentoo.org//piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript><script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgBackendResponseTime":784});
} );</script></body>
<!-- Mirrored from wiki.gentoo.org/wiki/Handbook:AMD64/Working/Initscripts/ru by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Jan 2016 17:42:20 GMT -->
</html>