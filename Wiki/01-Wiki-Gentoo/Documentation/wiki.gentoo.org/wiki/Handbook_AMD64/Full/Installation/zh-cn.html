<!DOCTYPE html>
<html lang="en" dir="ltr" class="client-nojs">

<!-- Mirrored from wiki.gentoo.org/wiki/Handbook:AMD64/Full/Installation/zh-cn by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Jan 2016 17:23:43 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
<meta charset="UTF-8" />
<title>Gentoo Linux  手册：安装Gentoo - Gentoo Wiki</title>
<script>document.documentElement.className = document.documentElement.className.replace( /(^|\s)client-nojs(\s|$)/, "$1client-js$2" );</script>
<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgCanonicalNamespace":"Handbook","wgCanonicalSpecialPageName":!1,"wgNamespaceNumber":560,"wgPageName":"Handbook:AMD64/Full/Installation/zh-cn","wgTitle":"AMD64/Full/Installation/zh-cn","wgCurRevisionId":313126,"wgRevisionId":313126,"wgArticleId":73576,"wgIsArticle":!0,"wgIsRedirect":!1,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgBreakFrames":!1,"wgPageContentLanguage":"zh-cn","wgPageContentModel":"wikitext","wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"zh","wgMonthNames":["","1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],"wgMonthNamesShort":["","1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],"wgRelevantPageName":"Handbook:AMD64/Full/Installation/zh-cn","wgRelevantArticleId":73576,"wgIsProbablyEditable":!1,"wgRestrictionEdit":[],"wgRestrictionMove":[],"sfgAutocompleteValues":[],
"sfgAutocompleteOnAllChars":!1,"sfgFieldProperties":[],"sfgCargoFields":[],"sfgDependentFields":[],"sfgShowOnSelect":[],"sfgScriptPath":"/extensions/SemanticForms","edgValues":null,"sfgEDSettings":null,"wgWikiEditorEnabledModules":{"toolbar":!0,"dialogs":!0,"preview":!0,"publish":!1},"wgULSAcceptLanguageList":["en","*"],"wgULSCurrentAutonym":"English","wgTranslatePageTranslation":"translation"});mw.loader.implement("user.options",function($,jQuery){mw.user.options.set({"variant":"en"});});mw.loader.implement("user.tokens",function($,jQuery){mw.user.tokens.set({"editToken":"+\\","patrolToken":"+\\","watchToken":"+\\"});});mw.loader.load(["ext.translate","ext.smw.style","mediawiki.page.startup","mediawiki.legacy.wikibits","ext.uls.init"]);
} );</script>
<link rel="stylesheet" href="https://wiki.gentoo.org/load.php?debug=false&amp;lang=en&amp;modules=ext.pygments%7Cext.uls.nojs%7Cmediawiki.legacy.commonPrint%2Cshared%7Cmediawiki.sectionAnchor%7Cmediawiki.skinning.interface%7Cskins.tyrian.styles&amp;only=styles&amp;skin=tyrian" />
<link rel="stylesheet" href="https://wiki.gentoo.org/load.php?debug=false&amp;lang=en&amp;modules=ext.smw.style%7Cext.smw.tooltip.styles&amp;only=styles&amp;skin=tyrian" />
<link rel="stylesheet" href="https://1b9a50f4f9de4348cd9f-e703bc50ba0aa66772a874f8c7698be7.ssl.cf5.rackcdn.com/bootstrap.min.css" />
<link rel="stylesheet" href="https://1b9a50f4f9de4348cd9f-e703bc50ba0aa66772a874f8c7698be7.ssl.cf5.rackcdn.com/tyrian.min.css" />
<meta name="ResourceLoaderDynamicStyles" content="" />
<link rel="stylesheet" href="https://wiki.gentoo.org/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=styles&amp;skin=tyrian" />
<style>a:lang(ar),a:lang(kk-arab),a:lang(mzn),a:lang(ps),a:lang(ur){text-decoration:none}</style>
<script async="" src="https://wiki.gentoo.org/load.php?debug=false&amp;lang=en&amp;modules=startup&amp;only=scripts&amp;skin=tyrian"></script>
<meta name="generator" content="MediaWiki 1.26.2-gentoo" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#54487a" />
<meta name="viewport" content="width=device-width, initial-scale=1.0" />
<meta name="theme-color" content="#54487a" />
<link rel="ExportRDF" type="application/rdf+xml" title="Handbook:AMD64/Full/Installation/zh-cn" href="https://wiki.gentoo.org/index.php?title=Special:ExportRDF/Handbook:AMD64/Full/Installation/zh-cn&amp;xmlmime=rdf" />
<link rel="shortcut icon" href="https://wiki.gentoo.org/favicon.ico" />
<link rel="search" type="application/opensearchdescription+xml" href="https://wiki.gentoo.org/opensearch_desc.php" title="Gentoo Wiki (en)" />
<link rel="EditURI" type="application/rsd+xml" href="http://wiki.gentoo.org/api.php?action=rsd" />
<link rel="copyright" href="http://creativecommons.org/licenses/by-sa/3.0/" />
<link rel="alternate" type="application/atom+xml" title="Gentoo Wiki Atom feed" href="https://wiki.gentoo.org/index.php?title=Special:RecentChanges&amp;feed=atom" />
</head>
<body class="mediawiki ltr sitedir-ltr ns-560 ns-subject page-Handbook_AMD64_Full_Installation_zh-cn skin-tyrian action-view">
	<div class="mw-jump sr-only">
		Jump to:		<a href="#top">content</a>
	</div>
	<header>
		<div class="site-title">
			<div class="container">
				<div class="row">
					<div class="site-title-buttons">
						<div class="btn-group btn-group-sm">
							<a href="https://get.gentoo.org/" role="button" class="btn get-gentoo"><span class="fa fa-fw fa-download"></span> <strong>Get Gentoo!</strong></a>
							<div class="btn-group btn-group-sm">
								<a class="btn gentoo-org-sites dropdown-toggle" data-toggle="dropdown" data-target="#" href="#">
									<span class="fa fa-fw fa-map-o"></span> <span class="hidden-xs">gentoo.org sites</span> <span class="caret"></span>
								</a>
								<ul class="dropdown-menu dropdown-menu-right">
									<li><a href="https://www.gentoo.org/" title="Main Gentoo website"><span class="fa fa-home fa-fw"></span> gentoo.org</a></li>
									<li><a href="https://wiki.gentoo.org/" title="Find and contribute documentation"><span class="fa fa-file-text-o fa-fw"></span> Wiki</a></li>
									<li><a href="https://bugs.gentoo.org/" title="Report issues and find common issues"><span class="fa fa-bug fa-fw"></span> Bugs</a></li>
									<li><a href="https://forums.gentoo.org/" title="Discuss with the community"><span class="fa fa-comments-o fa-fw"></span> Forums</a></li>
									<li><a href="https://packages.gentoo.org/" title="Find software for your Gentoo"><span class="fa fa-hdd-o fa-fw"></span> Packages</a></li>
									<li class="divider"></li>
									<li><a href="https://planet.gentoo.org/" title="Find out what's going on in the developer community"><span class="fa fa-rss fa-fw"></span> Planet</a></li>
									<li><a href="https://archives.gentoo.org/" title="Read up on past discussions"><span class="fa fa-archive fa-fw"></span> Archives</a></li>
									<li><a href="https://sources.gentoo.org/" title="Browse our source code"><span class="fa fa-code fa-fw"></span> Sources</a></li>
									<li class="divider"></li>
									<li><a href="https://infra-status.gentoo.org/" title="Get updates on the services provided by Gentoo"><span class="fa fa-server fa-fw"></span> Infra Status</a></li>
								</ul>
							</div>
						</div>
					</div>
					<div class="logo">
						<a href="https://wiki.gentoo.org/" title="Back to the homepage" class="site-logo"><object data="https://1b9a50f4f9de4348cd9f-e703bc50ba0aa66772a874f8c7698be7.ssl.cf5.rackcdn.com/site-logo.svg" type="image/svg+xml">
							<img src="https://1b9a50f4f9de4348cd9f-e703bc50ba0aa66772a874f8c7698be7.ssl.cf5.rackcdn.com/site-logo.png" alt="Gentoo Linux Logo">
						</object></a>
						<span class="site-label">Wiki</span>
					</div>
				</div>
			</div>
		</div>
		<nav class="tyrian-navbar" role="navigation">
			<div class="container">
				<div class="row">
					<div class="navbar-header">
						<button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-main-collapse">
							<span class="sr-only">Toggle navigation</span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
							<span class="icon-bar"></span>
						</button>
					</div>
					<div class="collapse navbar-collapse navbar-main-collapse">
						<ul class="nav navbar-nav">
							<li id="n-mainpage-description"><a href="../../../Main_Page.html" title="Visit the main page [z]" accesskey="z">Main page</a></li><li id="n-recentchanges"><a href="../../../Special_RecentChanges.html" title="A list of recent changes in the wiki [r]" accesskey="r">Recent changes</a></li><li id="n-help"><a href="../../../Special_MyLanguage/Help_Contents.html" title="The place to find out">Help</a></li>			<li class="dropdown">
				<a href="../../../Gentoo_Wiki_Menu-Gentoo.html" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Gentoo <span class="caret"></span></a>
				<ul class="dropdown-menu" role="menu">
		<li id="n-Gentoo-Projects"><a href="../../../Project_Gentoo.html">Gentoo Projects</a></li>				</ul>
			</li>
					<li class="dropdown">
				<a href="../../../Gentoo_Wiki_Menu-Documentation.html" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Documentation <span class="caret"></span></a>
				<ul class="dropdown-menu" role="menu">
		<li id="n-Gentoo-Handbook"><a href="../../../Handbook_Main_Page.html">Gentoo Handbook</a></li><li id="n-Gentoo-FAQ"><a href="../../../FAQ.html">Gentoo FAQ</a></li><li id="n-Featured-Documents"><a href="../../../Project_Documentation/Overview.html">Featured Documents</a></li><li role="presentation" class="divider"></li><li role="presentation" class="dropdown-header">Topics</li><li id="n-Core-system"><a href="../../../Category_Core_system.html">Core system</a></li><li id="n-Hardware"><a href="../../../Category_Hardware.html">Hardware</a></li><li id="n-Software"><a href="../../../Category_Software.html">Software</a></li><li id="n-Desktop"><a href="../../../Category_Desktop.html">Desktop</a></li><li id="n-Server-.26-Security"><a href="../../../Category_Server_and_Security.html">Server &amp; Security</a></li><li id="n-Project-.26-Community"><a href="../../../Category_Project_and_Community.html">Project &amp; Community</a></li>				</ul>
			</li>
								</ul>
						<ul class="nav navbar-nav navbar-right hidden-xs">
									<li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false"><i class="fa fa-cog"></i> Tools <span class="caret"></span></a>
			<ul class="dropdown-menu" role="menu">
				<li id="t-whatlinkshere"><a href="../../../Special_WhatLinksHere/Handbook_AMD64/Full/Installation/zh-cn.html" title="A list of all wiki pages that link here [j]" accesskey="j">What links here</a></li><li id="t-recentchangeslinked"><a href="../../../Special_RecentChangesLinked/Handbook_AMD64/Full/Installation/zh-cn.html" title="Recent changes in pages linked from this page [k]" accesskey="k">Related changes</a></li><li id="t-specialpages"><a href="../../../Special_SpecialPages.html" title="A list of all special pages [q]" accesskey="q">Special pages</a></li><li id="t-print"><a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Full/Installation/zh-cn&amp;printable=yes" rel="alternate" title="Printable version of this page [p]" accesskey="p">Printable version</a></li><li id="t-permalink"><a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Full/Installation/zh-cn&amp;oldid=313126" title="Permanent link to this revision of the page">Permanent link</a></li><li id="t-info"><a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Full/Installation/zh-cn&amp;action=info" title="More information about this page">Page information</a></li><li id="t-smwbrowselink"><a href="../../../Special_Browse/Handbook_AMD64-2FFull-2FInstallation-2Fzh-2Dcn.html" rel="smw-browse">Browse properties</a></li>			</ul>
		</li>
			<li class="dropdown">
			<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
				<span class="glyphicon glyphicon-user" aria-label="Personal tools"></span>
				User				<span class="caret"></span>
			</a>
			<ul class="dropdown-menu" role="menu">
				<li id="pt-createaccount"><a href="https://wiki.gentoo.org/index.php?title=Special:UserLogin&amp;returnto=Handbook%3AAMD64%2FFull%2FInstallation%2Fzh-cn&amp;type=signup" title="You are encouraged to create an account and log in; however, it is not mandatory">Create account</a></li><li id="pt-login"><a href="https://wiki.gentoo.org/index.php?title=Special:UserLogin&amp;returnto=Handbook%3AAMD64%2FFull%2FInstallation%2Fzh-cn" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o">Log in</a></li>			</ul>
		</li>
								</ul>
					</div>
				</div>
			</div>
		</nav>
		
		<nav class="navbar navbar-grey navbar-stick" id="wiki-actions" role="navigation">
			<div class="container"><div class="row">
				<div class="navbar-header">
					<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#gw-toolbar">
						<span class="sr-only">Toggle navigation</span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
						<span class="icon-bar"></span>
					</button>
				</div>
				<div class="collapse navbar-collapse" id="gw-toolbar">
					<ul class="nav navbar-nav">
					<li id="ca-nstab-handbook" class="selected active"><a href="zh-cn.html">Handbook</a></li><li id="ca-talk" class="new"><a href="https://wiki.gentoo.org/index.php?title=Handbook_Talk:AMD64/Full/Installation/zh-cn&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>					</ul>
							<form action="https://wiki.gentoo.org/index.php" id="searchform" class="navbar-form navbar-right" role="search">
			<input type='hidden' name="title" value="Special:Search"/>

				<div class="input-group">
					<input type="search" name="search" placeholder="Search" title="Search Gentoo Wiki [f]" accesskey="f" id="searchInput" class="form-control" />					<div class="input-group-btn"><input type="submit" name="go" value="Go" title="Go to a page with this exact name if it exists" id="searchGoButton" class="searchButton btn btn-default" /><input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton btn btn-default" /></div>
				</div>
		</form>
						<ul class="nav navbar-nav navbar-right hidden-xs">
					<li id="ca-viewsource"><a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Full/Installation/zh-cn&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li><li class="dropdown">
						<a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">more <span class="caret"></span></a>
						<ul class="dropdown-menu" role="menu">
					<li id="ca-history"><a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Full/Installation/zh-cn&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>							</ul>
						</li>
					</ul>
				</div>
			</div></div>
		</nav>
		</header>
	
		<div class="container">
			<div class="row">
				<div class="col-md-12">
					<div id="content" class="mw-body" role="main">
						<a id="top"></a>
						
						<h1 id="firstHeading" class="first-header" lang="zh-CN">
							<span dir="auto">Gentoo Linux  手册：安装Gentoo</span>
						</h1>

						<div id="bodyContent" class="mw-body-content">
							<div id="siteSub">From Gentoo Wiki</div>
							<div id="contentSub">
								<span class="subpages"><a href="../../../Special_MyLanguage/Handbook_AMD64.html" title="Special:MyLanguage/Handbook:AMD64">Handbook:AMD64</a> | <a href="../../../Special_MyLanguage/Handbook_AMD64/Full.html" title="Special:MyLanguage/Handbook:AMD64/Full">Full</a></span>							</div>
																					<div id="jump-to-nav" class="mw-jump">
								Jump to:								<a href="#column-one">navigation</a>, 								<a href="#searchInput">search</a>
							</div>

							<!-- start content -->
							<div id="mw-content-text" lang="zh-CN" dir="ltr" class="mw-content-ltr"><div class="mw-translate-page-info" lang="en" dir="ltr">This page is a <span class="plainlinks"><a rel="nofollow" class="external text" href="http://wiki.gentoo.org/index.php?title=Special:Translate&amp;group=page-Handbook%3AAMD64%2FFull%2FInstallation&amp;action=page&amp;filter=&amp;language=zh-cn">translated version</a></span> of the page <a href="../Installation.html" title="Handbook:AMD64/Full/Installation">Handbook:AMD64/Full/Installation</a> and the translation is 100% complete.</div>
<hr /><div id="toc" class="toc"><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1"><a href="#.E4.BB.8B.E7.BB.8D"><span class="tocnumber">1</span> <span class="toctext">介绍</span></a>
<ul>
<li class="toclevel-2"><a href="#.E6.AC.A2.E8.BF.8E"><span class="tocnumber">1.1</span> <span class="toctext">欢迎</span></a></li>
<li class="toclevel-2"><a href="#.E5.AE.89.E8.A3.85.E6.AD.A5.E9.AA.A4"><span class="tocnumber">1.2</span> <span class="toctext">安装步骤</span></a></li>
<li class="toclevel-2"><a href="#.E6.88.91.E6.9C.89.E5.93.AA.E4.BA.9B.E9.80.89.E6.8B.A9"><span class="tocnumber">1.3</span> <span class="toctext">我有哪些选择</span></a></li>
<li class="toclevel-2"><a href="#.E9.81.87.E5.88.B0.E9.BA.BB.E7.83.A6"><span class="tocnumber">1.4</span> <span class="toctext">遇到麻烦</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E7.A1.AC.E4.BB.B6.E9.9C.80.E6.B1.82"><span class="tocnumber">2</span> <span class="toctext">硬件需求</span></a></li>
<li class="toclevel-1"><a href="#.E4.BD.BF.E7.94.A8Gentoo_Linux.E5.AE.89.E8.A3.85CD"><span class="tocnumber">3</span> <span class="toctext">使用Gentoo Linux安装CD</span></a>
<ul>
<li class="toclevel-2"><a href="#.E6.9C.80.E5.B0.8F.E5.8C.96.E5.AE.89.E8.A3.85CD"><span class="tocnumber">3.1</span> <span class="toctext">最小化安装CD</span></a></li>
<li class="toclevel-2"><a href="#.E5.81.B6.E5.B0.94.E7.94.A8.E5.88.B0.E7.9A.84Gentoo_LiveDVD"><span class="tocnumber">3.2</span> <span class="toctext">偶尔用到的Gentoo LiveDVD</span></a></li>
<li class="toclevel-2"><a href="#stage.E5.8F.88.E6.98.AF.E4.BB.80.E4.B9.88.EF.BC.9F"><span class="tocnumber">3.3</span> <span class="toctext">stage又是什么？</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E4.B8.8B.E8.BD.BD.E5.B9.B6.E5.88.BB.E5.BD.95CD"><span class="tocnumber">4</span> <span class="toctext">下载并刻录CD</span></a>
<ul>
<li class="toclevel-2"><a href="#.E4.B8.8B.E8.BD.BDCD.E5.AE.89.E8.A3.85.E5.AA.92.E4.BB.8B"><span class="tocnumber">4.1</span> <span class="toctext">下载CD安装媒介</span></a></li>
<li class="toclevel-2"><a href="#.E6.A0.A1.E9.AA.8C.E4.B8.8B.E8.BD.BD.E7.9A.84.E6.96.87.E4.BB.B6"><span class="tocnumber">4.2</span> <span class="toctext">校验下载的文件</span></a>
<ul>
<li class="toclevel-3"><a href="#.E5.9C.A8.E5.BE.AE.E8.BD.AF_Windows_.E6.93.8D.E4.BD.9C.E7.B3.BB.E7.BB.9F.E4.B8.8A.E9.AA.8C.E8.AF.81"><span class="tocnumber">4.2.1</span> <span class="toctext">在微软 Windows 操作系统上验证</span></a></li>
<li class="toclevel-3"><a href="#.E5.9F.BA.E4.BA.8ELinux.E7.B3.BB.E7.BB.9F.E7.9A.84.E9.AA.8C.E8.AF.81"><span class="tocnumber">4.2.2</span> <span class="toctext">基于Linux系统的验证</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#.E5.88.BB.E5.BD.95.E5.85.89.E7.9B.98"><span class="tocnumber">4.3</span> <span class="toctext">刻录光盘</span></a>
<ul>
<li class="toclevel-3"><a href="#.E5.9C.A8.E5.BE.AE.E8.BD.AFWindows.E4.B8.8A.E5.88.BB.E5.BD.95"><span class="tocnumber">4.3.1</span> <span class="toctext">在微软Windows上刻录</span></a></li>
<li class="toclevel-3"><a href="#.E5.9C.A8_Linux_.E7.B3.BB.E7.BB.9F.E4.B8.8A.E5.88.BB.E5.BD.95"><span class="tocnumber">4.3.2</span> <span class="toctext">在 Linux 系统上刻录</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E5.90.AF.E5.8A.A8CD.E5.85.89.E7.9B.98"><span class="tocnumber">5</span> <span class="toctext">启动CD光盘</span></a>
<ul>
<li class="toclevel-2"><a href="#.E5.BC.95.E5.AF.BC.E5.AE.89.E8.A3.85CD"><span class="tocnumber">5.1</span> <span class="toctext">引导安装CD</span></a></li>
<li class="toclevel-2"><a href="#.E9.A2.9D.E5.A4.96.E7.9A.84.E7.A1.AC.E4.BB.B6.E9.85.8D.E7.BD.AE"><span class="tocnumber">5.2</span> <span class="toctext">额外的硬件配置</span></a></li>
<li class="toclevel-2"><a href="#.E5.8F.AF.E9.80.89.EF.BC.9A.E7.94.A8.E6.88.B7.E8.B4.A6.E5.8F.B7"><span class="tocnumber">5.3</span> <span class="toctext">可选：用户账号</span></a></li>
<li class="toclevel-2"><a href="#.E5.8F.AF.E9.80.89.EF.BC.9A.E5.9C.A8.E5.AE.89.E8.A3.85.E6.97.B6.E6.9F.A5.E7.9C.8B.E6.96.87.E6.A1.A3"><span class="tocnumber">5.4</span> <span class="toctext">可选：在安装时查看文档</span></a></li>
<li class="toclevel-2"><a href="#.E5.8F.AF.E9.80.89.EF.BC.9A.E5.90.AF.E5.8A.A8SSH.E6.9C.8D.E5.8A.A1"><span class="tocnumber">5.5</span> <span class="toctext">可选：启动SSH服务</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Automatic_network_detection"><span class="tocnumber">6</span> <span class="toctext">Automatic network detection</span></a>
<ul>
<li class="toclevel-2"><a href="#Optional:_Configure_any_proxies"><span class="tocnumber">6.1</span> <span class="toctext">Optional: Configure any proxies</span></a></li>
<li class="toclevel-2"><a href="#Testing_the_network"><span class="tocnumber">6.2</span> <span class="toctext">Testing the network</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Automatic_network_configuration"><span class="tocnumber">7</span> <span class="toctext">Automatic network configuration</span></a>
<ul>
<li class="toclevel-2"><a href="#Default:_Using_net-setup"><span class="tocnumber">7.1</span> <span class="toctext">Default: Using net-setup</span></a></li>
<li class="toclevel-2"><a href="#Alternative:_Using_PPP"><span class="tocnumber">7.2</span> <span class="toctext">Alternative: Using PPP</span></a></li>
<li class="toclevel-2"><a href="#Alternative:_Using_PPTP"><span class="tocnumber">7.3</span> <span class="toctext">Alternative: Using PPTP</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Manual_network_configuration"><span class="tocnumber">8</span> <span class="toctext">Manual network configuration</span></a>
<ul>
<li class="toclevel-2"><a href="#Loading_the_appropriate_network_modules"><span class="tocnumber">8.1</span> <span class="toctext">Loading the appropriate network modules</span></a></li>
<li class="toclevel-2"><a href="#Using_DHCP"><span class="tocnumber">8.2</span> <span class="toctext">Using DHCP</span></a></li>
<li class="toclevel-2"><a href="#Preparing_for_wireless_access"><span class="tocnumber">8.3</span> <span class="toctext">Preparing for wireless access</span></a></li>
<li class="toclevel-2"><a href="#Understanding_network_terminology"><span class="tocnumber">8.4</span> <span class="toctext">Understanding network terminology</span></a></li>
<li class="toclevel-2"><a href="#Using_ifconfig_and_route"><span class="tocnumber">8.5</span> <span class="toctext">Using ifconfig and route</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E5.9D.97.E8.AE.BE.E5.A4.87.E7.AE.80.E4.BB.8B"><span class="tocnumber">9</span> <span class="toctext">块设备简介</span></a>
<ul>
<li class="toclevel-2"><a href="#.E5.9D.97.E8.AE.BE.E5.A4.87"><span class="tocnumber">9.1</span> <span class="toctext">块设备</span></a></li>
<li class="toclevel-2"><a href="#.E5.88.86.E5.8C.BA"><span class="tocnumber">9.2</span> <span class="toctext">分区</span></a>
<ul>
<li class="toclevel-3"><a href="#MBR"><span class="tocnumber">9.2.1</span> <span class="toctext">MBR</span></a></li>
<li class="toclevel-3"><a href="#GPT"><span class="tocnumber">9.2.2</span> <span class="toctext">GPT</span></a></li>
</ul>
</li>
<li class="toclevel-2"><a href="#GPT.E8.BF.98.E6.98.AFMBR"><span class="tocnumber">9.3</span> <span class="toctext">GPT还是MBR</span></a></li>
<li class="toclevel-2"><a href="#.E4.BD.BF.E7.94.A8UEFI"><span class="tocnumber">9.4</span> <span class="toctext">使用UEFI</span></a></li>
<li class="toclevel-2"><a href="#.E9.AB.98.E7.BA.A7.E5.AD.98.E5.82.A8"><span class="tocnumber">9.5</span> <span class="toctext">高级存储</span></a></li>
<li class="toclevel-2"><a href="#.E9.BB.98.E8.AE.A4.E5.88.86.E5.8C.BA.E6.96.B9.E6.A1.88"><span class="tocnumber">9.6</span> <span class="toctext">默认分区方案</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E8.AE.BE.E8.AE.A1.E4.B8.80.E4.B8.AA.E5.88.86.E5.8C.BA.E6.96.B9.E6.A1.88"><span class="tocnumber">10</span> <span class="toctext">设计一个分区方案</span></a>
<ul>
<li class="toclevel-2"><a href="#.E5.A4.9A.E5.B0.91.E4.B8.AA.E4.BB.A5.E5.8F.8A.E5.A4.9A.E5.A4.A7.EF.BC.9F"><span class="tocnumber">10.1</span> <span class="toctext">多少个以及多大？</span></a></li>
<li class="toclevel-2"><a href="#.E9.82.A3.E4.B9.88swap.E7.A9.BA.E9.97.B4.E5.91.A2.EF.BC.9F"><span class="tocnumber">10.2</span> <span class="toctext">那么swap空间呢？</span></a></li>
<li class="toclevel-2"><a href="#.E4.BB.80.E4.B9.88.E6.98.AFBIOS.E5.BC.95.E5.AF.BC.E5.88.86.E5.8C.BA.EF.BC.9F"><span class="tocnumber">10.3</span> <span class="toctext">什么是BIOS引导分区？</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E9.BB.98.E8.AE.A4.EF.BC.9A.E4.BD.BF.E7.94.A8parted.E5.AF.B9.E7.A3.81.E7.9B.98.E8.BF.9B.E8.A1.8C.E5.88.86.E5.8C.BA"><span class="tocnumber">11</span> <span class="toctext">默认：使用parted对磁盘进行分区</span></a>
<ul>
<li class="toclevel-2"><a href="#.E4.BD.BF.E7.94.A8parted.E6.9F.A5.E7.9C.8B.E5.BD.93.E5.89.8D.E5.88.86.E5.8C.BA.E5.B8.83.E5.B1.80"><span class="tocnumber">11.1</span> <span class="toctext">使用parted查看当前分区布局</span></a></li>
<li class="toclevel-2"><a href="#.E8.AE.BE.E7.BD.AEGPT.E6.A0.87.E7.AD.BE"><span class="tocnumber">11.2</span> <span class="toctext">设置GPT标签</span></a></li>
<li class="toclevel-2"><a href="#.E4.BD.BF.E7.94.A8parted.E7.A7.BB.E9.99.A4.E5.85.A8.E9.83.A8.E5.88.86.E5.8C.BA"><span class="tocnumber">11.3</span> <span class="toctext">使用parted移除全部分区</span></a></li>
<li class="toclevel-2"><a href="#.E5.88.9B.E5.BB.BA.E5.88.86.E5.8C.BA"><span class="tocnumber">11.4</span> <span class="toctext">创建分区</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E5.A4.87.E9.80.89.EF.BC.9A.E4.BD.BF.E7.94.A8fdisk.E5.AF.B9.E7.A3.81.E7.9B.98.E8.BF.9B.E8.A1.8C.E5.88.86.E5.8C.BA"><span class="tocnumber">12</span> <span class="toctext">备选：使用fdisk对磁盘进行分区</span></a>
<ul>
<li class="toclevel-2"><a href="#.E6.9F.A5.E7.9C.8B.E5.BD.93.E5.89.8D.E5.88.86.E5.8C.BA.E5.B8.83.E5.B1.80"><span class="tocnumber">12.1</span> <span class="toctext">查看当前分区布局</span></a></li>
<li class="toclevel-2"><a href="#.E4.BD.BF.E7.94.A8fdisk.E7.A7.BB.E9.99.A4.E5.85.A8.E9.83.A8.E5.88.86.E5.8C.BA"><span class="tocnumber">12.2</span> <span class="toctext">使用fdisk移除全部分区</span></a></li>
<li class="toclevel-2"><a href="#.E5.88.9B.E5.BB.BABIOS.E5.BC.95.E5.AF.BC.E5.88.86.E5.8C.BA"><span class="tocnumber">12.3</span> <span class="toctext">创建BIOS引导分区</span></a></li>
<li class="toclevel-2"><a href="#.E5.88.9B.E5.BB.BA.E5.BC.95.E5.AF.BC.E5.88.86.E5.8C.BA"><span class="tocnumber">12.4</span> <span class="toctext">创建引导分区</span></a></li>
<li class="toclevel-2"><a href="#.E5.88.9B.E5.BB.BAswap.E5.88.86.E5.8C.BA"><span class="tocnumber">12.5</span> <span class="toctext">创建swap分区</span></a></li>
<li class="toclevel-2"><a href="#.E5.88.9B.E5.BB.BA.E6.A0.B9.E5.88.86.E5.8C.BA"><span class="tocnumber">12.6</span> <span class="toctext">创建根分区</span></a></li>
<li class="toclevel-2"><a href="#.E4.BF.9D.E5.AD.98.E5.88.86.E5.8C.BA.E5.B8.83.E5.B1.80"><span class="tocnumber">12.7</span> <span class="toctext">保存分区布局</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E5.88.9B.E5.BB.BA.E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F"><span class="tocnumber">13</span> <span class="toctext">创建文件系统</span></a>
<ul>
<li class="toclevel-2"><a href="#.E4.BB.8B.E7.BB.8D_2"><span class="tocnumber">13.1</span> <span class="toctext">介绍</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F"><span class="tocnumber">14</span> <span class="toctext">文件系统</span></a>
<ul>
<li class="toclevel-2"><a href="#.E4.B8.BA.E5.88.86.E5.8C.BA.E5.BA.94.E7.94.A8.E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F"><span class="tocnumber">14.1</span> <span class="toctext">为分区应用文件系统</span></a></li>
<li class="toclevel-2"><a href="#.E6.BF.80.E6.B4.BBswap.E5.88.86.E5.8C.BA"><span class="tocnumber">14.2</span> <span class="toctext">激活swap分区</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E6.8C.82.E8.BD.BD"><span class="tocnumber">15</span> <span class="toctext">挂载</span></a></li>
<li class="toclevel-1"><a href="#Installing_a_stage_tarball"><span class="tocnumber">16</span> <span class="toctext">Installing a stage tarball</span></a>
<ul>
<li class="toclevel-2"><a href="#Setting_the_date_and_time"><span class="tocnumber">16.1</span> <span class="toctext">Setting the date and time</span></a></li>
<li class="toclevel-2"><a href="#Downloading_the_stage_tarball"><span class="tocnumber">16.2</span> <span class="toctext">Downloading the stage tarball</span></a></li>
<li class="toclevel-2"><a href="#Unpacking_the_stage_tarball"><span class="tocnumber">16.3</span> <span class="toctext">Unpacking the stage tarball</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Configuring_compile_options"><span class="tocnumber">17</span> <span class="toctext">Configuring compile options</span></a>
<ul>
<li class="toclevel-2"><a href="#Introduction"><span class="tocnumber">17.1</span> <span class="toctext">Introduction</span></a></li>
<li class="toclevel-2"><a href="#CFLAGS_and_CXXFLAGS"><span class="tocnumber">17.2</span> <span class="toctext">CFLAGS and CXXFLAGS</span></a></li>
<li class="toclevel-2"><a href="#MAKEOPTS"><span class="tocnumber">17.3</span> <span class="toctext">MAKEOPTS</span></a></li>
<li class="toclevel-2"><a href="#Ready.2C_set.2C_go"><span class="tocnumber">17.4</span> <span class="toctext">Ready, set, go</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Chrooting"><span class="tocnumber">18</span> <span class="toctext">Chrooting</span></a>
<ul>
<li class="toclevel-2"><a href="#.E5.8F.AF.E9.80.89.EF.BC.9A.E9.80.89.E6.8B.A9.E5.A2.83.E5.83.8F.E7.AB.99.E7.82.B9"><span class="tocnumber">18.1</span> <span class="toctext">可选：选择境像站点</span></a></li>
<li class="toclevel-2"><a href="#.E5.A4.8D.E5.88.B6DNS.E4.BF.A1.E6.81.AF"><span class="tocnumber">18.2</span> <span class="toctext">复制DNS信息</span></a></li>
<li class="toclevel-2"><a href="#.E6.8C.82.E8.BD.BD.E5.BF.85.E8.A6.81.E7.9A.84.E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F"><span class="tocnumber">18.3</span> <span class="toctext">挂载必要的文件系统</span></a></li>
<li class="toclevel-2"><a href="#.E8.BF.9B.E5.85.A5.E6.96.B0.E7.8E.AF.E5.A2.83"><span class="tocnumber">18.4</span> <span class="toctext">进入新环境</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E9.85.8D.E7.BD.AEPortage"><span class="tocnumber">19</span> <span class="toctext">配置Portage</span></a>
<ul>
<li class="toclevel-2"><a href="#.E5.AE.89.E8.A3.85Portage.E5.BF.AB.E7.85.A7"><span class="tocnumber">19.1</span> <span class="toctext">安装Portage快照</span></a></li>
<li class="toclevel-2"><a href="#.E5.8F.AF.E9.80.89.EF.BC.9A.E6.9B.B4.E6.96.B0Portage.E6.A0.91"><span class="tocnumber">19.2</span> <span class="toctext">可选：更新Portage树</span></a></li>
<li class="toclevel-2"><a href="#.E9.98.85.E8.AF.BB.E6.96.B0.E9.97.BB.E6.9D.A1.E7.9B.AE"><span class="tocnumber">19.3</span> <span class="toctext">阅读新闻条目</span></a></li>
<li class="toclevel-2"><a href="#.E9.80.89.E6.8B.A9.E6.AD.A3.E7.A1.AE.E7.9A.84.E9.85.8D.E7.BD.AE.E6.96.87.E4.BB.B6"><span class="tocnumber">19.4</span> <span class="toctext">选择正确的配置文件</span></a></li>
<li class="toclevel-2"><a href="#.E9.85.8D.E7.BD.AEUSE.E5.8F.98.E9.87.8F"><span class="tocnumber">19.5</span> <span class="toctext">配置USE变量</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E5.8F.AF.E9.80.89.EF.BC.9A.E4.BD.BF.E7.94.A8systemd"><span class="tocnumber">20</span> <span class="toctext">可选：使用systemd</span></a></li>
<li class="toclevel-1"><a href="#.E6.97.B6.E5.8C.BA"><span class="tocnumber">21</span> <span class="toctext">时区</span></a></li>
<li class="toclevel-1"><a href="#.E9.85.8D.E7.BD.AE.E5.9C.B0.E5.8C.BA"><span class="tocnumber">22</span> <span class="toctext">配置地区</span></a></li>
<li class="toclevel-1"><a href="#.E5.AE.89.E8.A3.85.E6.BA.90.E7.A0.81"><span class="tocnumber">23</span> <span class="toctext">安装源码</span></a></li>
<li class="toclevel-1"><a href="#.E9.BB.98.E8.AE.A4.EF.BC.9A.E6.89.8B.E5.8A.A8.E9.85.8D.E7.BD.AE"><span class="tocnumber">24</span> <span class="toctext">默认：手动配置</span></a>
<ul>
<li class="toclevel-2"><a href="#.E4.BB.8B.E7.BB.8D_3"><span class="tocnumber">24.1</span> <span class="toctext">介绍</span></a></li>
<li class="toclevel-2"><a href="#Activating_required_options"><span class="tocnumber">24.2</span> <span class="toctext">Activating required options</span></a></li>
<li class="toclevel-2"><a href="#Architecture_specific_kernel_configuration"><span class="tocnumber">24.3</span> <span class="toctext">Architecture specific kernel configuration</span></a></li>
<li class="toclevel-2"><a href="#Compiling_and_installing"><span class="tocnumber">24.4</span> <span class="toctext">Compiling and installing</span></a></li>
<li class="toclevel-2"><a href="#.E5.8F.AF.E9.80.89:.E5.BB.BA.E9.80.A0initramfs"><span class="tocnumber">24.5</span> <span class="toctext">可选:建造initramfs</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E5.A4.87.E9.80.89.EF.BC.9A.E4.BD.BF.E7.94.A8genkernel"><span class="tocnumber">25</span> <span class="toctext">备选：使用genkernel</span></a></li>
<li class="toclevel-1"><a href="#.E5.86.85.E6.A0.B8.E6.A8.A1.E5.9D.97"><span class="tocnumber">26</span> <span class="toctext">内核模块</span></a>
<ul>
<li class="toclevel-2"><a href="#.E9.85.8D.E7.BD.AE.E6.A8.A1.E5.9D.97"><span class="tocnumber">26.1</span> <span class="toctext">配置模块</span></a></li>
<li class="toclevel-2"><a href="#.E5.8F.AF.E9.80.89.EF.BC.9A.E5.AE.89.E8.A3.85.E5.9B.BA.E4.BB.B6"><span class="tocnumber">26.2</span> <span class="toctext">可选：安装固件</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Filesystem_information"><span class="tocnumber">27</span> <span class="toctext">Filesystem information</span></a>
<ul>
<li class="toclevel-2"><a href="#About_fstab"><span class="tocnumber">27.1</span> <span class="toctext">About fstab</span></a></li>
<li class="toclevel-2"><a href="#Creating_the_fstab_file"><span class="tocnumber">27.2</span> <span class="toctext">Creating the fstab file</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#Networking_information"><span class="tocnumber">28</span> <span class="toctext">Networking information</span></a>
<ul>
<li class="toclevel-2"><a href="#Host_and_domain_information"><span class="tocnumber">28.1</span> <span class="toctext">Host and domain information</span></a></li>
<li class="toclevel-2"><a href="#Configuring_the_network"><span class="tocnumber">28.2</span> <span class="toctext">Configuring the network</span></a></li>
<li class="toclevel-2"><a href="#Automatically_start_networking_at_boot"><span class="tocnumber">28.3</span> <span class="toctext">Automatically start networking at boot</span></a></li>
<li class="toclevel-2"><a href="#The_hosts_file"><span class="tocnumber">28.4</span> <span class="toctext">The hosts file</span></a></li>
<li class="toclevel-2"><a href="#Optional:_Get_PCMCIA_working"><span class="tocnumber">28.5</span> <span class="toctext">Optional: Get PCMCIA working</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#System_information"><span class="tocnumber">29</span> <span class="toctext">System information</span></a>
<ul>
<li class="toclevel-2"><a href="#Root_password"><span class="tocnumber">29.1</span> <span class="toctext">Root password</span></a></li>
<li class="toclevel-2"><a href="#Init_and_boot_configuration"><span class="tocnumber">29.2</span> <span class="toctext">Init and boot configuration</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#System_logger"><span class="tocnumber">30</span> <span class="toctext">System logger</span></a></li>
<li class="toclevel-1"><a href="#Optional:_Cron_daemon"><span class="tocnumber">31</span> <span class="toctext">Optional: Cron daemon</span></a></li>
<li class="toclevel-1"><a href="#Optional:_File_indexing"><span class="tocnumber">32</span> <span class="toctext">Optional: File indexing</span></a></li>
<li class="toclevel-1"><a href="#Optional:_Remote_access"><span class="tocnumber">33</span> <span class="toctext">Optional: Remote access</span></a></li>
<li class="toclevel-1"><a href="#Filesystem_tools"><span class="tocnumber">34</span> <span class="toctext">Filesystem tools</span></a></li>
<li class="toclevel-1"><a href="#Networking_tools"><span class="tocnumber">35</span> <span class="toctext">Networking tools</span></a>
<ul>
<li class="toclevel-2"><a href="#Installing_a_DHCP_client"><span class="tocnumber">35.1</span> <span class="toctext">Installing a DHCP client</span></a></li>
<li class="toclevel-2"><a href="#Optional:_Installing_a_PPPoE_client"><span class="tocnumber">35.2</span> <span class="toctext">Optional: Installing a PPPoE client</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E9.87.8D.E5.90.AF.E7.B3.BB.E7.BB.9F"><span class="tocnumber">36</span> <span class="toctext">重启系统</span></a></li>
<li class="toclevel-1"><a href="#User_administration"><span class="tocnumber">37</span> <span class="toctext">User administration</span></a>
<ul>
<li class="toclevel-2"><a href="#Adding_a_user_for_daily_use"><span class="tocnumber">37.1</span> <span class="toctext">Adding a user for daily use</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E7.A3.81.E7.9B.98.E6.B8.85.E7.90.86"><span class="tocnumber">38</span> <span class="toctext">磁盘清理</span></a>
<ul>
<li class="toclevel-2"><a href="#Removing_tarballs"><span class="tocnumber">38.1</span> <span class="toctext">Removing tarballs</span></a></li>
</ul>
</li>
<li class="toclevel-1"><a href="#.E4.B8.8B.E4.B8.80.E6.AD.A5.E8.AF.A5.E5.81.9A.E4.BB.80.E4.B9.88.EF.BC.9F"><span class="tocnumber">39</span> <span class="toctext">下一步该做什么？</span></a>
<ul>
<li class="toclevel-2"><a href="#.E6.96.87.E6.A1.A3"><span class="tocnumber">39.1</span> <span class="toctext">文档</span></a></li>
<li class="toclevel-2"><a href="#.E7.BA.BF.E4.B8.8AGentoo"><span class="tocnumber">39.2</span> <span class="toctext">线上Gentoo</span></a></li>
</ul>
</li>
</ul>
</div>

<p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 安装
</th></tr>
<tr>
<td> <a href="../../Installation/About/zh-cn.html" title="Handbook:AMD64/Installation/About/zh-cn">关于安装</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media/zh-cn.html" title="Handbook:AMD64/Installation/Media/zh-cn">选择安装媒介</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking/zh-cn.html" title="Handbook:AMD64/Installation/Networking/zh-cn">配置网络</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks/zh-cn.html" title="Handbook:AMD64/Installation/Disks/zh-cn">准备磁盘</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage/zh-cn.html" title="Handbook:AMD64/Installation/Stage/zh-cn">安装stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base/zh-cn.html" title="Handbook:AMD64/Installation/Base/zh-cn">安装基本系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel/zh-cn.html" title="Handbook:AMD64/Installation/Kernel/zh-cn">配置Linux内核</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System/zh-cn.html" title="Handbook:AMD64/Installation/System/zh-cn">配置系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools/zh-cn.html" title="Handbook:AMD64/Installation/Tools/zh-cn">安装系统工具</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader/zh-cn.html" title="Handbook:AMD64/Installation/Bootloader/zh-cn">配置系统引导程序Bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing/zh-cn.html" title="Handbook:AMD64/Installation/Finalizing/zh-cn">收尾安装工作</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage/zh-cn.html" title="Handbook:AMD64/Working/Portage/zh-cn">Portage介绍</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE/zh-cn.html" title="Handbook:AMD64/Working/USE/zh-cn">USE标记</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features/zh-cn.html" title="Handbook:AMD64/Working/Features/zh-cn">Portage功能特性</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts/zh-cn.html" title="Handbook:AMD64/Working/Initscripts/zh-cn">初始化脚本（Initscript）系统</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar/zh-cn.html" title="Handbook:AMD64/Working/EnvVar/zh-cn">环境变量</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files/zh-cn.html" title="Handbook:AMD64/Portage/Files/zh-cn">文件和目录</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables/zh-cn.html" title="Handbook:AMD64/Portage/Variables/zh-cn">变量</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches/zh-cn.html" title="Handbook:AMD64/Portage/Branches/zh-cn">混合使用不同的软件分支</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools/zh-cn.html" title="Handbook:AMD64/Portage/Tools/zh-cn">额外的工具</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree/zh-cn.html" title="Handbook:AMD64/Portage/CustomTree/zh-cn">定制Portage树</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced/zh-cn.html" title="Handbook:AMD64/Portage/Advanced/zh-cn">高级特性</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 网络配置
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction/zh-cn.html" title="Handbook:AMD64/Networking/Introduction/zh-cn">入门</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced/zh-cn.html" title="Handbook:AMD64/Networking/Advanced/zh-cn">高级配置</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular/zh-cn.html" title="Handbook:AMD64/Networking/Modular/zh-cn">模块化网络</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless/zh-cn.html" title="Handbook:AMD64/Networking/Wireless/zh-cn">无线</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending/zh-cn.html" title="Handbook:AMD64/Networking/Extending/zh-cn">添加功能</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic/zh-cn.html" title="Handbook:AMD64/Networking/Dynamic/zh-cn">动态管理</a>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id=".E4.BB.8B.E7.BB.8D">介绍</span></h2>
<h3><span class="mw-headline" id=".E6.AC.A2.E8.BF.8E">欢迎</span></h3>
<p>首先，欢迎使用Gentoo，您将会进入一个选择自由和性能至上的世界。Gentoo的一切都是为了自由选择。在安装Gentoo时就数次明确表明了这一特点——用户可以自己选择想要编译的一切内容、选择安装Gentoo的方式、选择想用的系统日志程序等等。
</p><p>Gentoo 是一个快速、现代化的元发行版，它的设计简洁、灵活。Gentoo 围绕自由软件建立，它不会对它的用户隐瞒“引擎盖下的细节”。Gentoo 所使用的软件包维护系统 Portage 是用 Python 编写的，这意味着用户可以轻松地查看和修改它的源代码。 Gentoo 的软件包管理系统使用源代码包（虽然也支持预编译软件包），并通过标准的文本文件配置Gentoo。换句话说，开放无处不在。
</p><p>“自由选择”是 Gentoo 运行的关键，这点很重要，大家要理解。我们尽量不强迫用户去做任何他们不喜欢的事情。如果有人有不同看法，请上报<a rel="nofollow" class="external text" href="https://bugs.gentoo.org/">bug report</a> 。
</p>
<h3><span class="mw-headline" id=".E5.AE.89.E8.A3.85.E6.AD.A5.E9.AA.A4">安装步骤</span></h3>
<p>Gentoo的安装可以被分成10个步骤，分别对应后续的章节。执行完每个步骤，都会让系统进入某种确定的状态：
</p>
<table class="table-condensed table-striped">

<tr>
<th scope="col" width="15%"> 步骤 </th>
<th> 结果
</th></tr>
<tr>
<td> 1 </td>
<td> 用户处于一个准备好安装Gentoo的工作环境中。
</td></tr>
<tr>
<td> 2 </td>
<td> 用于安装Gentoo的互联网连接已经准备完毕。
</td></tr>
<tr>
<td> 3 </td>
<td> 硬盘已经为Gentoo的安装初始化完毕。
</td></tr>
<tr>
<td> 4 </td>
<td> 安装环境已经准备好，用户准备chroot到新环境中去。
</td></tr>
<tr>
<td> 5 </td>
<td> 那些在所有Gentoo安装中都相同的核心软件包已经安装完毕。
</td></tr>
<tr>
<td> 6 </td>
<td> Linux内核已经安装完毕。
</td></tr>
<tr>
<td> 7 </td>
<td> 用户已经配置好大部分的Gentoo系统配置文件。
</td></tr>
<tr>
<td> 8 </td>
<td> 必要的系统工具已经安装完毕。
</td></tr>
<tr>
<td> 9 </td>
<td> 合适的启动引导程序 (Bootloader) 已经安装配置完毕。
</td></tr>
<tr>
<td> 10 </td>
<td> 登录系统，你就可以在已经全新安装完毕的Gentoo Linux系统中尽情探索了！
</td></tr></table>
<p>当面临选择的时候，手册上会尽量说明每个选择的利弊。虽然手册会以默认选择（标题中有 “默认Default：” 标记）继续描述下去，但其他可能的选择同样也会在文档中说明（标题中有 “可选Alternative：” 标记）。请不要认为默认选择是Gentoo的推荐，这只不过是Gentoo认为大多数用户会使用的选择。
</p><p>有时候你也可以进行一些可选的步骤。这样的步骤会被标注为“可选Optional：”，当然这些步骤对于安装Gentoo来说就不是必须的。然而，有些可选的步骤依赖于你先前所做出的决定。我们将会在你需要做这样决定以及可选步骤出现的时候提醒你。
</p>
<h3><span class="mw-headline" id=".E6.88.91.E6.9C.89.E5.93.AA.E4.BA.9B.E9.80.89.E6.8B.A9">我有哪些选择</span></h3>
<p>Gentoo有很多种不同的安装方式。下载和安装Gentoo可以通过以下方式：各种Gentoo安装光盘的其中之一、已经安装好的某个发行版、非Gentoo的Linux可引导光盘（比如Knoppix）、网络启动环境、恢复软盘等等。
</p><p>本文讲解了如何使用Gentoo安装光盘或者在某些情况下使用网络启动来安装Gentoo。
</p>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />需要其他安装方式的帮助（包括使用非Gentoo的Linux引导光盘）请阅读我们的 <a href="../../../Installation_alternatives.html" title="Installation alternatives">Alternative Installation guide</a>.</div>
<p>我们也提供一个 <a href="../../../Gentoo_installation_tips_and_tricks.html" title="Gentoo installation tips and tricks">Gentoo Installation Tips and Tricks</a> 它可能值得一看。
</p>
<h3><span class="mw-headline" id=".E9.81.87.E5.88.B0.E9.BA.BB.E7.83.A6">遇到麻烦</span></h3>
<p>如果在安装（或安装文档中）发现问题,请访问我们的<a rel="nofollow" class="external text" href="https://bugs.gentoo.org/">bug跟踪系统</a> 并确认这个Bug是否已经被提交。如果没有提交，请为它创建一个错误报告以方便我们的后续处理。不要害怕和被分配解决这个问题的开发人员交流——他们(通常)不吃人。
</p><p>需要注意的是，虽然你当前阅读的文档是针对某一特定的硬件架构，但是它还是会包含对其他平台架构的引用。这是因为Gentoo手册中的绝大部分的源代码是对所有硬件架构都适用的（目的是减少重复劳动和节省有限的开发资源）。我们会努力把这种负面影响减少到最小以避免造成混淆。
</p><p>如果你不能确定你的问题是否是使用者的操作问题（尽管你已经仔细地阅读了文档但仍然出了错）还是一个软件问题（尽管我们已经仔细地测试了安装步骤/文档但仍然出了错）。请联系我们： irc.freenode.net 上的 <span style="font-family: monospace; font-size: 95%;"><a rel="nofollow" class="external text" href="irc://irc.gentoo.org/gentoo">#gentoo</a></span>。当然，如果你有其他方面的关于Gentoo的问题，我们也欢迎你来这里讨论 。
</p><p>说到这里,如果还有任何额外的Gentoo问题,看看我们 <a href="../../../Main_Page.html" title="Main Page">Wiki</a> 上的 <a href="../../../FAQ.html" title="FAQ">Frequently Asked Questions</a> ，或者<a rel="nofollow" class="external text" href="https://forums.gentoo.org/">Gentoo论坛</a> 上的 <a rel="nofollow" class="external text" href="https://forums.gentoo.org/viewforum.php?f=40">FAQs</a> 。
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../zh-cn.html" title="Previous part" class="btn btn-default">&#8592; </a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Installation/Media/zh-cn.html" title="Next part" class="btn btn-default">选择媒介 &#8594;</a></div>
<p><br />
</p><p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 安装
</th></tr>
<tr>
<td> <a href="../../Installation/About/zh-cn.html" title="Handbook:AMD64/Installation/About/zh-cn">关于安装</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media/zh-cn.html" title="Handbook:AMD64/Installation/Media/zh-cn">选择安装媒介</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking/zh-cn.html" title="Handbook:AMD64/Installation/Networking/zh-cn">配置网络</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks/zh-cn.html" title="Handbook:AMD64/Installation/Disks/zh-cn">准备磁盘</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage/zh-cn.html" title="Handbook:AMD64/Installation/Stage/zh-cn">安装stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base/zh-cn.html" title="Handbook:AMD64/Installation/Base/zh-cn">安装基本系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel/zh-cn.html" title="Handbook:AMD64/Installation/Kernel/zh-cn">配置Linux内核</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System/zh-cn.html" title="Handbook:AMD64/Installation/System/zh-cn">配置系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools/zh-cn.html" title="Handbook:AMD64/Installation/Tools/zh-cn">安装系统工具</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader/zh-cn.html" title="Handbook:AMD64/Installation/Bootloader/zh-cn">配置系统引导程序Bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing/zh-cn.html" title="Handbook:AMD64/Installation/Finalizing/zh-cn">收尾安装工作</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage/zh-cn.html" title="Handbook:AMD64/Working/Portage/zh-cn">Portage介绍</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE/zh-cn.html" title="Handbook:AMD64/Working/USE/zh-cn">USE标记</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features/zh-cn.html" title="Handbook:AMD64/Working/Features/zh-cn">Portage功能特性</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts/zh-cn.html" title="Handbook:AMD64/Working/Initscripts/zh-cn">初始化脚本（Initscript）系统</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar/zh-cn.html" title="Handbook:AMD64/Working/EnvVar/zh-cn">环境变量</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files/zh-cn.html" title="Handbook:AMD64/Portage/Files/zh-cn">文件和目录</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables/zh-cn.html" title="Handbook:AMD64/Portage/Variables/zh-cn">变量</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches/zh-cn.html" title="Handbook:AMD64/Portage/Branches/zh-cn">混合使用不同的软件分支</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools/zh-cn.html" title="Handbook:AMD64/Portage/Tools/zh-cn">额外的工具</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree/zh-cn.html" title="Handbook:AMD64/Portage/CustomTree/zh-cn">定制Portage树</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced/zh-cn.html" title="Handbook:AMD64/Portage/Advanced/zh-cn">高级特性</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 网络配置
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction/zh-cn.html" title="Handbook:AMD64/Networking/Introduction/zh-cn">入门</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced/zh-cn.html" title="Handbook:AMD64/Networking/Advanced/zh-cn">高级配置</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular/zh-cn.html" title="Handbook:AMD64/Networking/Modular/zh-cn">模块化网络</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless/zh-cn.html" title="Handbook:AMD64/Networking/Wireless/zh-cn">无线</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending/zh-cn.html" title="Handbook:AMD64/Networking/Extending/zh-cn">添加功能</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic/zh-cn.html" title="Handbook:AMD64/Networking/Dynamic/zh-cn">动态管理</a>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id=".E7.A1.AC.E4.BB.B6.E9.9C.80.E6.B1.82">硬件需求</span></h2>
<p>在开始之前，我们先列出在一台 amd64 的主机上成功安装Gentoo所必须的硬件需求。
</p><p><br />
</p>
<table class="table" style="text-align: left;">

<tr>
<td>
</td>
<th> 最小化CD
</th>
<th> LiveDVD
</th></tr>
<tr>
<th> CPU
</th>
<td colspan="2"> 任何AMD64 CPU或<a rel="nofollow" class="external text" href="http://en.wikipedia.org/wiki/EMT64#Intel_64">EM64T</a> CPU（Core 2双核和四核处理器都是EM64T）
</td></tr>
<tr>
<th> 内存
</th>
<td> 256 MB
</td>
<td> 512 MB
</td></tr>
<tr>
<th> 磁盘空间
</th>
<td colspan="2">2.5 GB（不包括swap空间）
</td></tr>
<tr>
<th> Swap空间
</th>
<td colspan="2">至少256 MB
</td></tr></table>
<p><a href="../../../Project_AMD64.html" title="Project:AMD64">Gentoo AMD64 项目</a> 是一个获取关于Gentoo的  <b><span style="font-family: monospace; font-size: 95%; color: #54487a">amd64</span></b> 支持的更多信息的好地方。
</p><p><br />
</p>
<h2><span class="mw-headline" id=".E4.BD.BF.E7.94.A8Gentoo_Linux.E5.AE.89.E8.A3.85CD">使用Gentoo Linux安装CD</span></h2>
<h3><span class="mw-headline" id=".E6.9C.80.E5.B0.8F.E5.8C.96.E5.AE.89.E8.A3.85CD">最小化安装CD</span></h3>
<p>Gentoo最小化安装CD是一张包含有完整Gentoo环境的可引导CD。它允许用户从CD引导进入Linux。在引导过程中将检测硬件并加载适当的驱动。这张CD由Gentoo开发人员维护，能让任何有Internet连接的人来安装Gentoo。
</p><p>最小化安装CD叫做<span style="font-family: monospace; font-size: 95%">install-amd64-minimal-&lt;release&gt;.iso</span>.
</p>
<h3><span class="mw-headline" id=".E5.81.B6.E5.B0.94.E7.94.A8.E5.88.B0.E7.9A.84Gentoo_LiveDVD">偶尔用到的Gentoo LiveDVD</span></h3>
<p>有时候需要用一张由Gentoo Ten项目特制的DVD来安装Gentoo。接下来的介绍是针对最小化安装CD的，因此可能会有一点不同。不管怎么样，LiveDVD（或任何其他可引导的Linux环境）支持通过在终端调输入 <span style="font-family: monospace; font-size: 95%; font-weight: bold;">sudo su -</span> 或者 <span style="font-family: monospace; font-size: 95%; font-weight: bold;">sudo -i</span> 来获取所需权限。
</p>
<h3><span class="mw-headline" id="stage.E5.8F.88.E6.98.AF.E4.BB.80.E4.B9.88.EF.BC.9F">stage又是什么？</span></h3>
<p>stage3压缩包是一个包含有最小化Gentoo环境的文件，可用来按照本手册介绍继续安装Gentoo。以前的Gentoo手册描述了使用三个stage压缩包的其中一个来进行安装。现在Gentoo仍然提供stage1和stage2的压缩包，但是官方安装方法只使用stage3压缩包。如果你对使用stage1或stage2压缩包安装Gentoo感兴趣，请阅读Gentoo FAQ中的 <a href="../../../FAQ.html#How_do_I_Install_Gentoo_Using_a_Stage1_or_Stage2_Tarball.3F" title="FAQ">如何使用stage1或stage2压缩包来安装Gentoo</a>?
</p><p>stage3压缩包不在安装CD中提供，但可以在任意一个<a rel="nofollow" class="external text" href="https://www.gentoo.org/downloads/mirrors/">Gentoo官方镜像站</a>的<span style="font-family: monospace; font-size: 95%">releases/amd64/autobuilds/</span>路径中下载。
</p>
<h2><span class="mw-headline" id=".E4.B8.8B.E8.BD.BD.E5.B9.B6.E5.88.BB.E5.BD.95CD">下载并刻录CD</span></h2>
<h3><span class="mw-headline" id=".E4.B8.8B.E8.BD.BDCD.E5.AE.89.E8.A3.85.E5.AA.92.E4.BB.8B">下载CD安装媒介</span></h3>
<p>Gentoo Linux使用<i>最小化安装CD</i>做为默认安装媒介，它带有一个可引导的非常小的Gentoo Linux环境，以及安装Gentoo Linux所需的相关工具。
CD镜像可以从任意一个<a rel="nofollow" class="external text" href="https://www.gentoo.org/downloads/mirrors/">镜像站</a>下载。
</p><p>在这些镜像站上，最小化安装CD可以通过以下方式找到：
</p>
<ol><li> 进入 <span style="font-family: monospace; font-size: 95%">releases/</span> 目录</li>
<li> 选择相应的架构, 如 <span style="font-family: monospace; font-size: 95%">amd64/</span></li>
<li> 选择 <span style="font-family: monospace; font-size: 95%">autobuilds/</span> 目录</li>
<li> 选择 <span style="font-family: monospace; font-size: 95%">current-iso/</span> 目录</li></ol>
<p>在这个位置，安装CD文件是那些带有<span style="font-family: monospace; font-size: 95%">.iso</span>扩展名的文件。比如下面的清单：
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">CODE</span> <strong>示例清单：releases/amd64/autobuilds/current-iso/中的可下载文件</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>[DIR] hardened/                                          05-Dec-2014 01:42    -   
[   ] install-amd64-minimal-20141204.iso                 04-Dec-2014 21:04  208M  
[   ] install-amd64-minimal-20141204.iso.CONTENTS        04-Dec-2014 21:04  3.0K  
[   ] install-amd64-minimal-20141204.iso.DIGESTS         04-Dec-2014 21:04  740   
[TXT] install-amd64-minimal-20141204.iso.DIGESTS.asc     05-Dec-2014 01:42  1.6K  
[   ] stage3-amd64-20141204.tar.bz2                      04-Dec-2014 21:04  198M  
[   ] stage3-amd64-20141204.tar.bz2.CONTENTS             04-Dec-2014 21:04  4.6M  
[   ] stage3-amd64-20141204.tar.bz2.DIGESTS              04-Dec-2014 21:04  720   
[TXT] stage3-amd64-20141204.tar.bz2.DIGESTS.asc          05-Dec-2014 01:42  1.5K
</pre></div></pre></div>
<p>在上面的例子中， <span style="font-family: monospace; font-size: 95%">install-amd64-minimal-20141204.iso</span> 文件是最小化安装CD本身。但可以看到,还有其他相关文件存在:
</p>
<ul><li> <span style="font-family: monospace; font-size: 95%">.CONTENTS</span> 文件是一个文本文件，它列出了安装CD中的所有文件。这个文件可用于在下载前确认安装CD是否包含特定的固件和驱动程序。</li>
<li> <span style="font-family: monospace; font-size: 95%">.DIGESTS</span> 文件包含了ISO文件的Hash值，有不同的Hash格式／算法。这个文件可以用来验证已下载的ISO文件有没有损坏。</li>
<li> <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件不仅包含了ISO文件的Hash值（和 <span style="font-family: monospace; font-size: 95%">.DIGESTS</span> 文件一样），还包含了它的加密签名。这个文件即可用于验证已下载的ISO文件是否损坏，也可验证文件确实是由Gentoo发行工程组（Gentoo Release Engineering Team）发布而没有被篡改。</li></ul>
<p>现在先忽略当前位置的其他文件，它们在安装继续进行下去后还会出现的。下载 <span style="font-family: monospace; font-size: 95%">.ISO</span>，如果想要验证下载的文件，同时下载ISO文件对应的  <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span>。 <span style="font-family: monospace; font-size: 95%">.CONTENTS</span> 文件不需要下载，因为安装指南后续不会再用到这个文件。 <span style="font-family: monospace; font-size: 95%">.DIGESTS</span> 这个文件应该和<span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件包含相同的信息，除此以外后者还包含有上面文件的数字签名。
</p>
<h3><span class="mw-headline" id=".E6.A0.A1.E9.AA.8C.E4.B8.8B.E8.BD.BD.E7.9A.84.E6.96.87.E4.BB.B6">校验下载的文件</span></h3>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />这是一个可选步骤，并不是安装Gentoo Linux必须的。但是，仍然推荐用它来确保下载的文件没有损坏，及确保下载文件确实由Gentoo发行工程组（Gentoo Release Engineering Team）提供。</div>
<p>通过 <span style="font-family: monospace; font-size: 95%">.DIGESTS</span> 和 <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件，可以使用合适的工具来验证ISO文件的有效性。验证通常有两个步骤：　　
</p>
<ol><li> 首先，验证加密签名，确保安装文件是由Gentoo发行工程组（Gentoo Release Engineering team）提供</li>
<li> 如果加密签名是有效的，就验证其校验和，确认下载的文件没有损坏。</li></ol>
<h4><span class="mw-headline" id=".E5.9C.A8.E5.BE.AE.E8.BD.AF_Windows_.E6.93.8D.E4.BD.9C.E7.B3.BB.E7.BB.9F.E4.B8.8A.E9.AA.8C.E8.AF.81">在微软 Windows 操作系统上验证</span></h4>
<p>在微软Windows系统上，已经安装了用来验证校验和及加密签名的工具的机会很低。
</p><p>首先验证加密签名，可以使用类似 <a rel="nofollow" class="external text" href="http://www.gpg4win.org/">GPG4Win</a> 这样的工具。安装完工具后，需要导入Gentoo发行工程组（Gentoo Release Engineering Team）的公钥（public keys）。 
公钥列表在： <a rel="nofollow" class="external text" href="https://www.gentoo.org/downloads/signatures/">数字签名页</a>。 一但导入完成，用户就可以验证 <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件的数字签名。
</p>
<div class="alert alert-warning gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-exclamation-circle"></i> Important</strong><br />这并不验证 <span style="font-family: monospace; font-size: 95%">.DIGESTS</span> 文件是否正确，只是验证<span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件。这同时也意味着 <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件所包含的校验和的值也一起被验证了，这就是为什么上面的说明只要求下载 <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件。</div>
<p>可以使用 <a rel="nofollow" class="external text" href="http://www.sinf.gr/en/hashcalc.html">Hashcalc应用</a> 来计算校验和，当然还有许多其他工具也可以用。在大多数情况下，这些工具将向用户显示计算出来的校验和，用户需要将它和 <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件中的值进行比对验证。
</p>
<h4><span class="mw-headline" id=".E5.9F.BA.E4.BA.8ELinux.E7.B3.BB.E7.BB.9F.E7.9A.84.E9.AA.8C.E8.AF.81">基于Linux系统的验证</span></h4>
<p>在Linux系统上,最常用的验证加密签名的方法就是使用 <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-crypt/gnupg">app-crypt/gnupg</a> 这个软件。安装了这个程序,就可以使用以下命令来验证 <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件中的加密签名。
</p><p>首先，下载 <a rel="nofollow" class="external text" href="https://www.gentoo.org/downloads/signatures/">数字签名页</a> 中正确的密匙:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">user $</code><span class="tripleclick-separator"></span><code>gpg --recv-keys 0xBB572E0E2D182910</code></div><pre>
gpg: requesting key 0xBB572E0E2D182910 from hkp server pool.sks-keyservers.net
gpg: key 0xBB572E0E2D182910: &quot;Gentoo Linux Release Engineering (Automated Weekly Release Key) &lt;releng@gentoo.org&gt;&quot; 1 new signature
gpg: 3 marginal(s) needed, 1 complete(s) needed, classic trust model
gpg: depth: 0  valid:   3  signed:  20  trust: 0-, 0q, 0n, 0m, 0f, 3u
gpg: depth: 1  valid:  20  signed:  12  trust: 9-, 0q, 0n, 9m, 2f, 0u
gpg: next trustdb check due at 2018-09-15
gpg: Total number processed: 1
gpg:         new signatures: 1
</pre></div>
<p>下一步验证 <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件的加密签名：
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">user $</code><span class="tripleclick-separator"></span><code>gpg --verify install-amd64-minimal-20141204.iso.DIGESTS.asc</code></div><pre>
gpg: Signature made Fri 05 Dec 2014 02:42:44 AM CET
gpg:                using RSA key 0xBB572E0E2D182910
gpg: Good signature from &quot;Gentoo Linux Release Engineering (Automated Weekly Release Key) &lt;releng@gentoo.org&gt;&quot; [unknown]
gpg: WARNING: This key is not certified with a trusted signature!
gpg:          There is no indication that the signature belongs to the owner.
Primary key fingerprint: 13EB BDBE DE7A 1277 5DFD  B1BA BB57 2E0E 2D18 2910
</pre></div>
<p>为了绝对确定所有文件都是有效的，验证上面显示的指纹信息（fingerprint）是否和 <a rel="nofollow" class="external text" href="https://www.gentoo.org/downloads/signatures/">Gentoo数字签名页</a> 的指纹信息（fingerprint）一致。
</p><p>确认加密签名有效后，接下来就是验证校验和，以确保下载的ISO文件没有损坏。 <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 文件包含了多个哈希（Hash）算法，所以验证正确校验和的方法之一是先找到登记在文件 <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> 中的相应的校验和。例如，获取SHA512的校验和：
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">user $</code><span class="tripleclick-separator"></span><code>grep -A 1 -i sha512 install-amd64-minimal-20141204.iso.DIGESTS.asc</code></div><pre>
# SHA512 HASH
364d32c4f8420605f8a9fa3a0fc55864d5b0d1af11aa62b7a4d4699a427e5144b2d918225dfb7c5dec8d3f0fe2cddb7cc306da6f0cef4f01abec33eec74f3024  install-amd64-minimal-20141204.iso
--
# SHA512 HASH
0719a8954dc7432750de2e3076c8b843a2c79f5e60defe43fcca8c32ab26681dfb9898b102e211174a895ff4c8c41ddd9e9a00ad6434d36c68d74bd02f19b57f  install-amd64-minimal-20141204.iso.CONTENTS
</pre></div>
<p>在上面的输出中，显示了两个SHA512校验和：一个用于文件： <span style="font-family: monospace; font-size: 95%">install-amd64-minimal-20141204.iso</span>，一个用于与之对应的 <span style="font-family: monospace; font-size: 95%">.CONTENTS</span> 文件。只有第一个校验和有用，因为要用它来和下面计算出来的SHA512的校验和进行比较：
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">user $</code><span class="tripleclick-separator"></span><code>sha512sum install-amd64-minimal-20141204.iso</code></div><pre>
364d32c4f8420605f8a9fa3a0fc55864d5b0d1af11aa62b7a4d4699a427e5144b2d918225dfb7c5dec8d3f0fe2cddb7cc306da6f0cef4f01abec33eec74f3024  install-amd64-minimal-20141204.iso
</pre></div>
<p>如果两个校验和匹配，那么表明文件没有损坏，安装可以继续进行下去。
</p>
<h3><span class="mw-headline" id=".E5.88.BB.E5.BD.95.E5.85.89.E7.9B.98">刻录光盘</span></h3>
<p>当然,只是下载一个ISO文件是无法开始Gentoo Linux的安装的。需要将这个ISO文件刻录成一张用来启动的CD光盘，是要将ISO文件里的内容而不是ISO文件本身刻录到CD光盘上。下面介绍了一些常见的方式 - 这里可以找到其他更复杂的方式：<a href="../../../FAQ.html#How_do_I_burn_an_ISO_file.3F" title="FAQ">关于刻录ISO文件的FAQ</a>.
</p>
<h4><span class="mw-headline" id=".E5.9C.A8.E5.BE.AE.E8.BD.AFWindows.E4.B8.8A.E5.88.BB.E5.BD.95">在微软Windows上刻录</span></h4>
<p>在微软Windows上有许多工具支持将ISO文件刻录成CD光盘。
</p>
<ul><li> 使用EasyCD Creator，选择菜单“文件，从CD镜像刻录CD”（<span style="font-family: monospace; font-size: 95%">File</span>,<span style="font-family: monospace; font-size: 95%">Record CD from CD image</span>）。然后选择“文件类型”（<span style="font-family: monospace; font-size: 95%">Files of type</span>）为”ISO镜像文件“（ISO image file）。找到ISO文件所在位置，点击”打开“（<span style="font-family: monospace; font-size: 95%">Open</span>）。点击”开始刻录“（<span style="font-family: monospace; font-size: 95%">Start recording</span>）后ISO镜像将会正确地刻录到CD-R光盘上。</li>
<li> 使用 Nero Burning ROM，取消自动弹出的向导，从“文件”（<span style="font-family: monospace; font-size: 95%">File</span>）菜单选择“刻录镜像”（<span style="font-family: monospace; font-size: 95%">Burn Image</span>）。  选择要刻录的镜像文件然后点击“打开”（<span style="font-family: monospace; font-size: 95%">Open</span>）。现在选择“刻录”（<span style="font-family: monospace; font-size: 95%">Burn</span>）按键，然后等待全新的CD光盘刻录完成。</li></ul>
<h4><span class="mw-headline" id=".E5.9C.A8_Linux_.E7.B3.BB.E7.BB.9F.E4.B8.8A.E5.88.BB.E5.BD.95">在 Linux 系统上刻录</span></h4>
<p>在Linux系统上，可以通过<span style="font-family: monospace; font-size: 95%; font-weight: bold;">cdrecord</span>命令将ISO文件刻录到CD光盘上，这个命令包含在 <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-cdr/cdrtools">app-cdr/cdrtools</a> 软件包中。
</p><p>例如，将ISO文件刻录到 <span style="font-family: monospace; font-size: 95%">/dev/sr0</span> 设备的CD光碟上（这是系统上的第一个CD设备-在必要时将其替换为正确的设备文件）:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">user $</code><span class="tripleclick-separator"></span><code>cdrecord dev=/dev/sr0 install--minimal-20141204.iso</code></div></div>
<p>希望使用图形化界面的用户可以使用K3B，它包含在 <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-cdr/k3b">app-cdr/k3b</a>  软件包中。在K3B软件中，选择“工具”（<span style="font-family: monospace; font-size: 95%">Tools</span>）菜单，然后选择“刻录CD镜像”（<span style="font-family: monospace; font-size: 95%">Burn CD Image</span>）。然后按照K3B提供的使用说明操作。
</p>
<h2><span class="mw-headline" id=".E5.90.AF.E5.8A.A8CD.E5.85.89.E7.9B.98">启动CD光盘</span></h2>
<h3><span class="mw-headline" id=".E5.BC.95.E5.AF.BC.E5.AE.89.E8.A3.85CD">引导安装CD</span></h3>
<p>一旦安装 CD 光盘刻录完成，就可以用它来启动电脑。将 CD 驱动器中的光盘拿出，重启系统并进入 BIOS 或者 UEFI 设置界面。通常可以通过按 <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">DEL</kbd>, <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F1</kbd> 或者 <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">ESC</kbd> 按键来进入设置界面，至于具体是用哪个按键则完全取决于不同的系统和主板的定义。通过BIOS或者UEFI菜单修改启动顺序，让 CD-ROM 光盘驱动器优先于硬盘之前尝试启动。不做这个设置，系统将会从硬盘启动，而忽略 CD-ROM 光盘驱动器。
</p>
<div class="alert alert-warning gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-exclamation-circle"></i> 重要</strong><br />如果安装 Gentoo 的目的是为了使用 UEFI 界面来代替 BIOS ，建议马上用UEFI来启动。如果不用 UEFI 来启动，可能就要在最后完成 Gentoo Linux 的安装之前制作一个可以启动的 UEFI U盘（或其他介质）。</div>
<p>现在将安装 CD 光盘放进 CD-ROM 光盘驱动器并重启。这时，将会出现一个启动提示符，按 <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Enter</kbd> 回车按键将会用默认的启动选项开始启动过程。要想用不同的启动选项来启动安装 CD 光盘，需要指定一个内核及想要的启动选项，再按 <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Enter</kbd> 回车按键。
</p><p>在启动提示符下，用户可以按 <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F1</kbd> 按键显示可用的内核，按 <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F2</kbd> 按键显示可用的启动选项。如果在15秒内没做任何选择（既不显示信息，也不选择内核）安装 CD 光盘将会用硬盘启动。这样不用将 CD 光盘从光盘驱动器里拿出来，也可以在安装过程中重启并尝试已安装好的环境（这有时在远程安装的时候很有用）。
</p><p>我们提到过要指定内核。在安装 CD 光盘上提供了几个内核。默认使用的叫<i>gentoo</i>。其他内核是为了特殊硬件的需要，<i>-nofb</i>内核关闭了帧缓冲（framebuffer）的支持。
</p><p>下表给出了可用内核的一个简单说明。
</p>
<table class="wikitable" style="text-align: left;">

<tr>
<th> 内核
</th>
<th> 描述
</th></tr>
<tr>
<td> gentoo
</td>
<td> 默认内核，支持 K8 CPU (包括对 NUMA 的支持)和 EM64T CPU
</td></tr>
<tr>
<td> gentoo-nofb
</td>
<td> 和 <i>gentoo</i> 一样，但是不支持帧缓冲（framebuffer）
</td></tr>
<tr>
<td> memtest86
</td>
<td> 检测本地内存的错误
</td></tr></table>
<p>引导选项可以配合内核进一步调整引导过程的行为。 
</p>
<table class="wikitable" style="text-align: left;">

<tr>
<th colspan="2"> 硬件选项
</th></tr>
<tr>
<td> acpi=on
</td>
<td> 这个选项载入对 ACPI 的支持，同时也会让 CD 光盘在启动时运行 acpid 守护进程。在系统需要 ACPI 才能正常工作的情况下才需要设置此选项。超线程（Hyperthreading）的支持不需要此选项。
</td></tr>
<tr>
<td> acpi=off
</td>
<td> 彻底禁用 ACPI。这个选项在一些较老的系统上比较有用，同样也是使用 APM 功能的必需项。这个选项也会禁用处理器的超线程支持。
</td></tr>
<tr>
<td> console=X
</td>
<td> This sets up serial console access for the CD. The first option is the device, usually ttyS0 on x86, followed by any connection options, which are comma separated. The default options are 9600,8,n,1.
</td></tr>
<tr>
<td> dmraid=X
</td>
<td> This allows for passing options to the device-mapper RAID subsystem. Options should be encapsulated in quotes.
</td></tr>
<tr>
<td> doapm
</td>
<td> This loads APM driver support. This also requires that <code>acpi=off</code>.
</td></tr>
<tr>
<td> dopcmcia
</td>
<td> This loads support for PCMCIA and Cardbus hardware and also causes the pcmcia cardmgr to be started by the CD on boot. This is only required when booting from PCMCIA/Cardbus devices.
</td></tr>
<tr>
<td> doscsi
</td>
<td> This loads support for most SCSI controllers. This is also a requirement for booting most USB devices, as they use the SCSI subsystem of the kernel.
</td></tr>
<tr>
<td> sda=stroke
</td>
<td> This allows the user to partition the whole hard disk even when the BIOS is unable to handle large disks. This option is only used on machines with an older BIOS. Replace sda with the device that requires this option.
</td></tr>
<tr>
<td> ide=nodma
</td>
<td> This forces the disabling of DMA in the kernel and is required by some IDE chipsets and also by some CDROM drives. If the system is having trouble reading from the IDE CDROM, try this option. This also disables the default hdparm settings from being executed.
</td></tr>
<tr>
<td> noapic
</td>
<td> This disables the Advanced Programmable Interrupt Controller that is present on newer motherboards. It has been known to cause some problems on older hardware.
</td></tr>
<tr>
<td> nodetect
</td>
<td> This disables all of the autodetection done by the CD, including device autodetection and DHCP probing. This is useful for doing debugging of a failing CD or driver.
</td></tr>
<tr>
<td> nodhcp
</td>
<td> This disables DHCP probing on detected network cards. This is useful on networks with only static addresses.
</td></tr>
<tr>
<td> nodmraid
</td>
<td> Disables support for device-mapper RAID, such as that used for on-board IDE/SATA RAID controllers.
</td></tr>
<tr>
<td> nofirewire
</td>
<td> This disables the loading of Firewire modules. This should only be necessary if your Firewire hardware is causing a problem with booting the CD.
</td></tr>
<tr>
<td> nogpm
</td>
<td> This disables gpm console mouse support.
</td></tr>
<tr>
<td> nohotplug
</td>
<td> This disables the loading of the hotplug and coldplug init scripts at boot. This is useful for doing debugging of a failing CD or driver.
</td></tr>
<tr>
<td> nokeymap
</td>
<td> This disables the keymap selection used to select non-US keyboard layouts.
</td></tr>
<tr>
<td> nolapic
</td>
<td> This disables the local APIC on Uniprocessor kernels.
</td></tr>
<tr>
<td> nosata
</td>
<td> This disables the loading of Serial ATA modules. This is used if the system is having problems with the SATA subsystem.
</td></tr>
<tr>
<td> nosmp
</td>
<td> This disables SMP, or Symmetric Multiprocessing, on SMP-enabled kernels. This is useful for debugging SMP-related issues with certain drivers and motherboards.
</td></tr>
<tr>
<td> nosound
</td>
<td> This disables sound support and volume setting. This is useful for systems where sound support causes problems.
</td></tr>
<tr>
<td> nousb
</td>
<td> This disables the autoloading of USB modules. This is useful for debugging USB issues.
</td></tr>
<tr>
<td> slowusb
</td>
<td> This adds some extra pauses into the boot process for slow USB CDROMs, like in the IBM BladeCenter.
</td></tr>
<tr>
<th colspan="2"> Logical volume/device management
</th></tr>
<tr>
<td> dolvm
</td>
<td> This enables support for Linux's Logical Volume Management.
</td></tr>
<tr>
<th colspan="2"> Other options
</th></tr>
<tr>
<td> debug
</td>
<td> Enables debugging code. This might get messy, as it displays a lot of data to the screen.
</td></tr>
<tr>
<td> docache
</td>
<td> This caches the entire runtime portion of the CD into RAM, which allows the user to umount <span style="font-family: monospace; font-size: 95%">/mnt/cdrom</span> and mount another CDROM. This option requires that there is at least twice as much available RAM as the size of the CD.
</td></tr>
<tr>
<td> doload=X
</td>
<td> This causes the initial ramdisk to load any module listed, as well as dependencies. Replace X with the module name. Multiple modules can be specified by a comma-separated list.
</td></tr>
<tr>
<td> dosshd
</td>
<td> Starts sshd on boot, which is useful for unattended installs.
</td></tr>
<tr>
<td> passwd=foo
</td>
<td> Sets whatever follows the equals as the root password, which is required for <i>dosshd</i> since the root password is by default scrambled.
</td></tr>
<tr>
<td> noload=X
</td>
<td> This causes the initial ramdisk to skip the loading of a specific module that may be causing a problem. Syntax matches that of doload.
</td></tr>
<tr>
<td> nonfs
</td>
<td> Disables the starting of portmap/nfsmount on boot.
</td></tr>
<tr>
<td> nox
</td>
<td> This causes an X-enabled LiveCD to not automatically start X, but rather, to drop to the command line instead.
</td></tr>
<tr>
<td> scandelay
</td>
<td> This causes the CD to pause for 10 seconds during certain portions the boot process to allow for devices that are slow to initialize to be ready for use.
</td></tr>
<tr>
<td> scandelay=X
</td>
<td> This allows the user to specify a given delay, in seconds, to be added to certain portions of the boot process to allow for devices that are slow to initialize to be ready for use. Replace X with the number of seconds to pause.
</td></tr></table>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> 附注</strong><br />CD将先检查<code>no*</code>选项，再检查<code>do*</code>选项，所以那些选项可以按照这个顺序覆盖。</div>
<p>现在来引导CD，选择一个内核（如果默认的<code>gentoo</code>的内核不能满足）和引导选项。作为示例，我们引导<code>gentoo</code>内核，并带有<code>dopcmcia</code>作为内核参数：
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">boot:</code><span class="tripleclick-separator"></span><code>gentoo dopcmcia</code></div></div>
<p>接下来迎接用户的是一个引导屏幕和进度条。如果用来安装系统的是一个非US键盘，确保马上按<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Alt</kbd> + <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F1</kbd>来切换到详细模式并遵照提示。如果在10秒钟内什么都没有选，则接受默认（US键盘）并继续引导过程。一旦引导过程完成，用户将自动以<i>root</i>超级用户身份登录到“Live”Gentoo Linux环境。当前控制台将显示一个root提示符，并且可以通过按<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Alt</kbd> + <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F2</kbd>、<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Alt</kbd> + <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F3</kbd>和<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Alt</kbd> + <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F4</kbd>切换到其他控制台。按<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Alt</kbd> + <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F1</kbd>返回到启动时的那个。
</p><p><br />
</p>
<h3><span class="mw-headline" id=".E9.A2.9D.E5.A4.96.E7.9A.84.E7.A1.AC.E4.BB.B6.E9.85.8D.E7.BD.AE">额外的硬件配置</span></h3>
<p>当安装光盘启动时，它会尝试检测所有的硬件设备并加载合适的内核模块来支持硬件。在绝大多数的情况下，它工作得很好。然而，在某些情况下它可能没有自动加载系统所需的内核模块。如果PCI自动检测错过了一些系统硬件，相应的内核模块就必须手动加载了。
</p><p>下面例子手工加载了 8139too 模块（它支持某些类型的网卡）：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>modprobe 8139too</code></div></div> 
<h3><span class="mw-headline" id=".E5.8F.AF.E9.80.89.EF.BC.9A.E7.94.A8.E6.88.B7.E8.B4.A6.E5.8F.B7">可选：用户账号</span></h3>
<p>如果其他人需要访问安装环境，或者需要以非root用户的身份在安装CD上运行命令（例如出于安全原因使用没有 root 特权的 <span style="font-family: monospace; font-size: 95%; font-weight: bold;">irssi</span> 聊天），这时就需要创建额外的用户帐户，并将Root用户密码设为强密码。
</p><p>使用 <span style="font-family: monospace; font-size: 95%; font-weight: bold;">passwd</span> 命令来修改root用户密码：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>passwd</code></div><pre>
New password: (Enter the new password)
Re-enter password: (Re-enter the password)
</pre></div>
<p>要创建一个用户账户，先输入他们的信息，然后设置密码。用 <span style="font-family: monospace; font-size: 95%; font-weight: bold;">useradd</span>  和 <span style="font-family: monospace; font-size: 95%; font-weight: bold;">passwd</span> 命令来完成这些操作。
</p><p>在下面的例子中，创建了一个名为“john”的用户。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>useradd -m -G users john
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>passwd john</code></div><pre>
New password: (输入john的密码)
Re-enter password: (重复上面的密码)
</pre></div>
<p>使用 <span style="font-family: monospace; font-size: 95%; font-weight: bold;">su</span> 命令可以从 root 用户（当前用户）切换到新建的用户：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>su - john</code></div></div>
<h3><span class="mw-headline" id=".E5.8F.AF.E9.80.89.EF.BC.9A.E5.9C.A8.E5.AE.89.E8.A3.85.E6.97.B6.E6.9F.A5.E7.9C.8B.E6.96.87.E6.A1.A3">可选：在安装时查看文档</span></h3>
<p>要在安装期间查看Gentoo安装手册，首先要按照上面的方法创建一个新的用户帐户。然后按 <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Alt</kbd>+<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F2</kbd> 进入一个新的终端。
</p><p>在安装期间， 可以用 <span style="font-family: monospace; font-size: 95%; font-weight: bold;">links</span> 命令来浏览Gentoo安装手册 - 当然只有在互联网连接可用的时候才行。
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">user $</code><span class="tripleclick-separator"></span><code>links <a rel="nofollow" class="external free" href="../../../Handbook_AMD64.html">https://wiki.gentoo.org/wiki/Handbook:AMD64</a></code></div></div>
<p>要回到原来的终端，请按 <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Alt</kbd>+<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">F1</kbd> 。
</p>
<h3><span class="mw-headline" id=".E5.8F.AF.E9.80.89.EF.BC.9A.E5.90.AF.E5.8A.A8SSH.E6.9C.8D.E5.8A.A1">可选：启动SSH服务</span></h3>
<p>要在安装期间允许其他用户访问你的系统（可能是为了在安装过程中提供技术支持，甚至远程安装），需要添加一个用户账户（就像之前的文档描述的那样）同时 SSH 服务也要启动。
</p><p>要启动SSH服务,执行以下命令:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>/etc/init.d/sshd start</code></div></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />如果用户登录到系统，他们将得到一个本系统主机密钥需要被确认的信息（通过所谓的指纹）。在人们第一次登录到系统的时候，这是很正常的。但是，以后当系统设置好，并有人登录到新安装的系统时，SSH客户端会警告主机密钥已被更改。这是因为现在用户登录 - 对于SSH来讲 - 是一个不同的服务器（即新安装的Gentoo系统，而不是现在正在使用的安装系统环境）。请按照屏幕上的指示，去替换用户端的主机密钥</div>
<p>网络需要能正常工作，sshd 才能使用。请参照 <a href="../../Installation/Networking/zh-cn.html" title="Handbook:AMD64/Installation/Networking/zh-cn">配置网络</a> 的内容继续安装。
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../Installation/About/zh-cn.html" title="Previous part" class="btn btn-default">&#8592; 关于安装</a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Installation/Networking/zh-cn.html" title="Next part" class="btn btn-default">Configuring the network &#8594;</a></div>
<p><br />
</p><p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Installation
</th></tr>
<tr>
<td> <a href="../../Installation/About.html" title="Handbook:AMD64/Installation/About">About the installation</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media.html" title="Handbook:AMD64/Installation/Media">Choosing the media</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking.html" title="Handbook:AMD64/Installation/Networking">Configuring the network</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks.html" title="Handbook:AMD64/Installation/Disks">Preparing the disks</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage.html" title="Handbook:AMD64/Installation/Stage">Installing stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base.html" title="Handbook:AMD64/Installation/Base">Installing base system</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel.html" title="Handbook:AMD64/Installation/Kernel">Configuring the kernel</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System.html" title="Handbook:AMD64/Installation/System">Configuring the system</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools.html" title="Handbook:AMD64/Installation/Tools">Installing tools</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader.html" title="Handbook:AMD64/Installation/Bootloader">Configuring the bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing.html" title="Handbook:AMD64/Installation/Finalizing">Finalizing</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Working with Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage.html" title="Handbook:AMD64/Working/Portage">Portage introduction</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE.html" title="Handbook:AMD64/Working/USE">USE flags</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features.html" title="Handbook:AMD64/Working/Features">Portage features</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts.html" title="Handbook:AMD64/Working/Initscripts">Initscript system</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar.html" title="Handbook:AMD64/Working/EnvVar">Environment variables</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Working with Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files.html" title="Handbook:AMD64/Portage/Files">Files and directories</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables.html" title="Handbook:AMD64/Portage/Variables">Variables</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches.html" title="Handbook:AMD64/Portage/Branches">Mixing software branches</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools.html" title="Handbook:AMD64/Portage/Tools">Additional tools</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree.html" title="Handbook:AMD64/Portage/CustomTree">Custom Portage tree</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced.html" title="Handbook:AMD64/Portage/Advanced">Advanced features</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Network configuration
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction.html" title="Handbook:AMD64/Networking/Introduction">Getting started</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced.html" title="Handbook:AMD64/Networking/Advanced">Advanced configuration</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular.html" title="Handbook:AMD64/Networking/Modular">Modular networking</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless.html" title="Handbook:AMD64/Networking/Wireless">Wireless</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending.html" title="Handbook:AMD64/Networking/Extending">Adding functionality</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic.html" title="Handbook:AMD64/Networking/Dynamic">Dynamic management</a>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id="Automatic_network_detection">Automatic network detection</span></h2>
<p>Maybe it just works?
</p><p>If the system is plugged into an Ethernet network with a DHCP server, it is very likely that the networking configuration has already been set up automatically. If so, then the many included network-aware commands on the installation CD such as <span style="font-family: monospace; font-size: 95%; font-weight: bold;">ssh</span>, <span style="font-family: monospace; font-size: 95%; font-weight: bold;">scp</span>, <span style="font-family: monospace; font-size: 95%; font-weight: bold;">ping</span>, <span style="font-family: monospace; font-size: 95%; font-weight: bold;">irssi</span>, <span style="font-family: monospace; font-size: 95%; font-weight: bold;">wget</span>, and <span style="font-family: monospace; font-size: 95%; font-weight: bold;">links</span>, among others, will work immediately.
</p><p>If networking has been configured, the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">ifconfig</span> command should list some network interfaces besides lo, such as <span style="font-family: monospace; font-size: 95%">eth0</span>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ifconfig</code></div><pre>
(...)
eth0      Link encap:Ethernet  HWaddr 00:50:BA:8F:61:7A
          inet addr:192.168.0.2  Bcast:192.168.0.255  Mask:255.255.255.0
          inet6 addr: fe80::50:ba8f:617a/10 Scope:Link
          UP BROADCAST RUNNING MULTICAST  MTU:1500  Metric:1
          RX packets:1498792 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1284980 errors:0 dropped:0 overruns:0 carrier:0
          collisions:1984 txqueuelen:100
          RX bytes:485691215 (463.1 Mb)  TX bytes:123951388 (118.2 Mb)
          Interrupt:11 Base address:0xe800 
</pre></div>
<p>The interface name on the system can be quite different from <span style="font-family: monospace; font-size: 95%">eth0</span>. Recent installation media might show regular network interfaces names like <span style="font-family: monospace; font-size: 95%">eno0</span>, <span style="font-family: monospace; font-size: 95%">ens1</span>, or <span style="font-family: monospace; font-size: 95%">enp5s0</span>. Just seek the interface in the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">ifconfig</span> output that has an IP address related to the local network.
</p><p>In the remainder of this document, we will assume that the interface is called <span style="font-family: monospace; font-size: 95%">eth0</span>.
</p>
<h3><span class="mw-headline" id="Optional:_Configure_any_proxies">Optional: Configure any proxies</span></h3>
<p>If the Internet is accessed through a proxy, then it is necessary to set up proxy information during the installation. It is very easy to define a proxy: just define a variable which contains the proxy server information.
</p><p>In most cases, it is sufficient to define the variables using the server hostname. As an example, we assume the proxy is called proxy.gentoo.org and the port is 8080.
</p><p>To set up an HTTP proxy (for HTTP and HTTPS traffic):
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>export http_proxy="<a rel="nofollow" class="external free" href="http://proxy.gentoo.org:8080/">http://proxy.gentoo.org:8080</a>"</code></div></div>
<p>To set up an FTP proxy:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>export ftp_proxy="<a rel="nofollow" class="external free" href="ftp://proxy.gentoo.org:8080/">ftp://proxy.gentoo.org:8080</a>"</code></div></div>
<p>To set up an RSYNC proxy:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>export RSYNC_PROXY="proxy.gentoo.org:8080"</code></div></div>
<p>If the proxy requires a username and password, use the following syntax for the variable:
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">CODE</span> <strong>Adding username/password to the proxy variable</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>http://username:password@proxy.gentoo.org:8080
</pre></div></pre></div>
<h3><span class="mw-headline" id="Testing_the_network">Testing the network</span></h3>
<p>Try pinging your ISP's DNS server (found in <span style="font-family: monospace; font-size: 95%">/etc/resolv.conf</span>) and a web site of choice. This ensures that the network is functioning properly and that the network packets are reaching the net, DNS name resolution is working correctly, etc.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ping -c 3 www.gentoo.org</code></div></div>
<p>If this all works, then the remainder of this chapter can be skipped to jump right to the next step of the installation instructions (<a href="../../Installation/Disks.html" title="Handbook:AMD64/Installation/Disks">Preparing the disks</a>).
</p>
<h2><span class="mw-headline" id="Automatic_network_configuration">Automatic network configuration</span></h2>
<p>If the network doesn't work immediately, some installation media allow the user to use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">net-setup</span> (for regular or wireless networks), <span style="font-family: monospace; font-size: 95%; font-weight: bold;">pppoe-setup</span> (for ADSL users) or <span style="font-family: monospace; font-size: 95%; font-weight: bold;">pptp</span> (for PPTP users).
</p><p>If the installation medium does not contain any of these tools, continue with the <a href="#Manual_network_configuration">Manual network configuration</a>.
</p>
<ul><li> Regular Ethernet users should continue with <a href="#Default:_Using_net-setup">Default: Using net-setup</a></li>
<li> ADSL users should continue with <a href="#Alternative:_Using_PPP">Alternative: Using PPP</a></li>
<li> PPTP users should continue with <a href="#Alternative:_Using_PPTP">Alternative: Using PPTP</a></li></ul>
<h3><span class="mw-headline" id="Default:_Using_net-setup">Default: Using net-setup</span></h3>
<p>The simplest way to set up networking if it didn't get configured automatically is to run the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">net-setup</span> script:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>net-setup eth0</code></div></div>
<p><span style="font-family: monospace; font-size: 95%; font-weight: bold;">net-setup</span> will ask some questions about the network environment. When all is done, the network connection should work. Test the network connection as stated before. If the tests are positive, congratulations! Skip the rest of this section and continue with <a href="../../Installation/Disks.html" title="Handbook:AMD64/Installation/Disks">Preparing the disks</a>.
</p><p>If the network still doesn't work, continue with <a href="#Manual_network_configuration">Manual network configuration</a>.
</p>
<h3><span class="mw-headline" id="Alternative:_Using_PPP">Alternative: Using PPP</span></h3>
<p>Assuming PPPoE is needed to connect to the Internet, the installation CD (any version) has made things easier by including ppp. Use the provided <span style="font-family: monospace; font-size: 95%; font-weight: bold;">pppoe-setup</span> script to configure the connection. During the setup the Ethernet device that is connected to your ADSL modem, the username and password, the IPs of the DNS servers and if a basic firewall is needed or not will be asked.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>pppoe-setup
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>pppoe-start</code></div></div>
<p>If something goes wrong, double-check that the username and password are correct by looking at <span style="font-family: monospace; font-size: 95%">etc/ppp/pap-secrets</span> or <span style="font-family: monospace; font-size: 95%">/etc/ppp/chap-secrets</span> and make sure to use the right Ethernet device. If the Ethernet device does not exist, the appropriate network modules need to be loaded. In that case continue with <a href="#Manual_network_configuration">Manual network configuration</a> as it will explain how to load the appropriate network modules there.
</p><p>If everything worked, continue with <a href="../../Installation/Disks.html" title="Handbook:AMD64/Installation/Disks">Preparing the disks</a>.
</p>
<h3><span class="mw-headline" id="Alternative:_Using_PPTP">Alternative: Using PPTP</span></h3>
<p>If PPTP support is needed, use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">pptpclient</span> which is provided by the installation CDs. But first make sure that the configuration is correct. Edit <span style="font-family: monospace; font-size: 95%">/etc/ppp/pap-secrets</span> or <span style="font-family: monospace; font-size: 95%">/etc/ppp/chap-secrets</span> so it contains the correct username/password combination:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/ppp/chap-secrets</code></div></div>
<p>Then adjust <span style="font-family: monospace; font-size: 95%">/etc/ppp/options.pptp</span> if necessary:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/ppp/options.pptp</code></div></div>
<p>When all that is done, run <span style="font-family: monospace; font-size: 95%; font-weight: bold;">pptp</span> (along with the options that couldn't be set in <span style="font-family: monospace; font-size: 95%">options.pptp</span>) to connect the server:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>pptp &lt;server ip&gt;</code></div></div>
<p>Now continue with <a href="../../Installation/Disks.html" title="Handbook:AMD64/Installation/Disks">Preparing the disks</a>.
</p>
<h2><span class="mw-headline" id="Manual_network_configuration">Manual network configuration</span></h2>
<h3><span class="mw-headline" id="Loading_the_appropriate_network_modules">Loading the appropriate network modules</span></h3>
<p>When the Installation CD boots, it tries to detect all the hardware devices and loads the appropriate kernel modules (drivers) to support the hardware. In the vast majority of cases, it does a very good job. However, in some cases, it may not auto-load the kernel modules needed.
</p><p>If <span style="font-family: monospace; font-size: 95%; font-weight: bold;">net-setup</span> or <span style="font-family: monospace; font-size: 95%; font-weight: bold;">pppoe-setup</span> failed, then it is possible that the network card wasn't found immediately. This means users may have to load the appropriate kernel modules manually.
</p><p>To find out what kernel modules are provided for networking, use the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">ls</span> command:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ls /lib/modules/`uname -r`/kernel/drivers/net</code></div></div>
<p>If a driver is found for the network device, use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">modprobe</span> to load the kernel module. For instance, to load the <span style="font-family: monospace; font-size: 95%">pcnet32</span> module:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>modprobe pcnet32</code></div></div>
<p>To check if the network card is now detected, use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">ifconfig</span>. A detected network card would result in something like this (again, <span style="font-family: monospace; font-size: 95%">eth0</span> here is just an example):
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ifconfig eth0</code></div><pre>
eth0      Link encap:Ethernet  HWaddr FE:FD:00:00:00:00  
          BROADCAST NOARP MULTICAST  MTU:1500  Metric:1
          RX packets:0 errors:0 dropped:0 overruns:0 frame:0
          TX packets:0 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:0 
          RX bytes:0 (0.0 b)  TX bytes:0 (0.0 b)
</pre></div>
<p>If however the following error is shown, the network card is not detected:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ifconfig eth0</code></div><pre>
eth0: error fetching interface information: Device not found
</pre></div>
<p>The available network interface names on the system can be listed through the <span style="font-family: monospace; font-size: 95%">/sys</span> file system:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ls /sys/class/net</code></div><pre>
dummy0  eth0  lo  sit0  tap0  wlan0
</pre></div>
<p>In the above example, 6 interfaces are found. The <span style="font-family: monospace; font-size: 95%">eth0</span> one is most likely the (wired) Ethernet adapter whereas wlan0 is the wireless one.
</p><p>Assuming that the network card is now detected, retry <span style="font-family: monospace; font-size: 95%; font-weight: bold;">net-setup</span> or <span style="font-family: monospace; font-size: 95%; font-weight: bold;">pppoe-setup</span> again (which should work now), but for the hardcore people we explain how to configure the network manually as well.
</p><p>Select one of the following sections based on your network setup:
</p>
<ul><li> <a href="#Using_DHCP">Using DHCP</a> for automatic IP retrieval</li>
<li> <a href="#Preparing_for_wireless_access">Preparing for wireless access</a> if a wireless network is used</li>
<li> <a href="#Understanding_network_terminology">Understanding network terminology</a> explains the basics about networking</li>
<li> <a href="#Using_ifconfig_and_route">Using ifconfig and route</a> explains how to set up networking manually</li></ul>
<h3><span class="mw-headline" id="Using_DHCP">Using DHCP</span></h3>
<p>DHCP (Dynamic Host Configuration Protocol) makes it possible to automatically receive networking information (IP address, netmask, broadcast address, gateway, nameservers etc.). This only works if a DHCP server is in the network (or if the ISP provider provides a DHCP service). To have a network interface receive this information automatically, use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">dhcpcd</span>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>dhcpcd eth0</code></div></div>
<p>Some network administrators require that the hostname and domainname provided by the DHCP server is used by the system. In that case, use:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>dhcpcd -HD eth0</code></div></div>
<p>If this works (try pinging some Internet server, like Google), then everything is set and ready to continue. Skip the rest of this section and continue with <a href="../../Installation/Disks.html" title="Handbook:AMD64/Installation/Disks">Preparing the disks</a>.
</p>
<h3><span class="mw-headline" id="Preparing_for_wireless_access">Preparing for wireless access</span></h3>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />Support for the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">iwconfig</span> command might be architecture-specific. If the command is not available see if the <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/net-wireless/wireless-tools">net-wireless/wireless-tools</a> package is available for the current architecture. The <span style="font-family: monospace; font-size: 95%; font-weight: bold;">iwconfig</span> command will be unavailable unless the <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/net-wireless/wireless-tools">net-wireless/wireless-tools</a> package has been installed.</div>
<p>When using a wireless (802.11) card, the wireless settings need to be configured before going any further. To see the current wireless settings on the card, one can use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">iwconfig</span>. Running <span style="font-family: monospace; font-size: 95%; font-weight: bold;">iwconfig</span> might show something like:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>iwconfig eth0</code></div><pre>
eth0      IEEE 802.11-DS  ESSID:&quot;GentooNode&quot;                                   
          Mode:Managed  Frequency:2.442GHz  Access Point: 00:09:5B:11:CC:F2    
          Bit Rate:11Mb/s   Tx-Power=20 dBm   Sensitivity=0/65535               
          Retry limit:16   RTS thr:off   Fragment thr:off                       
          Power Management:off                                                  
          Link Quality:25/10  Signal level:-51 dBm  Noise level:-102 dBm        
          Rx invalid nwid:5901 Rx invalid crypt:0 Rx invalid frag:0 Tx          
          excessive retries:237 Invalid misc:350282 Missed beacon:84            
</pre></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />Some wireless cards may have a device name of <span style="font-family: monospace; font-size: 95%">wlan0</span> or <span style="font-family: monospace; font-size: 95%">ra0</span> instead of <span style="font-family: monospace; font-size: 95%">eth0</span>. Run <span style="font-family: monospace; font-size: 95%; font-weight: bold;">iwconfig</span> without any command-line parameters to determine the correct device name.</div>
<p>For most users, there are only two settings that might be important to change, the ESSID (aka wireless network name) or the WEP key. If the ESSID and Access Point address listed are already those of the environment's access point and the environment is not not using WEP, then the wireless configuration is already working.
</p><p>To change the ESSID, or add a WEP key, issue the following commands.
</p>
<ul><li> To set the network name to <i>GentooNode</i>:</li></ul>
<dl><dd> <div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>iwconfig eth0 essid GentooNode</code></div></div></dd></dl>
<ul><li> To set a hex WEP key:</li></ul>
<dl><dd> <div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>iwconfig eth0 key 1234123412341234abcd</code></div></div></dd></dl>
<ul><li> To set an ASCII WEP key, prefix the key with <code>s:</code>:</li></ul>
<dl><dd> <div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>iwconfig eth0 key s:some-password</code></div></div></dd></dl>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />If the wireless network is set up with WPA or WPA2, then <span style="font-family: monospace; font-size: 95%; font-weight: bold;">wpa_supplicant</span> needs to be used. For more information on configuring wireless networking in Gentoo Linux, please read the <a href="../../Networking/Wireless.html" title="Handbook:AMD64/Networking/Wireless">Wireless networking chapter</a> in the Gentoo Handbook.</div>
<p>Confirm the wireless settings again by using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">iwconfig</span>. Once wireless is working,continue configuring the IP level networking options as described in the next section (<a href="#Understanding_network_terminology">Understanding network terminology</a>) or use the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">net-setup</span> tool as described previously.
</p>
<h3><span class="mw-headline" id="Understanding_network_terminology">Understanding network terminology</span></h3>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />If the IP address, broadcast address, netmask and nameservers are known, then skip this subsection and continue with <a href="#Using_ifconfig_and_route">Using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">ifconfig</span> and <span style="font-family: monospace; font-size: 95%; font-weight: bold;">route</span></a>.</div>
<p>If all of the above fails, the network will need to be configured manually. This is not difficult at all. However, some knowledge of network terminology and basic concepts might be necessary. After reading this section, users will know what a gateway is, what a netmask serves for, how a broadcast address is formed and why systems need nameservers.
</p><p>In a network, hosts are identified by their IP address (Internet Protocol address). Such an address is perceived as a combination of four numbers between 0 and 255. Well, at least when using IPv4 (IP version 4). In reality, such an IPv4 address consists of 32 bits (ones and zeros). Let's view an example:
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">CODE</span> <strong>Example of an IPv4 address</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>IP Address (numbers):   192.168.0.2
IP Address (bits):      11000000 10101000 00000000 00000010
                        -------- -------- -------- --------
                           192      168       0        2
</pre></div></pre></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />The successor of IPv4, IPv6, uses 128 bits (ones and zeros). In this section, the focus is on IPv4 addresses.</div>
<p>Such an IP address is unique to a host as far as all accessible networks are concerned (i.e. every host that one wants to be able to reach must have a unique IP address). In order to distinguish between hosts inside and outside a network, the IP address is divided in two parts: the network part and the host part.
</p><p>The separation is written down with the netmask, a collection of ones followed by a collection of zeros. The part of the IP that can be mapped on the ones is the network-part, the other one is the host-part. As usual, the netmask can be written down as an IP address.
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">CODE</span> <strong>Example of network/host separation</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>IP address:    192      168      0         2
            11000000 10101000 00000000 00000010
Netmask:    11111111 11111111 11111111 00000000
               255      255     255        0
           +--------------------------+--------+
                    Network              Host
</pre></div></pre></div>
<p>In other words, 192.168.0.14 is part of the example network, but 192.168.1.2 is not.
</p><p>The broadcast address is an IP address with the same network-part as the network, but with only ones as host-part. Every host on the network listens to this IP address. It is truly meant for broadcasting packets.
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">CODE</span> <strong>Broadcast address</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>IP address:    192      168      0         2
            11000000 10101000 00000000 00000010
Broadcast:  11000000 10101000 00000000 11111111
               192      168      0        255
           +--------------------------+--------+
                     Network             Host
</pre></div></pre></div>
<p>To be able to surf on the Internet, each computer in the network must know which host shares the Internet connection. This host is called the gateway. Since it is a regular host, it has a regular IP address (for instance 192.168.0.1).
</p><p>Previously we stated that every host has its own IP address. To be able to reach this host by a name (instead of an IP address) we need a service that translates a name (such as dev.gentoo.org) to an IP address (such as 64.5.62.82). Such a service is called a <i>name service</i>. To use such a service, the necessary name servers need to be defined in <span style="font-family: monospace; font-size: 95%">/etc/resolv.conf</span>.
</p><p>In some cases, the gateway also serves as a nameserver. Otherwise the nameservers provided by the ISP need to be entered in this file.
</p><p>To summarize, the following information is needed before continuing:
</p>
<table class="table-condensed table-striped" style="text-align: left;">

<tr>
<th scope="col" width="15%"> Network item
</th>
<th> Example
</th></tr>
<tr>
<td> The system IP address
</td>
<td> 192.168.0.2
</td></tr>
<tr>
<td> Netmask
</td>
<td> 255.255.255.0
</td></tr>
<tr>
<td> Broadcast
</td>
<td> 192.168.0.255
</td></tr>
<tr>
<td> Gateway
</td>
<td> 192.168.0.1
</td></tr>
<tr>
<td> Nameserver(s)
</td>
<td> 195.130.130.5, 195.130.130.133
</td></tr></table>
<h3><span class="mw-headline" id="Using_ifconfig_and_route">Using ifconfig and route</span></h3>
<p>Setting up the network consists of three steps:
</p>
<ol><li> Assign an IP address using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">ifconfig</span></li>
<li> Set up routing to the gateway using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">route</span></li>
<li> Finish up by placing the nameserver IPs in <span style="font-family: monospace; font-size: 95%">/etc/resolv.conf</span></li></ol>
<p>To assign an IP address, the IP address, broadcast address and netmask are needed. Then execute the following command, substituting <var>${IP_ADDR}</var> with the right IP address, <var>${BROADCAST}</var> with the right broadcast address and <var>${NETMASK}</var> with the right netmask:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ifconfig eth0 ${IP_ADDR} broadcast ${BROADCAST} netmask ${NETMASK} up</code></div></div>
<p>Set up routing using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">route</span>. Substitute <var>${GATEWAY}</var> with the right gateway IP address:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>route add default gw ${GATEWAY}</code></div></div>
<p>Now open <span style="font-family: monospace; font-size: 95%">/etc/resolv.conf</span>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/resolv.conf</code></div></div>
<p>Fill in the nameserver(s) using the following as a template. Make sure to substitute <var>${NAMESERVER1}</var> and <var>${NAMESERVER2}</var> with the appropriate nameserver addresses:
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">CODE</span> <strong>Default template to use for /etc/resolv.conf</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>nameserver ${NAMESERVER1}
nameserver ${NAMESERVER2}
</pre></div></pre></div>
<p>That's it. Now test the network by pinging some Internet server (like Google). If this works, congratulations then. Continue with <a href="../../Installation/Disks.html" title="Handbook:AMD64/Installation/Disks">Preparing the disks</a>.
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../Installation/Media.html" title="Previous part" class="btn btn-default">&#8592; Choosing the media</a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Installation/Disks.html" title="Next part" class="btn btn-default">Preparing the disks &#8594;</a></div>
<p><br />
</p><p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 安装
</th></tr>
<tr>
<td> <a href="../../Installation/About/zh-cn.html" title="Handbook:AMD64/Installation/About/zh-cn">关于安装</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media/zh-cn.html" title="Handbook:AMD64/Installation/Media/zh-cn">选择安装媒介</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking/zh-cn.html" title="Handbook:AMD64/Installation/Networking/zh-cn">配置网络</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks/zh-cn.html" title="Handbook:AMD64/Installation/Disks/zh-cn">准备磁盘</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage/zh-cn.html" title="Handbook:AMD64/Installation/Stage/zh-cn">安装stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base/zh-cn.html" title="Handbook:AMD64/Installation/Base/zh-cn">安装基本系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel/zh-cn.html" title="Handbook:AMD64/Installation/Kernel/zh-cn">配置Linux内核</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System/zh-cn.html" title="Handbook:AMD64/Installation/System/zh-cn">配置系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools/zh-cn.html" title="Handbook:AMD64/Installation/Tools/zh-cn">安装系统工具</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader/zh-cn.html" title="Handbook:AMD64/Installation/Bootloader/zh-cn">配置系统引导程序Bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing/zh-cn.html" title="Handbook:AMD64/Installation/Finalizing/zh-cn">收尾安装工作</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage/zh-cn.html" title="Handbook:AMD64/Working/Portage/zh-cn">Portage介绍</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE/zh-cn.html" title="Handbook:AMD64/Working/USE/zh-cn">USE标记</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features/zh-cn.html" title="Handbook:AMD64/Working/Features/zh-cn">Portage功能特性</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts/zh-cn.html" title="Handbook:AMD64/Working/Initscripts/zh-cn">初始化脚本（Initscript）系统</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar/zh-cn.html" title="Handbook:AMD64/Working/EnvVar/zh-cn">环境变量</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files/zh-cn.html" title="Handbook:AMD64/Portage/Files/zh-cn">文件和目录</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables/zh-cn.html" title="Handbook:AMD64/Portage/Variables/zh-cn">变量</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches/zh-cn.html" title="Handbook:AMD64/Portage/Branches/zh-cn">混合使用不同的软件分支</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools/zh-cn.html" title="Handbook:AMD64/Portage/Tools/zh-cn">额外的工具</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree/zh-cn.html" title="Handbook:AMD64/Portage/CustomTree/zh-cn">定制Portage树</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced/zh-cn.html" title="Handbook:AMD64/Portage/Advanced/zh-cn">高级特性</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 网络配置
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction/zh-cn.html" title="Handbook:AMD64/Networking/Introduction/zh-cn">入门</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced/zh-cn.html" title="Handbook:AMD64/Networking/Advanced/zh-cn">高级配置</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular/zh-cn.html" title="Handbook:AMD64/Networking/Modular/zh-cn">模块化网络</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless/zh-cn.html" title="Handbook:AMD64/Networking/Wireless/zh-cn">无线</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending/zh-cn.html" title="Handbook:AMD64/Networking/Extending/zh-cn">添加功能</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic/zh-cn.html" title="Handbook:AMD64/Networking/Dynamic/zh-cn">动态管理</a>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id=".E5.9D.97.E8.AE.BE.E5.A4.87.E7.AE.80.E4.BB.8B">块设备简介</span></h2>
<h3><span class="mw-headline" id=".E5.9D.97.E8.AE.BE.E5.A4.87">块设备</span></h3>
<p>让我们来好好看看Gentoo Linux以及普通Linux中有关磁盘方面的知识，包括Linux文件系统，分区和块设备。一旦磁盘和文件的来龙去脉都了解，我们将设置分区和文件系统的安装Gentoo Linux。
</p><p>首先，让我们来看看块设备。最著名的块设备可能是代表Linux系统第一块磁盘的<span style="font-family: monospace; font-size: 95%">/dev/sda</span>。SCSI和SATA磁盘全标为<span style="font-family: monospace; font-size: 95%">/dev/sd*</span>；甚至IDE磁盘在新的libata内核框架下也标为<span style="font-family: monospace; font-size: 95%">/dev/sd*</span>。当使用老设备框架时，第一个IDE磁盘是<span style="font-family: monospace; font-size: 95%">/dev/hda</span>。
</p><p>上面的块设备代表的抽象接口的磁盘。用户程序可以使用这些块设备来与你的磁盘进行交互，而无需担心驱动器到底是IDE，SCSI还是其他什么东西。该程序可以把磁盘当作一系列连续的，可随机访问的512字节块的存储。
</p><p><br />
</p>
<h3><span class="mw-headline" id=".E5.88.86.E5.8C.BA">分区</span></h3>
<p>Although it is theoretically possible to use a full disk to house a Linux system, this is almost never done in practice. Instead, full disk block devices are split up in smaller, more manageable block devices. On amd64 systems, these are called partitions. There are currently two standard partitioning technologies in use: MBR and GPT.
</p>
<h4><span class="mw-headline" id="MBR">MBR</span></h4>
<p>The <i>MBR (Master Boot Record)</i> setup uses 32-bit identifiers for the start sector and length of the partitions, and supports three partition types: primary, extended and logical. Primary partitions have their information stored in the master boot record itself - a very small (usually 512 bytes) location at the very beginning of a disk. Due to this small space, only four primary partitions are supported (for instance, <span style="font-family: monospace; font-size: 95%">/dev/sda1</span> to <span style="font-family: monospace; font-size: 95%">/dev/sda4</span>).
</p><p>To support more partitions, one of the primary partitions can be marked as an extended partition. This partition can then contain logical partitions (partitions within a partition).
</p><p>Each partition is limited to 2 TB in size (due to the 32-bit identifiers). Also, the MBR setup does not provide any backup-MBR, so if an application or user overwrites the MBR, all partition information is lost.
</p>
<h4><span class="mw-headline" id="GPT">GPT</span></h4>
<p>The <i>GPT (GUID Partition table)</i> setup uses 64-bit identifiers for the partitions. The location in which it stores the partition information is also much bigger than the 512 bytes of an MBR, and there is no limit on the amount of partitions. Also the size of a partition is bounded by a much greater limit (almost 8 ZB - yes, zettabytes).
</p><p>When a system's software interface between the operating system and firmware is UEFI (instead of BIOS), GPT is almost mandatory as compatibility issues will arise with MBR here.
</p><p>GPT also has the advantage that it has a backup GPT at the end of the disk, which can be used to recover damage of the primary GPT at the beginning. GPT also carries CRC32 checksums to detect errors in the header and partition tables.
</p>
<h3><span class="mw-headline" id="GPT.E8.BF.98.E6.98.AFMBR">GPT还是MBR</span></h3>
<p>From the description above, one might think that using GPT should always be the recommended approach. But there are a few caveats with this.
</p><p>Using GPT on a BIOS-based computer works, but then one cannot dual-boot with a Microsoft Windows operating system. The reason is that Microsoft Windows will boot in EFI mode if it detects a GPT partition label.
</p><p>Some buggy BIOSes or EFIs configured to boot in BIOS/CSM/legacy mode might also have problems with booting from GPT labeled disks. If that is the case, it might be possible to work around the problem by adding the boot/active flag on the protective MBR partition which has to be done through <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> with the <code>-t dos</code> option to force it to read the partition table using the MBR format.
</p><p>In this case, launch <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> and toggle the flag using the <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">a</kbd> key. Press <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">1</kbd> to select the first partition, then press the <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">w</kbd> key to write the changes to the disk and exit the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> application:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">user $</code><span class="tripleclick-separator"></span><code>fdisk -t dos /dev/sda</code></div><pre>
Welcome to fdisk (util-linux 2.24.1).
Changes will remain in memory only, until you decide to write them.
Be careful before using the write command.
  
Command (m for help): a
Partition number (1-4): 1
  
Command (m for help): w
</pre></div>
<h3><span class="mw-headline" id=".E4.BD.BF.E7.94.A8UEFI">使用UEFI</span></h3>
<p>When installing Gentoo on a system that uses UEFI to boot the operating system (instead of BIOS), then it is important that an EFI system partition is created. The instructions for <span style="font-family: monospace; font-size: 95%; font-weight: bold;">parted</span> below contain the necessary pointers for this.
</p><p>The EFI system partition also needs to be a FAT32 partition (or <i>vfat</i> as it is shown on Linux systems). The instructions at the end of this chapter use <i>ext2</i> as the example file system for the <span style="font-family: monospace; font-size: 95%">/boot/</span> partition. Make sure to use <i>vfat</i>, like so:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mkfs.vfat /dev/sda2</code></div></div>
<div class="alert alert-danger gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-exclamation-triangle"></i> Warning</strong><br />If the boot partition is not using the FAT32 (vfat) file system, then the systems UEFI firmware will not be able to find the Linux kernel and boot the system!</div>
<h3><span class="mw-headline" id=".E9.AB.98.E7.BA.A7.E5.AD.98.E5.82.A8">高级存储</span></h3>
<p>The amd64 Installation CDs provide support for LVM2. LVM2 increases the flexibility offered by the partitioning setup. During the installation instructions, we will focus on "regular" partitions, but it is still good to know LVM2 is supported as well.
</p>
<h3><span class="mw-headline" id=".E9.BB.98.E8.AE.A4.E5.88.86.E5.8C.BA.E6.96.B9.E6.A1.88">默认分区方案</span></h3>
<p>Throughout the remainder of the handbook, the following partitioning scheme is used. If this suffices, then the reader can immediately jump to <a href="#Default:_Using_parted_to_partition_the_disk">Default: Using parted to partition the disk</a> or <a href="#Alternative:_Using_fdisk_to_partition_the_disk">Alternative: Using fdisk to partition the disk</a>. Both are partitioning tools, <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> is well known and stable and recommended for the MBR partition layout, while <span style="font-family: monospace; font-size: 95%; font-weight: bold;">parted</span> is more recent and recommended for GPT layouts.
</p>
<table class="table table-condensed table-striped" style="text-align: left;">

<tr>
<th> 分区
</th>
<th> 文件系统
</th>
<th> 大小
</th>
<th> 描述
</th></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda1</span>
</td>
<td> （引导器）
</td>
<td> 2M
</td>
<td> BIOS引导分区
</td></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda2</span>
</td>
<td> ext2（或者vfat）
</td>
<td> 128M
</td>
<td> 引导分区
</td></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda3</span>
</td>
<td> （swap）
</td>
<td> 512M及更高
</td>
<td> Swap分区
</td></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda4</span>
</td>
<td> ext4
</td>
<td> 剩余的磁盘
</td>
<td> 根分区
</td></tr></table>
<p>Before going to the creation instructions, the first set of sections will describe in more detail how partitioning schemes can be created and what the common pitfalls are.
</p>
<h2><span class="mw-headline" id=".E8.AE.BE.E8.AE.A1.E4.B8.80.E4.B8.AA.E5.88.86.E5.8C.BA.E6.96.B9.E6.A1.88">设计一个分区方案</span></h2>
<h3><span class="mw-headline" id=".E5.A4.9A.E5.B0.91.E4.B8.AA.E4.BB.A5.E5.8F.8A.E5.A4.9A.E5.A4.A7.EF.BC.9F">多少个以及多大？</span></h3>
<p>分区的数量是高度依赖于环境。比如，如果有很多个用户，则建议有一个独立的<span style="font-family: monospace; font-size: 95%">/home/</span>，以增强安全性及便于备份。如果要安装的Gentoo是用来做邮件服务器，则<span style="font-family: monospace; font-size: 95%">/var/</span>应该独立，因为所有的邮件都储存于<span style="font-family: monospace; font-size: 95%">/var/</span>。选择一个正确的文件系统将会获得最大化的性能。游戏服务器应该有一个独立的<span style="font-family: monospace; font-size: 95%">/opt/</span>，因为大多数游戏服务器都安装在那里。原因也和<span style="font-family: monospace; font-size: 95%">/home/</span>一样：安全和备份。在大多数场景下，应该保持<span style="font-family: monospace; font-size: 95%">/usr/</span>大一些：不仅是因为它包含多数的应用程序，Portage树就要占用大约500MB，而且还不包含许多储存在其内的源码。
</p><p>由此可见，它非常依赖于管理员想用它来做什么。独立分区或卷有以下的优势：
</p>
<ul><li> 为每个分区或者卷选择性能最好的文件系统。</li>
<li> 当一个失控的工具持续向一个分区或卷写文件时，也不至于让整个系统由于无可用空间而无法运行。</li>
<li> 如果有必要，可以简化文件系统检查，多个检查可以并行的完成（其实在这一点上，有多个磁盘比多个分区更有优势）。</li>
<li> 可以通过在挂载一些分区或卷时使用只读、<code>nosuid</code>（忽略setuid属性）、<code>noexec</code>（忽略可执行属性）等来增加安全性。</li></ul>
<p>不过，多个分区同样也有劣势。如果不能合理的配置，系统可能会在一个分区上有很多空闲空间，而其他分区却没有空间。另外一个麻烦是独立的分区——尤其是像<span style="font-family: monospace; font-size: 95%">/usr/</span>或<span style="font-family: monospace; font-size: 95%">/var/</span>这样的重要挂载点——经常需要管理员在引导时通过一个initramfs来在其他引导脚本启动前挂载这些分区。在不同的情况下，结果也可能不同。
</p><p>另外对于SCSI和SATA还有一个最多15分区的限制，除非使用GPT标签。
</p>
<h3><span class="mw-headline" id=".E9.82.A3.E4.B9.88swap.E7.A9.BA.E9.97.B4.E5.91.A2.EF.BC.9F">那么swap空间呢？</span></h3>
<p>对于swap空间，没有一个完美值。swap空间的目的是当内存（RAM）有压力时为内核提供磁盘存储。一个swap空间允许内核将看过来稍后不会被访问的内存页面移动到磁盘（swap或者page-out）、施放内存。当然，如果那块内存突然要使用到，需要花一些时间（相比较内存，硬盘是非常慢的）将这些页面需要放回到内存中（page-in）。
</p><p>如果系统不运行很需要内存的应用程序或系统有足够多的可能内存，则不需要太多的swap空间。不过，swap空间还用来在休眠时储存整个内存。如果一个系统需要休眠，则需要大一点的swap空间，通常至少为系统安装的内存数量。
</p><p><br />
</p>
<h3><span class="mw-headline" id=".E4.BB.80.E4.B9.88.E6.98.AFBIOS.E5.BC.95.E5.AF.BC.E5.88.86.E5.8C.BA.EF.BC.9F">什么是BIOS引导分区？</span></h3>
<p>A BIOS boot partition is a very small (1 to 2 MB) partition in which boot loaders like GRUB2 can put additional data that doesn't fit in the allocated storage (a few hundred bytes in case of MBR) and cannot be placed elsewhere.
</p><p>Such partitions are not always necessary, but considering the low space consumption and the difficulties we have with documenting the plethora of partitioning differences otherwise, it is recommended to create it in either case.
</p><p>For completeness, the BIOS boot partition is needed when GPT partition layout is used with GRUB2, or when the MBR partition layout is used with GRUB2 when the first partition starts earlier than the 1 MB location on the disk.
</p>
<h2><span class="mw-headline" id=".E9.BB.98.E8.AE.A4.EF.BC.9A.E4.BD.BF.E7.94.A8parted.E5.AF.B9.E7.A3.81.E7.9B.98.E8.BF.9B.E8.A1.8C.E5.88.86.E5.8C.BA">默认：使用parted对磁盘进行分区</span></h2>
<p>In this chapter, the example partition layout mentioned earlier in the instructions will be used:
</p>
<table class="table table-condensed table-striped" style="text-align: left;">

<tr>
<th> 分区
</th>
<th> 描述
</th></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda1</span>
</td>
<td> BIOS引导分区
</td></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda2</span>
</td>
<td> 引导分区
</td></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda3</span>
</td>
<td> Swap分区
</td></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda4</span>
</td>
<td> 根分区
</td></tr></table>
<p>Change the partition layout according to personal preference. 
</p>
<h3><span class="mw-headline" id=".E4.BD.BF.E7.94.A8parted.E6.9F.A5.E7.9C.8B.E5.BD.93.E5.89.8D.E5.88.86.E5.8C.BA.E5.B8.83.E5.B1.80">使用parted查看当前分区布局</span></h3>
<p>The <span style="font-family: monospace; font-size: 95%; font-weight: bold;">parted</span> application offers a simple interface for partitioning the disks and supports very large partitions (more than 2 TB). Fire up <span style="font-family: monospace; font-size: 95%; font-weight: bold;">parted</span> against the disk (in our example, we use <span style="font-family: monospace; font-size: 95%">/dev/sda</span>). It is recommended to ask <span style="font-family: monospace; font-size: 95%; font-weight: bold;">parted</span> to use optimal partition alignment:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>parted -a optimal /dev/sda</code></div><pre>
GNU Parted 2.3
Using /dev/sda
Welcome to GNU Parted! Type 'help' to view a list of commands.
</pre></div>
<p>Alignment means that partitions are started on well-known boundaries within the disk, ensuring that operations on the disk from the operating system level (retrieve pages from the disk) use the least amount of internal disk operations. Misaligned partitions might require the disk to fetch two pages instead of one even if the operating system asked for a single page.
</p><p>To find out about all options supported by parted, type <span style="font-family: monospace; font-size: 95%; font-weight: bold;">help</span> and press return.
</p>
<h3><span class="mw-headline" id=".E8.AE.BE.E7.BD.AEGPT.E6.A0.87.E7.AD.BE">设置GPT标签</span></h3>
<p>Most disks on the <b><span style="font-family: monospace; font-size: 95%; color: #54487a">x86</span></b> or <b><span style="font-family: monospace; font-size: 95%; color: #54487a">amd64</span></b> architectures are prepared using an <i>msdos</i> label. Using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">parted</span>, the command to put a GPT label on the disk is <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mklabel gpt</span>:
</p>
<div class="alert alert-danger gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-exclamation-triangle"></i> Warning</strong><br />Changing the partition type will remove all partitions from the disk. All data on the disk will be lost.</div>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>mklabel gpt</code></div></div>
<p>To have the disk with MBR layout, use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mklabel msdos</span>.
</p>
<h3><span class="mw-headline" id=".E4.BD.BF.E7.94.A8parted.E7.A7.BB.E9.99.A4.E5.85.A8.E9.83.A8.E5.88.86.E5.8C.BA">使用parted移除全部分区</span></h3>
<p>If this isn't done yet (for instance through the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mklabel</span> operation earlier, or because the disk is a freshly formatted one), first remove all existing partitions from the disk. Type <span style="font-family: monospace; font-size: 95%; font-weight: bold;">print</span> to view the current partitions, and <span style="font-family: monospace; font-size: 95%; font-weight: bold;">rm NUMBER</span> where NUMBER is the partition to remove.
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>rm 2</code></div></div>
<p>Do the same for all other partitions that aren't needed. However, make sure to not make any mistakes here - parted executes the changes immediately (unlike <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> which stages them, allowing a user to "undo" his changes before saving or exiting fdisk).
</p>
<h3><span class="mw-headline" id=".E5.88.9B.E5.BB.BA.E5.88.86.E5.8C.BA">创建分区</span></h3>
<p>Now create the partitions. Creating partitions with <span style="font-family: monospace; font-size: 95%; font-weight: bold;">parted</span> isn't very difficult - all we need to do is inform parted about the following settings:
</p>
<ul><li> The partition type to use. This usually is <i>primary</i>. If the msdos partition label is used, keep in mind that there can be no more than 4 primary partitions. If more than 4 partitions are needed, make one of the first four partitions extended and create logical partitions inside it.</li>
<li> The start location of a partition (which can be expressed in MB, GB, ...)</li>
<li> The end location of the partition (which can be expressed in MB, GB, ...)</li></ul>
<p>First, tell parted that the size unit we work with is megabytes (actually mebibytes, abbreviated as MiB which is the "standard" notation, but we will use MB in the text throughout as it is much more common):
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>unit mib</code></div></div>
<p>Now create a 2 MB partition that will be used by the GRUB2 boot loader later. Use the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mkpart</span> command for this, and inform <span style="font-family: monospace; font-size: 95%; font-weight: bold;">parted</span> to start from 1 MB and end at 3 MB (creating a partition of 2 MB in size).
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>mkpart primary 1 3
</code></div><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>name 1 grub
</code></div><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>set 1 bios_grub on
</code></div><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>print</code></div><pre>
Model: Virtio Block Device (virtblk)
Disk /dev/sda: 20480MiB
Sector size (logical/physical): 512B/512B
Partition Table: gpt
  
Number   Start      End      Size     File system  Name   Flags
 1       1.00MiB    3.00MiB  2.00MiB               grub   bios_grub
</pre></div>
<p>Do the same for the boot partition (128 MB), swap partition (in the example, 512 MB) and the root partition that spans the remaining disk (for which the end location is marked as -1, meaning the end of the disk minus one MB, which is the farthest a partition can go).
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>mkpart primary 3 131
</code></div><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>name 2 boot
</code></div><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>mkpart primary 131 643
</code></div><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>name 3 swap
</code></div><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>mkpart primary 643 -1
</code></div><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>name 4 rootfs</code></div></div>
<p>When using the UEFI interface to boot the system (instead of BIOS), mark the boot partition as the EFI System Partition. Parted does this automatically when the <i>boot</i> option is set on the partition:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>set 2 boot on</code></div></div>
<p>The end result looks like so:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">(parted)</code><span class="tripleclick-separator"></span><code>print</code></div><pre>
Model: Virtio Block Device (virtblk)
Disk /dev/sda: 20480MiB
Sector size (logical/physical): 512B/512B
Partition Table: gpt
  
Number   Start      End      Size     File system  Name   Flags
 1       1.00MiB    3.00MiB  2.00MiB               grub   bios_grub
 2       3.00MiB    131MiB   128MiB                boot   boot
 3       131MiB     643MiB   512MiB                swap
 4       643MiB     20479MiB 19836MiB              rootfs
</pre></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />On an UEFI installation, the boot flag will show up on the boot partition.</div>
<p>Use the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">quit</span> command to exit parted.
</p>
<h2><span class="mw-headline" id=".E5.A4.87.E9.80.89.EF.BC.9A.E4.BD.BF.E7.94.A8fdisk.E5.AF.B9.E7.A3.81.E7.9B.98.E8.BF.9B.E8.A1.8C.E5.88.86.E5.8C.BA">备选：使用fdisk对磁盘进行分区</span></h2>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />Although recent <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> should support GPT, it has still shown to have some issues with it. The instructions given below assume that the partition layout being used is MBR.</div>
<p>The following parts explain how to create the example partition layout using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span>. The example partition layout was mentioned earlier:
</p>
<table class="table table-condensed table-striped" style="text-align: left;">

<tr>
<th> 分区
</th>
<th> 描述
</th></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda1</span>
</td>
<td> BIOS引导分区
</td></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda2</span>
</td>
<td> 引导分区
</td></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda3</span>
</td>
<td> Swap分区
</td></tr>
<tr>
<td> <span style="font-family: monospace; font-size: 95%">/dev/sda4</span>
</td>
<td> 根分区
</td></tr></table>
<p>Change the partition layout according to personal preference. 
</p>
<h3><span class="mw-headline" id=".E6.9F.A5.E7.9C.8B.E5.BD.93.E5.89.8D.E5.88.86.E5.8C.BA.E5.B8.83.E5.B1.80">查看当前分区布局</span></h3>
<p><span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> is a popular and powerful tool to split a disk into partitions. Fire up <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> against the disk (in our example, we use <span style="font-family: monospace; font-size: 95%">/dev/sda</span>):
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>fdisk /dev/sda</code></div></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />To use GPT support, add <code>-t gpt</code>. It is recommended to closely investigate the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> output in case more recent developments in <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> change its default behavior of defaulting to MBR. The remainder of the instructions assume an MBR layout.</div>
<p>Use the <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">p</kbd> key to display the disk's current partition configuration:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">Command (m for help):</code><span class="tripleclick-separator"></span><code>p</code></div><pre>
Disk /dev/sda: 240 heads, 63 sectors, 2184 cylinders
Units = cylinders of 15120 * 512 bytes
  
   Device Boot    Start       End    Blocks   Id  System
/dev/sda1   *         1        14    105808+  83  Linux
/dev/sda2            15        49    264600   82  Linux swap
/dev/sda3            50        70    158760   83  Linux
/dev/sda4            71      2184  15981840    5  Extended
/dev/sda5            71       209   1050808+  83  Linux
/dev/sda6           210       348   1050808+  83  Linux
/dev/sda7           349       626   2101648+  83  Linux
/dev/sda8           627       904   2101648+  83  Linux
/dev/sda9           905      2184   9676768+  83  Linux
</pre></div>
<p>This particular disk is configured to house seven Linux filesystems (each with a corresponding partition listed as "Linux") as well as a swap partition (listed as "Linux swap").
</p>
<h3><span class="mw-headline" id=".E4.BD.BF.E7.94.A8fdisk.E7.A7.BB.E9.99.A4.E5.85.A8.E9.83.A8.E5.88.86.E5.8C.BA">使用fdisk移除全部分区</span></h3>
<p>First remove all existing partitions from the disk. Type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">d</kbd> to delete a partition. For instance, to delete an existing <span style="font-family: monospace; font-size: 95%">/dev/sda1</span>:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">Command (m for help):</code><span class="tripleclick-separator"></span><code>d</code></div><pre>
Partition number (1-4): 1
</pre></div>
<p>The partition has now been scheduled for deletion. It will no longer show up when printing the list of partitions (<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">p</kbd>, but it will not be erased until the changes have been saved. This allows users to abort the operation if a mistake was made - in that case, type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">q</kbd> immediately and hit enter and the partition will not be deleted.
</p><p>Repeatedly type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">p</kbd> to print out a partition listing and then type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">d</kbd> and the number of the partition to delete it. Eventually, the partition table will be empty:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">Command (m for help):</code><span class="tripleclick-separator"></span><code>p</code></div><pre>
Disk /dev/sda: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes
  
Device Boot    Start       End    Blocks   Id  System
</pre></div>
<p>Now that the in-memory partition table is empty, we're ready to create the partitions.
</p>
<h3><span class="mw-headline" id=".E5.88.9B.E5.BB.BABIOS.E5.BC.95.E5.AF.BC.E5.88.86.E5.8C.BA">创建BIOS引导分区</span></h3>
<p>First create a very small BIOS boot partition. Type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">n</kbd> to create a new partition, then <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">p</kbd> to select a primary partition, followed by <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">1</kbd> to select the first primary partition. When prompted for the first sector, make sure it starts from 2048 (which is needed for the boot loader) and hit enter. When prompted for the last sector, type +2M to create a partition 2 Mbyte in size:
</p>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />The start from sector 2048 is a fail-safe in case the boot loader does not detect this partition as being available for its use.</div>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">Command (m for help):</code><span class="tripleclick-separator"></span><code>n</code></div><pre>
Command action
  e   extended
  p   primary partition (1-4)
p
Partition number (1-4): 1
First sector (64-10486533532, default 64): 2048
Last sector, +sectors +size{M,K,G} (4096-10486533532, default 10486533532): +2M
</pre></div>
<p>Mark the partition for EFI purposes:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">Command (m for help):</code><span class="tripleclick-separator"></span><code>t</code></div><pre>
Selected partition 1
Hex code (type L to list codes): 4
Changed system type of partition 1 to 4 (BIOS boot)
</pre></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />Using EFI with MBR partition layout is discouraged. If an EFI capable system is used, please use GPT layout.</div>
<h3><span class="mw-headline" id=".E5.88.9B.E5.BB.BA.E5.BC.95.E5.AF.BC.E5.88.86.E5.8C.BA">创建引导分区</span></h3>
<p>Now create a small boot partition. Type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">n</kbd> to create a new partition, then <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">p</kbd> to select a primary partition, followed by <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">2</kbd> to select the second primary partition. When prompted for the first sector, accept the default by hitting <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Enter</kbd>. When prompted for the last sector, type +128M to create a partition 128 Mbyte in size:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">Command (m for help):</code><span class="tripleclick-separator"></span><code>n</code></div><pre>
Command action
  e   extended
  p   primary partition (1-4)
p
Partition number (1-4): 2
First sector (5198-10486533532, default 5198): (Hit enter)
Last sector, +sectors +size{M,K,G} (4096-10486533532, default 10486533532): +128M
</pre></div>
<p>Now, when pressing <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">p</kbd>, the following partition printout is displayed:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">Command (m for help):</code><span class="tripleclick-separator"></span><code>p</code></div><pre>
Disk /dev/sda: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes
  
   Device Boot    Start       End    Blocks   Id  System
/dev/sda1             1         3      5198+  ef  EFI (FAT-12/16/32)
/dev/sda2             3        14    105808+  83  Linux
</pre></div>
<p>Type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">a</kbd> to toggle the bootable flag on a partition and select <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">2</kbd>. After pressing <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">p</kbd> again, notice that an * is placed in the "Boot" column.
</p>
<h3><span class="mw-headline" id=".E5.88.9B.E5.BB.BAswap.E5.88.86.E5.8C.BA">创建swap分区</span></h3>
<p>To create the swap partition, type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">n</kbd> to create a new partition, then <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">p</kbd> to tell fdisk to create a primary partition. Then type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">3</kbd> to create the third primary partition, <span style="font-family: monospace; font-size: 95%">/dev/sda3</span>. When prompted for the first sector, hit <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Enter</kbd>. When prompted for the last sector, type +512M (or any other size needed for the swap space) to create a partition 512MB in size.
</p><p>After all this is done, type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">t</kbd> to set the partition type, <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">3</kbd> to select the partition just created and then type in <i>82</i> to set the partition type to "Linux Swap".
</p>
<h3><span class="mw-headline" id=".E5.88.9B.E5.BB.BA.E6.A0.B9.E5.88.86.E5.8C.BA">创建根分区</span></h3>
<p>Finally, to create the root partition, type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">n</kbd> to create a new partition, then <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">p</kbd> to tell <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span> to create a primary partition. Then type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">4</kbd> to create the fourth primary partition, <span style="font-family: monospace; font-size: 95%">/dev/sda4</span>. When prompted for the first sector, hit <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Enter</kbd>. When prompted for the last sector, hit <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Enter</kbd> to create a partition that takes up the rest of the remaining space on the disk. After completing these steps, typing <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">p</kbd> should display a partition table that looks similar to this:
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">Command (m for help):</code><span class="tripleclick-separator"></span><code>p</code></div><pre>
Disk /dev/sda: 30.0 GB, 30005821440 bytes
240 heads, 63 sectors/track, 3876 cylinders
Units = cylinders of 15120 * 512 = 7741440 bytes
  
   Device Boot    Start       End    Blocks   Id  System
/dev/sda1             1         3      5198+  ef  EFI (FAT-12/16/32)
/dev/sda2   *         3        14    105808+  83  Linux
/dev/sda3            15        81    506520   82  Linux swap
/dev/sda4            82      3876  28690200   83  Linux
</pre></div>
<h3><span class="mw-headline" id=".E4.BF.9D.E5.AD.98.E5.88.86.E5.8C.BA.E5.B8.83.E5.B1.80">保存分区布局</span></h3>
<p>To save the partition layout and exit <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fdisk</span>, type <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">w</kbd>.
</p>
<div class="cmd-box"><div><code style="color: #4E9A06; font-weight: bold;">Command (m for help):</code><span class="tripleclick-separator"></span><code>w</code></div></div>
<p>With the partitions created, it is now time to put filesystems on them.
</p><p><br />
</p>
<h2><span class="mw-headline" id=".E5.88.9B.E5.BB.BA.E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F">创建文件系统</span></h2>
<h3><span class="mw-headline" id=".E4.BB.8B.E7.BB.8D_2">介绍</span></h3>
<p>现在分区已经创建，该在上面设置文件系统了。下一章节中描述了Linux所支持的众多文件系统。知道使用哪一个文件系统的读者可以继续阅读<a href="#Applying_a_filesystem_to_a_partition">为分区应用文件系统</a>。剩下的人应该学习可用的文件系统……
</p>
<h2><span class="mw-headline" id=".E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F">文件系统</span></h2>
<p>有一些可以使用的文件系统。有些在amd64架构上稳定——建议在选择为一个重要分区实验性的选择文件系统前继续阅读。
</p>
<dl><dt> btrfs</dt>
<dd> 是下一代文件系统，提供了许多高级功能，如快照，通过校验和自我修复、 透明压缩、 子卷和集成 RAID。几个发行版已经开始将它作为一个默认的选项,但它还未为生产工作做好准备。文件系统报告崩溃是常见的。其开发人员敦促人们运行最新的内核版本来解决安全问题,以及老的问题。 这种情况已经很多年了,现在使用它还为时过早。如果出现变更，以及发生了变化，解决错误问题，都很少往旧内核注入补丁。请谨慎使用这个文件系统! </dd>
<dt> ext2</dt>
<dd> 是经考验证明可靠的Linux文件系统，但是没有元数据日志，这意味这在启动系统时的ext2文件系统的日常检查相当耗时。现在相当一部分的新一代的日志文件系统都可以非常迅速检查一致性，因此比那些非日志文件系统更受欢迎。当你启动系统碰巧遇到文件系统状态不一致时，日志文件系统不会在那里耽搁很长时间。</dd>
<dt> ext3</dt>
<dd> 是ext2文件系统的带日志版本，提供了元数据日志模式以快速恢复数据。此外还提供了其他增强的日志模式，如完整数据日志模式和有序数据日志模式。它使用了HTree索引，在几乎所有的情况下都能保持高性能。简而言之，ext3是非常好及可靠的文件系统。</dd>
<dt> ext4 </dt>
<dd>最初创建为ext3的一个分支，EXT4带来了新的功能，性能改进和去除中度更改磁盘格式大小限制。它可以跨越体积高达1的EB并用16 TB最大文件大小。取而代之的是经典的ext2/3位块分配的ext4的使用范围，这对提高大文件的性能，并减少碎片。的Ext4还提供了更为复杂的块分配算法（延迟分配和多嵌段分配）给文件系统驱动更多的方式来优化数据的布局在磁盘上。 EXT4是推荐的通用所有平台的文件系统。</dd>
<dt> JFS</dt>
<dd> 是IBM的高性能日志文件系统。JFS是一个轻量级的、快速的和稳定的基于B+树的文件系统，在很多情况下都有很好的表现。</dd>
<dt> ReiserFS</dt>
<dd>是基于B+树的文件系统，它有着非常全面的性能，特别时在处理很多小文件的时候，虽然会占用多一点CPU。ReiserFS相比其他文件系统显得受维护的不够。</dd>
<dt> XFS </dt>
<dd> 是一种带元数据日志的文件系统，它有一个健壮的特性集，并且对可伸缩性进行了优化。XFS似乎对各种各样的硬件问题显得不够宽容。</dd>
<dt> vfat</dt>
<dd> 也称为FAT32，被支持Linux，但不支持任何权限设置。它主要用于互操作性与其他操作系统（主要是微软的Windows），但也是很有必要的一些系统固件（如UEFI）的支持。</dd></dl>
<p>When using ext2, ext3 or ext4 on a small partition (less than 8GB), then the file system must be created with the proper options to reserve enough inodes. The <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mke2fs</span> application uses the "bytes-per-inode" setting to calculate how many inodes a file system should have. On smaller partitions, it is advised to increase the calculated number of inodes.
</p><p>对于ext2，可以使用下面的命令来完成：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mke2fs -T small /dev/&lt;device&gt;</code></div></div>
<p>对于ext3或ext4，添加<code>-j</code>选项来启用日志：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mke2fs -j -T small /dev/&lt;device&gt;</code></div></div>
<p>This will generally quadruple the number of inodes for a given file system as its "bytes-per-inode" reduces from one every 16kB to one every 4kB. This can be tuned even further by providing the ratio:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mke2fs -i &lt;ratio&gt; /dev/&lt;device&gt;</code></div></div>
<h3><span class="mw-headline" id=".E4.B8.BA.E5.88.86.E5.8C.BA.E5.BA.94.E7.94.A8.E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F">为分区应用文件系统</span></h3>
<p>To create a filesystem on a partition or volume, there are tools available for each possible filesystem:
</p>
<table class="table table-condensed table-striped" style="text-align: left;">

<tr>
<th scope="col" width="15%"> 文件系统
</th>
<th> 创建命令
</th></tr>
<tr>
<td> btrfs
</td>
<td> <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mkfs.btrfs</span>
</td></tr>
<tr>
<td> ext2
</td>
<td> <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mkfs.ext2</span>
</td></tr>
<tr>
<td> ext3
</td>
<td> <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mkfs.ext3</span>
</td></tr>
<tr>
<td> ext4
</td>
<td> <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mkfs.ext4</span>
</td></tr>
<tr>
<td> jfs
</td>
<td> <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mkfs.jfs</span>
</td></tr>
<tr>
<td> reiserfs
</td>
<td> <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mkreiserfs</span>
</td></tr>
<tr>
<td> xfs
</td>
<td> <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mkfs.xfs</span>
</td></tr>
<tr>
<td> vfat
</td>
<td> <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mkfs.vfat</span>
</td></tr></table>
<p>For instance, to have the boot partition (<span style="font-family: monospace; font-size: 95%">/dev/sda2</span>) in ext2 and the root partition (<span style="font-family: monospace; font-size: 95%">/dev/sda4</span>) in ext4 as used in the example partition structure, the following commands would be used:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mkfs.ext2 /dev/sda2</code></div></div>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mkfs.ext4 /dev/sda4</code></div></div>
<p>Now create the filesystems on the newly created partitions (or logical volumes).
</p>
<h3><span class="mw-headline" id=".E6.BF.80.E6.B4.BBswap.E5.88.86.E5.8C.BA">激活swap分区</span></h3>
<p><span style="font-family: monospace; font-size: 95%; font-weight: bold;">mkswap</span> is the command that is used to initialize swap partitions:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mkswap /dev/sda3</code></div></div>
<p>To activate the swap partition, use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">swapon</span>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>swapon /dev/sda3</code></div></div>
<p>Create and activate the swap with the commands mentioned above.
</p>
<h2><span class="mw-headline" id=".E6.8C.82.E8.BD.BD">挂载</span></h2>
<p>Now that the partitions are initialized and are housing a filesystem, it is time to mount those partitions. Use the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mount</span> command, but don't forget to create the necessary mount directories for every partition created. As an example we mount the root and boot partition:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mount /dev/sda4 /mnt/gentoo</code></div></div>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mkdir /mnt/gentoo/boot</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mount /dev/sda2 /mnt/gentoo/boot</code></div></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> 附注</strong><br />如果<span style="font-family: monospace; font-size: 95%">/tmp/</span>需要放在一个独立分区，确保在挂载后变更它的权限：
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>chmod 1777 /mnt/gentoo/tmp</code></div></div>
这同样适用于<span style="font-family: monospace; font-size: 95%">/var/tmp</span>。</div>
<p>Later in the instructions the proc filesystem (a virtual interface with the kernel) as well as other kernel psuedo-filesystems will be mounted. But first we <a href="../../Installation/Stage.html" title="Handbook:AMD64/Installation/Stage">install the Gentoo installation files</a>.
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../Installation/Networking/zh-cn.html" title="Previous part" class="btn btn-default">&#8592; Configuring the network</a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Installation/Stage/zh-cn.html" title="Next part" class="btn btn-default">Installing Stage3 &#8594;</a></div>
<p><br />
</p><p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 安装
</th></tr>
<tr>
<td> <a href="../../Installation/About/zh-cn.html" title="Handbook:AMD64/Installation/About/zh-cn">关于安装</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media/zh-cn.html" title="Handbook:AMD64/Installation/Media/zh-cn">选择安装媒介</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking/zh-cn.html" title="Handbook:AMD64/Installation/Networking/zh-cn">配置网络</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks/zh-cn.html" title="Handbook:AMD64/Installation/Disks/zh-cn">准备磁盘</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage/zh-cn.html" title="Handbook:AMD64/Installation/Stage/zh-cn">安装stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base/zh-cn.html" title="Handbook:AMD64/Installation/Base/zh-cn">安装基本系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel/zh-cn.html" title="Handbook:AMD64/Installation/Kernel/zh-cn">配置Linux内核</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System/zh-cn.html" title="Handbook:AMD64/Installation/System/zh-cn">配置系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools/zh-cn.html" title="Handbook:AMD64/Installation/Tools/zh-cn">安装系统工具</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader/zh-cn.html" title="Handbook:AMD64/Installation/Bootloader/zh-cn">配置系统引导程序Bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing/zh-cn.html" title="Handbook:AMD64/Installation/Finalizing/zh-cn">收尾安装工作</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage/zh-cn.html" title="Handbook:AMD64/Working/Portage/zh-cn">Portage介绍</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE/zh-cn.html" title="Handbook:AMD64/Working/USE/zh-cn">USE标记</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features/zh-cn.html" title="Handbook:AMD64/Working/Features/zh-cn">Portage功能特性</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts/zh-cn.html" title="Handbook:AMD64/Working/Initscripts/zh-cn">初始化脚本（Initscript）系统</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar/zh-cn.html" title="Handbook:AMD64/Working/EnvVar/zh-cn">环境变量</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files/zh-cn.html" title="Handbook:AMD64/Portage/Files/zh-cn">文件和目录</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables/zh-cn.html" title="Handbook:AMD64/Portage/Variables/zh-cn">变量</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches/zh-cn.html" title="Handbook:AMD64/Portage/Branches/zh-cn">混合使用不同的软件分支</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools/zh-cn.html" title="Handbook:AMD64/Portage/Tools/zh-cn">额外的工具</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree/zh-cn.html" title="Handbook:AMD64/Portage/CustomTree/zh-cn">定制Portage树</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced/zh-cn.html" title="Handbook:AMD64/Portage/Advanced/zh-cn">高级特性</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 网络配置
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction/zh-cn.html" title="Handbook:AMD64/Networking/Introduction/zh-cn">入门</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced/zh-cn.html" title="Handbook:AMD64/Networking/Advanced/zh-cn">高级配置</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular/zh-cn.html" title="Handbook:AMD64/Networking/Modular/zh-cn">模块化网络</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless/zh-cn.html" title="Handbook:AMD64/Networking/Wireless/zh-cn">无线</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending/zh-cn.html" title="Handbook:AMD64/Networking/Extending/zh-cn">添加功能</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic/zh-cn.html" title="Handbook:AMD64/Networking/Dynamic/zh-cn">动态管理</a>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id="Installing_a_stage_tarball">Installing a stage tarball</span></h2>
<h3><span class="mw-headline" id="Setting_the_date_and_time">Setting the date and time</span></h3>
<p>Before installing Gentoo, make sure that the date and time are set correctly. A mis-configured clock may lead to strange results in the future!
</p><p>To verify the current date and time, run <span style="font-family: monospace; font-size: 95%; font-weight: bold;">date</span>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>date</code></div><pre>
Fri Mar 29 16:21:18 UTC 2005
</pre></div>
<p>If the date/time displayed is wrong, update it using the <code>MMDDhhmmYYYY</code> syntax (Month, Day, hour, minute and Year). At this stage, it is recommended to use UTC time. Later on during the installation, the timezone will be defined.
</p><p>For instance, to set the date to March 29th, 16:21 in the year 2014:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>date 032916212014</code></div></div>
<h3><span class="mw-headline" id="Downloading_the_stage_tarball">Downloading the stage tarball</span></h3>
<p>Go to the Gentoo mount point where the root file system is mounted (most likely <span style="font-family: monospace; font-size: 95%">/mnt/gentoo</span>):
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>cd /mnt/gentoo</code></div></div>
<p>Depending on the installation medium, there are a couple of tools available to download a stage. One of these tools is <span style="font-family: monospace; font-size: 95%; font-weight: bold;">links</span>, a non-graphical, menu-driven browser. To download a stage, surf to the Gentoo mirror list like so:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>links <a rel="nofollow" class="external free" href="https://www.gentoo.org/downloads/mirrors/">https://www.gentoo.org/downloads/mirrors/</a></code></div></div>
<p>To use an HTTP proxy with <span style="font-family: monospace; font-size: 95%; font-weight: bold;">links</span>, pass on the URL with the <code>-http-proxy</code> option:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>links -http-proxy proxy.server.com:8080 <a rel="nofollow" class="external free" href="https://www.gentoo.org/downloads/mirrors/">https://www.gentoo.org/downloads/mirrors/</a></code></div></div>
<p>Next to <span style="font-family: monospace; font-size: 95%; font-weight: bold;">links</span> there is also the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">lynx</span> browser. Like <span style="font-family: monospace; font-size: 95%; font-weight: bold;">links</span> it is a non-graphical browser but it is not menu-driven.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>lynx <a rel="nofollow" class="external free" href="https://www.gentoo.org/downloads/mirrors/">https://www.gentoo.org/downloads/mirrors/</a></code></div></div>
<p>If a proxy needs to be defined, export the <var>http_proxy</var> and/or <var>ftp_proxy</var> variables:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>export http_proxy="<a rel="nofollow" class="external free" href="http://proxy.server.com:port/">http://proxy.server.com:port</a>"
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>export ftp_proxy="<a rel="nofollow" class="external free" href="http://proxy.server.com:port/">http://proxy.server.com:port</a>"</code></div></div>
<p>On the mirror list, select a mirror close by. Usually HTTP mirrors suffice, but other protocols are available as well. Move to the <span style="font-family: monospace; font-size: 95%">releases/amd64/autobuilds/</span> directory. There all available stage files are displayed (they might be stored within subdirectories named after the individual sub-architectures). Select one and press <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">D</kbd> to download.
</p><p>Like with the minimal installation CDs, additional downloads are available:
</p>
<ul><li> A <span style="font-family: monospace; font-size: 95%">.CONTENTS</span> file that contains a list of all files inside the stage tarball</li>
<li> A <span style="font-family: monospace; font-size: 95%">.DIGESTS</span> file that contains checksums of the stage file, in different algorithms</li>
<li> A <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> file that, like the <span style="font-family: monospace; font-size: 95%">.DIGESTS</span> file, contains checksums of the stage file in different algorithms, but is also cryptographically signed to ensure it is provided by the Gentoo project</li></ul>
<p>When finished, press <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Q</kbd> to quit the browser.
</p><p>After downloading the stage file, it is possible to verify the integrity of the downloaded stage tarball. Use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">openssl</span> and compare the output with the checksums provided by the <span style="font-family: monospace; font-size: 95%">.DIGESTS</span> or <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> file.
</p><p>For instance, to validate the SHA512 checksum:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>openssl dgst -r -sha512 stage3-amd64-&lt;release&gt;.tar.bz2</code></div></div>
<p>Another way is to use the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">sha512sum</span> command:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>sha512sum stage3-amd64-&lt;release&gt;.tar.bz2</code></div></div>
<p>To validate the Whirlpool checksum:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>openssl dgst -r -whirlpool stage3-amd64-&lt;release&gt;.tar.bz2</code></div></div>
<p>Compare the output of these commands with the value registered in the <span style="font-family: monospace; font-size: 95%">.DIGESTS(.asc)</span> files. The values need to match, otherwise the downloaded file might be corrupt (or the digests file is).
</p><p>Just like with the ISO file, it is also possible to verify the cryptographic signature of the <span style="font-family: monospace; font-size: 95%">.DIGESTS.asc</span> file using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">gpg</span> to make sure the checksums have not been tampered with:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>gpg --verify stage3-amd64-&lt;release&gt;.tar.bz2.DIGESTS.asc</code></div></div>
<h3><span class="mw-headline" id="Unpacking_the_stage_tarball">Unpacking the stage tarball</span></h3>
<p>Now unpack the downloaded stage onto the system. We use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">tar</span> to proceed:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>tar xvjpf stage3-*.tar.bz2 --xattrs</code></div></div>
<p>Make sure that the same options (<code>xvjpf</code> and <code>--xattrs</code>) are used. The x stands for Extract, the v for Verbose to see what happens during the extraction process (optional), the j for Decompress with bzip2, the p for Preserve permissions and the f to denote that we want to extract a File, not standard input. Finally, the <code>--xattrs</code> is to include the extended attributes stored in the archive as well.
</p><p>Now that the stage is installed, continue with <a href="#Configuring_the_compile_options">Configuring the compile options</a>.
</p>
<h2><span class="mw-headline" id="Configuring_compile_options">Configuring compile options</span></h2>
<h3><span class="mw-headline" id="Introduction">Introduction</span></h3>
<p>To optimize Gentoo, it is possible to set a couple of variables which impact Portage behavior. All those variables can be set as environment variables (using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">export</span>) but that isn't permanent. To keep the settings, Portage reads in the <span style="font-family: monospace; font-size: 95%">/etc/portage/make.conf</span> file, a configuration file for Portage.
</p>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />A commented listing of all possible variables can be found in <span style="font-family: monospace; font-size: 95%">/mnt/gentoo/usr/share/portage/config/make.conf.example</span>. For a successful Gentoo installation only the variables that are mentioned below need to be set.</div>
<p>Fire up an editor (in this guide we use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">nano</span>) to alter the optimization variables we will discuss hereafter.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /mnt/gentoo/etc/portage/make.conf</code></div></div>
<p>From the <span style="font-family: monospace; font-size: 95%">make.conf.example</span> file it is obvious how the file should be structured: commented lines start with "#", other lines define variables using the VARIABLE="content" syntax. Several of those variables are discussed next.
</p>
<h3><span class="mw-headline" id="CFLAGS_and_CXXFLAGS">CFLAGS and CXXFLAGS</span></h3>
<p>The <var>CFLAGS</var> and <var>CXXFLAGS</var> variables define the optimization flags for the GCC C and C++ compiler respectively. Although those are defined generally here, for maximum performance one would need to optimize these flags for each program separately. The reason for this is because every program is different. However, this is not manageable, hence the definition of these flags in the <span style="font-family: monospace; font-size: 95%">make.conf</span> file.
</p><p>In <span style="font-family: monospace; font-size: 95%">make.conf</span> one should define the optimization flags that will make the system the most responsive generally. Don't place experimental settings in this variable; too much optimization can make programs behave bad (crash, or even worse, malfunction).
</p><p>We will not explain all possible optimization options. To understand them all, read the <a rel="nofollow" class="external text" href="http://gcc.gnu.org/onlinedocs/">GNU Online Manual(s)</a> or the gcc info page (<span style="font-family: monospace; font-size: 95%; font-weight: bold;">info gcc</span> - only works on a working Linux system). The <span style="font-family: monospace; font-size: 95%">make.conf.example</span> file itself also contains lots of examples and information; don't forget to read it too.
</p><p>A first setting is the <code>-march=</code> or <code>-mtune=</code> flag, which specifies the name of the target architecture. Possible options are described in the <span style="font-family: monospace; font-size: 95%">make.conf.example</span> file (as comments). A commonly used value is <i>native</i> as that tells the compiler to select the target architecture of the current system (the one users are installing Gentoo on).
</p><p>A second one is the <code>-O</code> flag (that is a capital O, not a zero), which specifies the gcc optimization class flag. Possible classes are s (for size-optimized), 0 (zero - for no optimizations), 1, 2 or even 3 for more speed-optimization flags (every class has the same flags as the one before, plus some extras). <code>-O2</code> is the recommended default. <code>-O3</code> is known to cause problems when used system-wide, so we recommend to stick to <code>-O2</code>.
</p><p>Another popular optimization flag is <code>-pipe</code> (use pipes rather than temporary files for communication between the various stages of compilation). It has no impact on the generated code, but uses more memory. On systems with low memory, gcc might get killed. In that case, do not use this flag.
</p><p>Using <code>-fomit-frame-pointer</code> (which doesn't keep the frame pointer in a register for functions that don't need one) might have serious repercussions on the debugging of applications.
</p><p>When the <var>CFLAGS</var> and <var>CXXFLAGS</var> variables are defined, combine the several optimization flags in one string. The default values contained in the stage3 archive that is unpacked should be good enough. The following one is just an example:
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">CODE</span> <strong>Example CFLAGS and CXXFLAGS variables</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nv">CFLAGS</span><span class="o">=</span><span class="s2">&quot;-march=native -O2 -pipe&quot;</span>
<span class="c"># Use the same settings for both variables</span>
<span class="nv">CXXFLAGS</span><span class="o">=</span><span class="s2">&quot;</span><span class="si">${</span><span class="nv">CFLAGS</span><span class="si">}</span><span class="s2">&quot;</span>
</pre></div></pre></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />The <a href="../../../GCC_optimization.html" title="GCC optimization">GCC optimization guide</a> has more information on how the various compilation options can affect a system.</div>
<h3><span class="mw-headline" id="MAKEOPTS">MAKEOPTS</span></h3>
<p>The <var>MAKEOPTS</var> variable defines how many parallel compilations should occur when installing a package. A good choice is the number of CPUs (or CPU cores) in the system plus one, but this guideline isn't always perfect.
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">CODE</span> <strong>Example MAKEOPTS declaration in make.conf</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nv">MAKEOPTS</span><span class="o">=</span><span class="s2">&quot;-j2&quot;</span>
</pre></div></pre></div>
<h3><span class="mw-headline" id="Ready.2C_set.2C_go">Ready, set, go</span></h3>
<p>Update the <span style="font-family: monospace; font-size: 95%">/mnt/gentoo/etc/portage/make.conf</span> file to match personal preference and save (nano users would hit <kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Ctrl</kbd>+<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">X</kbd>). 
</p><p>Then continue with <a href="../../Installation/Base.html" title="Handbook:AMD64/Installation/Base">Installing the Gentoo base system</a>.
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../Installation/Disks.html" title="Previous part" class="btn btn-default">&#8592; Preparing the disks</a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Installation/Base.html" title="Next part" class="btn btn-default">Installing base system &#8594;</a></div>
<p><br />
</p><p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 安装
</th></tr>
<tr>
<td> <a href="../../Installation/About/zh-cn.html" title="Handbook:AMD64/Installation/About/zh-cn">关于安装</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media/zh-cn.html" title="Handbook:AMD64/Installation/Media/zh-cn">选择安装媒介</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking/zh-cn.html" title="Handbook:AMD64/Installation/Networking/zh-cn">配置网络</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks/zh-cn.html" title="Handbook:AMD64/Installation/Disks/zh-cn">准备磁盘</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage/zh-cn.html" title="Handbook:AMD64/Installation/Stage/zh-cn">安装stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base/zh-cn.html" title="Handbook:AMD64/Installation/Base/zh-cn">安装基本系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel/zh-cn.html" title="Handbook:AMD64/Installation/Kernel/zh-cn">配置Linux内核</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System/zh-cn.html" title="Handbook:AMD64/Installation/System/zh-cn">配置系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools/zh-cn.html" title="Handbook:AMD64/Installation/Tools/zh-cn">安装系统工具</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader/zh-cn.html" title="Handbook:AMD64/Installation/Bootloader/zh-cn">配置系统引导程序Bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing/zh-cn.html" title="Handbook:AMD64/Installation/Finalizing/zh-cn">收尾安装工作</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage/zh-cn.html" title="Handbook:AMD64/Working/Portage/zh-cn">Portage介绍</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE/zh-cn.html" title="Handbook:AMD64/Working/USE/zh-cn">USE标记</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features/zh-cn.html" title="Handbook:AMD64/Working/Features/zh-cn">Portage功能特性</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts/zh-cn.html" title="Handbook:AMD64/Working/Initscripts/zh-cn">初始化脚本（Initscript）系统</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar/zh-cn.html" title="Handbook:AMD64/Working/EnvVar/zh-cn">环境变量</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files/zh-cn.html" title="Handbook:AMD64/Portage/Files/zh-cn">文件和目录</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables/zh-cn.html" title="Handbook:AMD64/Portage/Variables/zh-cn">变量</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches/zh-cn.html" title="Handbook:AMD64/Portage/Branches/zh-cn">混合使用不同的软件分支</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools/zh-cn.html" title="Handbook:AMD64/Portage/Tools/zh-cn">额外的工具</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree/zh-cn.html" title="Handbook:AMD64/Portage/CustomTree/zh-cn">定制Portage树</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced/zh-cn.html" title="Handbook:AMD64/Portage/Advanced/zh-cn">高级特性</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 网络配置
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction/zh-cn.html" title="Handbook:AMD64/Networking/Introduction/zh-cn">入门</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced/zh-cn.html" title="Handbook:AMD64/Networking/Advanced/zh-cn">高级配置</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular/zh-cn.html" title="Handbook:AMD64/Networking/Modular/zh-cn">模块化网络</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless/zh-cn.html" title="Handbook:AMD64/Networking/Wireless/zh-cn">无线</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending/zh-cn.html" title="Handbook:AMD64/Networking/Extending/zh-cn">添加功能</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic/zh-cn.html" title="Handbook:AMD64/Networking/Dynamic/zh-cn">动态管理</a>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id="Chrooting">Chrooting</span></h2>
<h3><span class="mw-headline" id=".E5.8F.AF.E9.80.89.EF.BC.9A.E9.80.89.E6.8B.A9.E5.A2.83.E5.83.8F.E7.AB.99.E7.82.B9">可选：选择境像站点</span></h3>
<div class="alert alert-danger gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-exclamation-triangle"></i> 警告</strong><br /><a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-portage/mirrorselect">app-portage/mirrorselect</a>程序还没有更新到处理修改后的chroot目标文件<span style="font-family: monospace; font-size: 95%">repos.conf/gentoo.conf</span>。同时，<span style="font-family: monospace; font-size: 95%">make.conf</span>中的<var>SYNC</var>变量已过时并且不再用于Portage。这个小节需要更新，请暂时跳过……</div>
<p>为了能更快的下载源代码，这里推荐选择一个快的镜像。Portage将会在<span style="font-family: monospace; font-size: 95%">make.conf</span>文件中查找<var>GENTOO_MIRRORS</var>变量，并使用其中所列的镜像。可以通过浏览Gentoo镜像列表搜索一个（或一组）最接近系统物理位置（往往那是最快的）的镜像。另外，我们提供一个叫作<span style="font-family: monospace; font-size: 95%; font-weight: bold;">mirrorselect</span>的好工具，它为用户选择所需镜像提供了一个很好的交换。只需要移动光标选择镜像并按<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">Spacebar</kbd>选择一个或多个镜像。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mirrorselect -i -o &gt;&gt; /mnt/gentoo/etc/portage/make.conf</code></div></div>
<p>第二个重要设置是<span style="font-family: monospace; font-size: 95%">make.conf</span>中设定的<var>SYNC</var>。这个变量包含了用于更新Portage树（ebuilds的集合以及包括所有Portage下载和安装所需要的全部信息的文件）的rsync服务器。再说一次，可以手动输入一个<var>SYNC</var> 服务器，同时<span style="font-family: monospace; font-size: 95%; font-weight: bold;">mirrorselect</span>可以使此操作很容易：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mirrorselect -i -r -o &gt;&gt; /mnt/gentoo/etc/portage/make.conf</code></div></div>
<p>建议在运行完<span style="font-family: monospace; font-size: 95%; font-weight: bold;">mirrorselect</span>后再检查一遍<span style="font-family: monospace; font-size: 95%">/mnt/gentoo/etc/portage/make.conf</span> 中的设置！
</p>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> 附注</strong><br />当在<span style="font-family: monospace; font-size: 95%">make.conf</span>中手动选择一个<var>SYNC</var>服务器时，在社区镜像列表中找到离你最近的镜像。建议选择一个轮询链接，比如rsync.us.gentoo.org而非选择单一镜像。这将帮助分担负载并可以一个特定的镜像离线时实现故障安全。</div>
<h3><span class="mw-headline" id=".E5.A4.8D.E5.88.B6DNS.E4.BF.A1.E6.81.AF">复制DNS信息</span></h3>
<p>在进行新环境之前，还有一件要做的事情就是复制<span style="font-family: monospace; font-size: 95%">/etc/resolv.conf</span>中的DNS信息。需要完成这个来确保即使进入到新环境后网络仍然可以使用。<span style="font-family: monospace; font-size: 95%">/etc/resolv.conf</span>包含着当前网络中的DNS服务器。
</p><p>为了复制这个信息，建议使用<span style="font-family: monospace; font-size: 95%; font-weight: bold;">cp</span>命令的<code>-L</code>选项。这可以保障如果<span style="font-family: monospace; font-size: 95%">/etc/resolv.conf</span>是一个符号链接的话，复制的是那个目标文件而不是这个符号文件自己。否则在新环境中，符号文件将指向一个不存在的文件（因为链接目标非常可能不会在新环境中）。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>cp -L /etc/resolv.conf /mnt/gentoo/etc/</code></div></div>
<h3><span class="mw-headline" id=".E6.8C.82.E8.BD.BD.E5.BF.85.E8.A6.81.E7.9A.84.E6.96.87.E4.BB.B6.E7.B3.BB.E7.BB.9F">挂载必要的文件系统</span></h3>
<p>稍等片刻，Linux的根将变更到新的位置。为了确保新环境正常工作，需要确保一些文件系统可以正常使用。
</p><p>需要提供的文件系统是：
</p>
<ul><li> <span style="font-family: monospace; font-size: 95%">/proc/</span> 一个pseudo文件系统（看起来像是常规文件，事实上却是实时生成的），由Linux内核暴露的一些环境信息</li>
<li> <span style="font-family: monospace; font-size: 95%">/sys/</span> 一个pseudo文件系统，像要被取代的<span style="font-family: monospace; font-size: 95%">/proc/</span>一样，比<span style="font-family: monospace; font-size: 95%">/proc/</span>更加有结构</li>
<li> <span style="font-family: monospace; font-size: 95%">/dev/</span> 是一个包含全部设备文件的常规文件系统，一部分由Linux设备管理器（通常是<span style="font-family: monospace; font-size: 95%; font-weight: bold;">udev</span>）管理</li></ul>
<p><span style="font-family: monospace; font-size: 95%">/proc/</span>位置将要挂载到<span style="font-family: monospace; font-size: 95%">/mnt/gentoo/proc/</span>，而其它的两个都是绑定挂载。字面上的意思是，例如<span style="font-family: monospace; font-size: 95%">/mnt/gentoo/sys/</span>事实上<i>就是</i><span style="font-family: monospace; font-size: 95%">/sys/</span>（它只是同一个文件系统的第二个条目点），而<span style="font-family: monospace; font-size: 95%">/mnt/gentoo/proc/</span>是（可以说是）文件系统的一个新的挂载。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mount -t proc proc /mnt/gentoo/proc
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mount --rbind /sys /mnt/gentoo/sys
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mount --make-rslave /mnt/gentoo/sys
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mount --rbind /dev /mnt/gentoo/dev
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mount --make-rslave /mnt/gentoo/dev</code></div></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> 附注</strong><br /><code>--make-rslave</code>操作是稍后安装systemd支持时所需要的。</div>
<div class="alert alert-danger gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-exclamation-triangle"></i> 警告</strong><br />当使用非Gentoo安装媒介时，这时可能还不算完。一些发行版将<span style="font-family: monospace; font-size: 95%">/dev/shm</span>符号链接到<span style="font-family: monospace; font-size: 95%">/run/shm/</span>，在chroot后将变得不可用。为了让<span style="font-family: monospace; font-size: 95%">/dev/shm/</span>是一个正常挂载的tmpfs，可以如此修复：
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>rm /dev/shm &amp;&amp; mkdir /dev/shm
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mount -t tmpfs -o nosuid,nodev,noexec shm /dev/shm</code></div></div>
<p>同时确保设置了1777模式
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code> chmod 1777 /dev/shm</code></div></div>
</div>
<h3><span class="mw-headline" id=".E8.BF.9B.E5.85.A5.E6.96.B0.E7.8E.AF.E5.A2.83">进入新环境</span></h3>
<p>现在所有的分区已经初始化，并且基础环境已经安装，是时候进入到新的安装环境了。这意思着会话将把根（所能访问到的最顶层位置）从当前的安装环境（安装CD或其他安装媒介）变为安装系统（叫做初始化分区）。因此叫作<i>change root</i>或<i>chroot</i>。
</p><p>完成chroot有三个步骤：
</p>
<ol><li> 使用chroot将根位置从<span style="font-family: monospace; font-size: 95%">/</span>（在安装媒介里）更改成<span style="font-family: monospace; font-size: 95%">/mnt/gentoo/</span>（在分区里）</li>
<li> 使用<span style="font-family: monospace; font-size: 95%; font-weight: bold;">source</span>命令将一些设置（那些在<span style="font-family: monospace; font-size: 95%">/etc/profile</span>中的）重新载入到内存中</li>
<li> 更改主提示符来帮助我们记住当前会话在一个chroot环境里面。</li></ol>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>chroot /mnt/gentoo /bin/bash
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>source /etc/profile
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>export PS1="(chroot) $PS1"</code></div></div>
<p>从现在开始，所有的动作将立即在新Gentoo Linux环境里生效。当然这离完成还很远，因为安装还剩下很多章节 ：-）
</p>
<h2><span class="mw-headline" id=".E9.85.8D.E7.BD.AEPortage">配置Portage</span></h2>
<h3><span class="mw-headline" id=".E5.AE.89.E8.A3.85Portage.E5.BF.AB.E7.85.A7">安装Portage快照</span></h3>
<p>接下来，是安装Portage快照，一个用来告诉Portage哪些软件标题可用于安装、哪些配置文件可以由管理员选择等等的文件集合。
</p><p>建议使用<span style="font-family: monospace; font-size: 95%; font-weight: bold;">emerge-webrsync</span>。这将从Gentoo的一介镜像中得到最新的Portage快照（Gentoo每天发布一个基准）并安装到系统中。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge-webrsync</code></div></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> 附注</strong><br />在这个操作中，<span style="font-family: monospace; font-size: 95%; font-weight: bold;">emerge-webrsync</span>可能会报找不到<span style="font-family: monospace; font-size: 95%">/usr/portage/</span>位置。这是预期内的并且不用担心——这个工具将会创建这个位置。</div>
<p>从现在开始，Portage可能会提示建议运行某些更新。这是因为在安装了一个新的Portage快照后，Portage发现了stage3文件中已经安装的某些软件有了更新的版本。现在可以安全的忽略它；当Gentoo安装完成后可以重新触发更新。
</p>
<h3><span class="mw-headline" id=".E5.8F.AF.E9.80.89.EF.BC.9A.E6.9B.B4.E6.96.B0Portage.E6.A0.91">可选：更新Portage树</span></h3>
<p>Portage树可以更新到最新版本。前面的<span style="font-family: monospace; font-size: 95%; font-weight: bold;">emerge-webrsync</span>命令将安装一个最近的Portage快照（通常是24小时以内），所以这一步是可选的。
</p><p>假设需要最新更新的包（1小时以内），可以使用<span style="font-family: monospace; font-size: 95%; font-weight: bold;">emerge --sync</span>。这和s命令将使用rsync协议来更新Portage树（之前通过<span style="font-family: monospace; font-size: 95%; font-weight: bold;">emerge-webrsync</span>获得的）到最新状态。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --sync</code></div></div>
<p>在慢速的终端上，比如一些framebuffer或者串口控制台，建议使用<code>--quiet</code>选项来加速这个进程：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --sync --quiet</code></div></div>
<h3><span class="mw-headline" id=".E9.98.85.E8.AF.BB.E6.96.B0.E9.97.BB.E6.9D.A1.E7.9B.AE">阅读新闻条目</span></h3>
<p>当同步Portage树到系统时，它可能警告用户一条类似于下面的信息：
</p>
<div class="gw-box"><div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #204A87">CODE</span> <strong>Portage通知用户关于新闻条目</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre> * IMPORTANT: 2 news items need reading for repository 'gentoo'.
 * Use eselect news to read news items.
</pre></div></pre></div>
<p>Portage新闻条目的创建是为了提供一个通信媒介，通过rsycn树来推送重要的消息给用户。要管理它们，使用<span style="font-family: monospace; font-size: 95%; font-weight: bold;">eselect news</span>。<span style="font-family: monospace; font-size: 95%; font-weight: bold;">eselect</span>应用程序是一个Gentoo应用程序，它允许一个通用的管理界面完成对系统的变更和操作。在这里，要用到<span style="font-family: monospace; font-size: 95%; font-weight: bold;">eselect</span>的<code>news</code>模块。
</p><p>对于<code>news</code>模块，最常用的有三个操作：
</p>
<ul><li> 使用<code>list</code>显示一个可用新闻条目的预览。</li>
<li> 使用<code>read</code>来阅读新闻条目。</li>
<li> 使用<code>purge</code>将在新闻条目阅读后删除，并且不能再次阅读。</li></ul>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>eselect news list
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>eselect news read</code></div></div>
<p>更多关于新闻阅读器的信息可以通过其手册页查看: 
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>man news.eselect</code></div></div>
<h3><span class="mw-headline" id=".E9.80.89.E6.8B.A9.E6.AD.A3.E7.A1.AE.E7.9A.84.E9.85.8D.E7.BD.AE.E6.96.87.E4.BB.B6">选择正确的配置文件</span></h3>
<p><i>配置文件</i>是任何一个Gentoo系统的积木。它不仅指定<var>USE</var>、<var>CFLAGS</var>和其它重要变量的默认值，还会锁定系统的包版本范围。这些全是由Gentoo开发者们来维护。
</p><p>使用<span style="font-family: monospace; font-size: 95%; font-weight: bold;">eselect</span>，你能看到当前系统正在使用什么配置文件，现在来使用<code>profile</code>模块：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>eselect profile list</code></div><pre>
Available profile symlink targets:
  [1]   default/linux/amd64/13.0 *
  [2]   default/linux/amd64/13.0/desktop
  [3]   default/linux/amd64/13.0/desktop/gnome
  [4]   default/linux/amd64/13.0/desktop/kde
</pre></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> 附注</strong><br />命令的这个输出只是一个示例，并会随时间演变。</div>
<p>可以看到，一些架构还会有桌面的子配置文件。
</p><p>在看完amd64框架的可用配置文件之后，用户可以键入以下命令选择一个不同的配置文件来使用：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>eselect profile set 2</code></div></div>
<p><br />
</p><p>要选择一个没有32位应用程序或类库的纯64位环境，需使用一个非multilib的配置文件：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>eselect profile list</code></div><pre>
Available profile symlink targets:
  [1]   default/linux/amd64/13.0 *
  [2]   default/linux/amd64/13.0/desktop
  [3]   default/linux/amd64/13.0/desktop/gnome
  [4]   default/linux/amd64/13.0/desktop/kde
  [5]   default/linux/amd64/13.0/no-multilib
</pre></div>
<p>接下来选择<i>no-multilib</i>配置文件：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>eselect profile set 5
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>eselect profile list</code></div><pre>
Available profile symlink targets:
  [1]   default/linux/amd64/13.0
  [2]   default/linux/amd64/13.0/desktop
  [3]   default/linux/amd64/13.0/desktop/gnome
  [4]   default/linux/amd64/13.0/desktop/kde
  [5]   default/linux/amd64/13.0/no-multilib *
</pre></div>
<p><br />
</p>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> 附注</strong><br />开发者子配置文件是专用于Gentoo Linux开发，也就是说不是用于常规用户。</div>
<h3><span class="mw-headline" id=".E9.85.8D.E7.BD.AEUSE.E5.8F.98.E9.87.8F">配置USE变量</span></h3>
<p><var>USE</var>是Gentoo为用户提供的最具威力的变量之一。很多程序通过它可以选择编译或者不编译某些可选的支持。例如，一些程序可以在编译时加入对gtk或是对qt的支持。其它的程序可以在编译时加入或不加入对于SLL的支持。有些程序甚至可以在编译时加入对framebuffer的支持（svgalib）以取代X11（X服务器）。
</p><p>大多数的发行版会使用尽可能多的支持特性编译它们的软件包，这既增加了软件的大小也减慢了启动时间，而这些还没有算上可能会涉及到的大量依赖性问题。Gentoo可以让你自己定义软件编译的选项，而这正是<var>USE</var>要做的事。
</p><p>在<var>USE</var>变量里你可以定义关键字，它被用来对应相应的编译选项。例如，<code>ssl</code>将会把ssl支持编译到程序中以支持它。<code>-X</code>会移除其对于X服务器的支持（注意前面的减号）。<code>gnome gtk -kde -qt4</code>将会以支持GNOME（和GTK）但不支持KDE（和Qt）的方式编译软件，使系统为GNOME做完全调整（如果架构支持）。
</p><p>默认的USE设置全放在了系统所使用的Gentoo配置文件的<span style="font-family: monospace; font-size: 95%">make.defaults</span>文件中。Gentoo对它的配置文件们使用了一个（复杂的）继承系统，在这个阶段我们不去深入。最简单的检查当前活动的<var>USE</var>标记的办法是运行<span style="font-family: monospace; font-size: 95%; font-weight: bold;">emerge --info</span>并选择以USE开头的那一行：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --info | grep ^USE</code></div><pre>
USE=&quot;X acl alsa amd64 berkdb bindist bzip2 cli cracklib crypt cxx dri ...&quot;
</pre></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> 附注</strong><br />上面的示例被截断了，实际上的<var>USE</var>列表值是非常非常多的。</div>
<p>可以在系统的<span style="font-family: monospace; font-size: 95%">/usr/portage/profiles/use.desc</span>中找到可用的USE标记的完整描述。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>less /usr/portage/profiles/use.desc</code></div></div>
<p>在<span style="font-family: monospace; font-size: 95%; font-weight: bold;">less</span>命令中，可以通过使用<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">↑</kbd>和<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">↓</kbd>键来滚动，并且可以按<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">q</kbd>退出。
</p><p>作为示例，我们展示一个支持DVD、ALSA以及CD录制的基于KDE系统的USE设置：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/portage/make.conf</code></div></div>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/portage/make.conf</code></strong><strong>为支持DVD、ALSA和CD录制的基于KDE系统启用USE</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nv">USE</span><span class="o">=</span><span class="s2">&quot;-gtk -gnome qt4 kde dvd alsa cdr&quot;</span>
</pre></div></pre>
<p>当<var>USE</var>在<span style="font-family: monospace; font-size: 95%">/etc/portage/make.conf</span>中定义，会从那个默认列表中<i>添加</i>（或者<i>移除</i>，如果USE标记以<kbd style="color: black; font-size: small; border: 0.2em solid; border-color: #DDD #BBB #BBB #DDD; padding: 0 0.4em; background: #EEE; white-space: nowrap;">-</kbd>号开头的话）。用户想忽略所有默认的USE设置并完全由自己管理的话，应该在<span style="font-family: monospace; font-size: 95%">make.conf</span>中定义<var>USE</var>以<code>-*</code>开头：
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/portage/make.conf</code></strong><strong>忽略默认USE标记</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nv">USE</span><span class="o">=</span><span class="s2">&quot;-* X acl alsa ...&quot;</span>
</pre></div></pre>
<h2><span class="mw-headline" id=".E5.8F.AF.E9.80.89.EF.BC.9A.E4.BD.BF.E7.94.A8systemd">可选：使用systemd</span></h2>
<p>Gentoo手册其余的地方专注于OpenRC作为默认的初始支持系统。如果想替换为systemd，或者你计划使用Gnome 3.8及更高版本（必须要systemd）, 请参考<a href="../../../Systemd.html" title="Systemd">systemd</a>页面里面详细阐述了不同的配置设置和方法。
</p><p>Gentoo手册可以参考那个页面继续使用。
</p>
<h2><span class="mw-headline" id=".E6.97.B6.E5.8C.BA">时区</span></h2>
<p>为系统选择时区。在<span style="font-family: monospace; font-size: 95%">/usr/share/zoneinfo/</span>中查找可用的时区，然后写进<span style="font-family: monospace; font-size: 95%">/etc/timezone</span>文件。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ls /usr/share/zoneinfo</code></div></div>
<p>假设要选择的时区是<i>Asia/Shanghai</i>：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>echo "Asia/Shanghai" &gt; /etc/timezone</code></div></div>
<p>请避免使用<span style="font-family: monospace; font-size: 95%">/usr/share/zoneinfo/Etc/GMT*</span>时区，它们的名字并不意味着想要的时区。例如，<span style="font-family: monospace; font-size: 95%">GMT-8</span>实际上是<span style="font-family: monospace; font-size: 95%">GMT+8</span>。
</p><p>接下来，重新配置<a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-libs/timezone-data">sys-libs/timezone-data</a>包，将会为我们基于<span style="font-family: monospace; font-size: 95%">/etc/timezone</span>条目更新<span style="font-family: monospace; font-size: 95%">/etc/localtime</span>文件。<span style="font-family: monospace; font-size: 95%">/etc/localtime</span>文件用于让系统的C类库知道系统在什么时区。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --config sys-libs/timezone-data</code></div></div>
<h2><span class="mw-headline" id=".E9.85.8D.E7.BD.AE.E5.9C.B0.E5.8C.BA">配置地区</span></h2>
<p>大多数用户只想在他们的系统上使用一或两个地区。
</p><p>地区不只是指定系统应该使用的与系统进行交互的语言，同时也指定了字符串排序，日期和时间的显示等规则。 
</p><p>系统应该支持的地区应该在<span style="font-family: monospace; font-size: 95%">/etc/locale.gen</span>中提到。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/locale.gen</code></div></div>
<p>下面的地区是一个示例，展示了同时使用英语（美国）和中文（中国）及附加字符格式（如UTF-8）。
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/locale.gen</code></strong><strong>启用US和CN地区及附加字符格式</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre>en_US ISO-8859-1
en_US.UTF-8 UTF-8
zh_CN GBK
zh_CN.UTF-8 UTF-8
</pre></div></pre>
<div class="alert alert-danger gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-exclamation-triangle"></i> 警告</strong><br />我们强烈建议使用至少一个UTF-8格式的地区设置，因为有些应用程序可能需要它。</div>
<p>下一步是运行<span style="font-family: monospace; font-size: 95%; font-weight: bold;">locale-gen</span>。它将生成<span style="font-family: monospace; font-size: 95%">/etc/locale.gen</span>文件中指定的所有地区。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>locale-gen</code></div></div>
<p>要验证所选择的地区当前可用，运行<span style="font-family: monospace; font-size: 95%; font-weight: bold;">locale -a</span>。
</p><p>等完成后，我们就来设定系统级别的区域设置。我们又一次使用<span style="font-family: monospace; font-size: 95%; font-weight: bold;">eselect</span>来做这件事，现在使用<code>locale</code>模块。
</p><p>通过<span style="font-family: monospace; font-size: 95%; font-weight: bold;">eselect locale list</span>可显示可用的目标：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>eselect locale list</code></div><pre>
Available targets for the LANG variable:
  [1]   C
  [2]   en_US
  [3]   en_US.iso88591
  [4]   en_US.utf8
  [5]   POSIX
  [6]   zh_CN
  [7]   zh_CN.gbk
  [8]   zh_CN.utf8
  [ ]   (free form)
</pre></div>
<p>通过<span style="font-family: monospace; font-size: 95%; font-weight: bold;">eselect locale set VALUE</span>可以设定正确的地区：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>eselect locale set 8</code></div></div>
<p>这个还可以通过人工编辑<span style="font-family: monospace; font-size: 95%">/etc/env.d/02locale</span>文件来完成：
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/env.d/02locale</code></strong><strong>手动设置系统地区定义</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nv">LANG</span><span class="o">=</span><span class="s2">&quot;zh_CN.UTF-8&quot;</span>
</pre></div></pre>
<p>确保设定了一个地区，不然系统会在后面安装中的内核编译和部署其他软件时显示警告和错误。
</p><p>现在重新加载环境：
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>env-update &amp;&amp; source /etc/profile</code></div></div>
<p>为了帮助指导用户完成此过程。我们制作了完整的<a href="../../../Localization/Guide.html" title="Localization/Guide">本地化指南</a>。另一个有意思的文章是为系统启用UTF-8的具体信息的<a href="../../../UTF-8.html" title="UTF-8">UTF-8</a>指南。
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../Installation/Stage/zh-cn.html" title="Previous part" class="btn btn-default">&#8592; Installing Stage3</a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Installation/Kernel/zh-cn.html" title="Next part" class="btn btn-default">Configuring the kernel &#8594;</a></div>
<p><br />
</p><p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 安装
</th></tr>
<tr>
<td> <a href="../../Installation/About/zh-cn.html" title="Handbook:AMD64/Installation/About/zh-cn">关于安装</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media/zh-cn.html" title="Handbook:AMD64/Installation/Media/zh-cn">选择安装媒介</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking/zh-cn.html" title="Handbook:AMD64/Installation/Networking/zh-cn">配置网络</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks/zh-cn.html" title="Handbook:AMD64/Installation/Disks/zh-cn">准备磁盘</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage/zh-cn.html" title="Handbook:AMD64/Installation/Stage/zh-cn">安装stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base/zh-cn.html" title="Handbook:AMD64/Installation/Base/zh-cn">安装基本系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel/zh-cn.html" title="Handbook:AMD64/Installation/Kernel/zh-cn">配置Linux内核</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System/zh-cn.html" title="Handbook:AMD64/Installation/System/zh-cn">配置系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools/zh-cn.html" title="Handbook:AMD64/Installation/Tools/zh-cn">安装系统工具</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader/zh-cn.html" title="Handbook:AMD64/Installation/Bootloader/zh-cn">配置系统引导程序Bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing/zh-cn.html" title="Handbook:AMD64/Installation/Finalizing/zh-cn">收尾安装工作</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage/zh-cn.html" title="Handbook:AMD64/Working/Portage/zh-cn">Portage介绍</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE/zh-cn.html" title="Handbook:AMD64/Working/USE/zh-cn">USE标记</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features/zh-cn.html" title="Handbook:AMD64/Working/Features/zh-cn">Portage功能特性</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts/zh-cn.html" title="Handbook:AMD64/Working/Initscripts/zh-cn">初始化脚本（Initscript）系统</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar/zh-cn.html" title="Handbook:AMD64/Working/EnvVar/zh-cn">环境变量</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files/zh-cn.html" title="Handbook:AMD64/Portage/Files/zh-cn">文件和目录</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables/zh-cn.html" title="Handbook:AMD64/Portage/Variables/zh-cn">变量</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches/zh-cn.html" title="Handbook:AMD64/Portage/Branches/zh-cn">混合使用不同的软件分支</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools/zh-cn.html" title="Handbook:AMD64/Portage/Tools/zh-cn">额外的工具</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree/zh-cn.html" title="Handbook:AMD64/Portage/CustomTree/zh-cn">定制Portage树</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced/zh-cn.html" title="Handbook:AMD64/Portage/Advanced/zh-cn">高级特性</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 网络配置
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction/zh-cn.html" title="Handbook:AMD64/Networking/Introduction/zh-cn">入门</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced/zh-cn.html" title="Handbook:AMD64/Networking/Advanced/zh-cn">高级配置</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular/zh-cn.html" title="Handbook:AMD64/Networking/Modular/zh-cn">模块化网络</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless/zh-cn.html" title="Handbook:AMD64/Networking/Wireless/zh-cn">无线</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending/zh-cn.html" title="Handbook:AMD64/Networking/Extending/zh-cn">添加功能</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic/zh-cn.html" title="Handbook:AMD64/Networking/Dynamic/zh-cn">动态管理</a>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id=".E5.AE.89.E8.A3.85.E6.BA.90.E7.A0.81">安装源码</span></h2>
<p>Linux内核是所有发行版的核心。它位于用户程序和系统硬件之间。Gentoo提供给我们几个可选的内核源码。完整的清单参见Gentoo内核指南<a href="../../../Kernel/Overview.html" title="Kernel/Overview">Kernel overview page</a>。
</p><p>For amd64-based systems Gentoo recommends the <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-kernel/gentoo-sources"> sys-kernel/gentoo-sources</a> package.
</p><p>选择并使用<span style="font-family: monospace; font-size: 95%; font-weight: bold;">emerge</span>来安装你的内核源代码。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask sys-kernel/gentoo-sources</code></div></div> 
<p>This will install the Linux kernel sources in <span style="font-family: monospace; font-size: 95%">/usr/src/</span> in which a symbolic link called <span style="font-family: monospace; font-size: 95%">linux</span> will be pointing to the installed kernel source:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ls -l /usr/src/linux</code></div><pre>
lrwxrwxrwx    1 root   root    12 Oct 13 11:04 /usr/src/linux -&gt; linux-3.16.5-gentoo
</pre></div>
<p>现在是时候来配置和编译内核源代码了。有两种方法:
</p>
<ol><li> The kernel is manually configured and built.</li>
<li> A tool called <span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel</span> is used to automatically build and install the Linux kernel.</li></ol>
<p>We explain the manual configuration as the default choice here as it is the best way to optimize an environment.
</p>
<h2><span class="mw-headline" id=".E9.BB.98.E8.AE.A4.EF.BC.9A.E6.89.8B.E5.8A.A8.E9.85.8D.E7.BD.AE">默认：手动配置</span></h2>
<h3><span class="mw-headline" id=".E4.BB.8B.E7.BB.8D_3">介绍</span></h3>
<p>Manually configuring a kernel is often seen as the most difficult procedure a Linux user ever has to perform. Nothing is less true - after configuring a couple of kernels no-one even remembers that it was difficult&#160;;)
</p><p>However, one thing is true: it is vital to know the system when a kernel is configured manually. Most information can be gathered by emerging <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-apps/pciutils">sys-apps/pciutils</a> which contains the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">lspci</span> command:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask sys-apps/pciutils</code></div></div> 
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />Inside the chroot, it is safe to ignore any pcilib warnings (like <i>pcilib: cannot open /sys/bus/pci/devices</i>) that <span style="font-family: monospace; font-size: 95%; font-weight: bold;">lspci</span> might throw out.</div>
<p>Another source of system information is to run <span style="font-family: monospace; font-size: 95%; font-weight: bold;">lsmod</span> to see what kernel modules the installation CD uses as it might provide a nice hint on what to enable.
</p><p>Now go to the kernel source directory and execute <span style="font-family: monospace; font-size: 95%; font-weight: bold;">make menuconfig</span>. This will fire up menu-driven configuration screen.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>cd /usr/src/linux
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>make menuconfig</code></div></div>
<p>The Linux kernel configuration has many, many sections. Let's first list some options that must be activated (otherwise Gentoo will not function, or not function properly without additional tweaks). We also have a <a href="../../../Kernel/Gentoo_Kernel_Configuration_Guide.html" title="Kernel/Gentoo Kernel Configuration Guide">Gentoo kernel configuration guide</a> on the Gentoo wiki that might help out further.
</p>
<h3><span class="mw-headline" id="Activating_required_options">Activating required options</span></h3>
<p>Make sure that every driver that is vital to the booting of the system (such as SCSI controller, ...) is compiled in the kernel and not as a module, otherwise the system will not be able to boot completely.
</p><p>Next select the exact processor type. It is also recommended to enable MCE features (if available) so that users are able to be notified of any hardware problems. On some architectures (such as x86_64), these errors are not printed to dmesg, but to <span style="font-family: monospace; font-size: 95%">/dev/mcelog</span>. This requires the <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-admin/mcelog">app-admin/mcelog</a> package. 
</p><p>Also select <i>Maintain a devtmpfs file system to mount at /dev</i> so that critical device files are already available early in the boot process.
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #4E9A06">KERNEL</span> <strong>Enabling devtmpfs support</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
Device Drivers ---&gt;
  Generic Driver Options ---&gt;
    [*] Maintain a devtmpfs filesystem to mount at /dev
    [ ]   Automount devtmpfs at /dev, after the kernel mounted the rootfs
</pre>
</pre></div></pre>
<p>Now go to File Systems and select support for the filesystems you use. Don't compile the file system that is used for the root filesystem as module, otherwise the Gentoo system will not be able to mount the partition. Also select <i>Virtual memory</i> and <i>/proc file system</i>.
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #4E9A06">KERNEL</span> <strong>Selecting necessary file systems</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
File systems ---&gt;
(Select one or more of the following options as needed by your system)
  &lt;*&gt; Second extended fs support
  &lt;*&gt; Ext3 journalling file system support
  &lt;*&gt; The Extended 4 (ext4) filesystem
  &lt;*&gt; Reiserfs support
  &lt;*&gt; JFS filesystem support
  &lt;*&gt; XFS filesystem support
  ...
  Pseudo Filesystems ---&gt;
    [*] /proc file system support
    [*] Virtual memory file system support (former shm fs)
</pre>
</pre></div></pre>
<p>If PPPoE is used to connect to the Internet, or a dial-up modem is used, then enable the following options:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #4E9A06">KERNEL</span> <strong>Selecting PPPoE necessary drivers</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
Device Drivers ---&gt;
  Network device support ---&gt;
    &lt;*&gt; PPP (point-to-point protocol) support
    &lt;*&gt;   PPP support for async serial ports
    &lt;*&gt;   PPP support for sync tty ports
</pre>
</pre></div></pre>
<p>The two compression options won't harm but are not definitely needed, neither does the PPP over Ethernet option, that might only be used by ppp when configured to do kernel mode PPPoE.
</p><p>Don't forget to include support in the kernel for the network (Ethernet or wireless) cards.
</p><p>Most systems also have multiple cores at their disposal, so it is important to activate <i>Symmetric multi-processing support</i>:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #4E9A06">KERNEL</span> <strong>Activating SMP support</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
Processor type and features  ---&gt;
  [*] Symmetric multi-processing support
</pre>
</pre></div></pre>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />In multi-core systems, each core counts as one processor.</div>
<p>If USB input devices (like keyboard or mouse) are used don't forget to enable those as well:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #4E9A06">KERNEL</span> <strong>Activating USB Support for input devices</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
Device Drivers ---&gt;
  [*] HID Devices  ---&gt;
    &lt;*&gt;   USB Human Interface Device (full HID) support
</pre>
</pre></div></pre>
<p><br />
</p>
<h3><span class="mw-headline" id="Architecture_specific_kernel_configuration">Architecture specific kernel configuration</span></h3>
<p>Make sure to select IA32 Emulation if 32-bit programs should be supported (multilib). Gentoo will install a multilib system (mixed 32-bit/64-bit computing) by default, so unless a <span style="font-family: monospace; font-size: 95%">no-multilib</span> profile is used, this option is required.
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #4E9A06">KERNEL</span> <strong>Selecting processor types and features</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
Processor type and features  ---&gt;
   [ ] Machine Check / overheating reporting 
   [ ]   Intel MCE Features
   [ ]   AMD MCE Features
  Processor family (AMD-Opteron/Athlon64)  ---&gt;
    ( ) Opteron/Athlon64/Hammer/K8
    ( ) Intel P4 / older Netburst based Xeon
    ( ) Core 2/newer Xeon
    ( ) Intel Atom
    ( ) Generic-x86-64
Executable file formats / Emulations  ---&gt;
   [*] IA32 Emulation
</pre>
</pre></div></pre>
<p>Enable GPT partition label support if that was used previously when partitioning the disk:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #4E9A06">KERNEL</span> <strong>Enable support for GPT</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
-*- Enable the block layer ---&gt;
    ...
    Partition Types ---&gt;
    [*] Advanced partition selection
      ...
      [*] EFI GUID Partition support
</pre>
</pre></div></pre>
<p>Enable EFI stub support and EFI variables in the Linux kernel if UEFI is used to boot the system:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #4E9A06">KERNEL</span> <strong>Enable support for UEFI</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
Processor type and features  ---&gt;
    [*] EFI runtime service support 
    [*]   EFI stub support
  
Firmware Drivers  ---&gt;
    &lt;*&gt; EFI Variable Support via sysfs
</pre>
</pre></div></pre>
<h3><span class="mw-headline" id="Compiling_and_installing">Compiling and installing</span></h3>
<p>With the configuration now done, it is time to compile and install the kernel. Exit the configuration and start the compilation process:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>make &amp;&amp; make modules_install</code></div></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />It is possible to enable parallel builds using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">make -jX</span> with <code>X</code> being an integer number of parallel tasks that the build process is allowed to launch. This is similar to the instructions about <span style="font-family: monospace; font-size: 95%">/etc/portage/make.conf</span> earlier, with the <var>MAKEOPTS</var> variable.</div>
<p>When the kernel has finished compiling, copy the kernel image to <span style="font-family: monospace; font-size: 95%">/boot/</span>. This is handled by the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">make install</span> command:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>make install</code></div></div>
<p>This will copy the kernel image into <span style="font-family: monospace; font-size: 95%">/boot/</span> together with the <span style="font-family: monospace; font-size: 95%">System.map</span> file and the kernel configuration file.
</p><p>With UEFI systems, create the <span style="font-family: monospace; font-size: 95%">/boot/efi/boot/</span> location, and then copy the kernel into this location, calling it <span style="font-family: monospace; font-size: 95%">bootx64.efi</span>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>mkdir -p /boot/efi/boot
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>cp /boot/vmlinuz-* /boot/efi/boot/bootx64.efi
</code></div></div>
<p><br />
</p>
<h3><span class="mw-headline" id=".E5.8F.AF.E9.80.89:.E5.BB.BA.E9.80.A0initramfs">可选:建造initramfs</span></h3>
<p>In certain cases it is necessary to build an initramfs - an initial ram-based file system. The most common reason is when important file system locations (like <span style="font-family: monospace; font-size: 95%">/usr/</span> or <span style="font-family: monospace; font-size: 95%">/var/</span>) are on separate partitions. With an initramfs, these partitions can be mounted using the tools available inside the initramfs.
</p><p>如果没有initramfs的，存在着巨大的风险，系统将无法正常开机，因为这是负责安装的文件系统工具需要驻留在这些文件系统的信息。 initramfs中的一个将在必要的文件拉进它的内核启动之后使用的档案，但控制被移交前转移到初始化工具。在initramfs的脚本，然后将确保分区正确地安装在系统继续启动之前。
</p><p>To install an initramfs, install <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-kernel/genkernel">sys-kernel/genkernel</a> first, then have it generate an initramfs:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge genkernel</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>genkernel --install initramfs</code></div></div>
<p>In order to enable specific support in the initramfs, such as lvm or raid, add in the appropriate options to <span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel</span>. See <span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel --help</span> for more information. In the next example we enables support for LVM and software raid (mdadm):
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>genkernel --lvm --mdadm --install initramfs</code></div></div>
<p>The initramfs will be stored in <span style="font-family: monospace; font-size: 95%">/boot/</span>. The resulting file can be found by simply listing the files starting with <i>initramfs</i>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ls /boot/initramfs*</code></div></div>
<p>Now continue with <a href="#Kernel_modules">Kernel modules</a>.
</p>
<h2><span class="mw-headline" id=".E5.A4.87.E9.80.89.EF.BC.9A.E4.BD.BF.E7.94.A8genkernel">备选：使用genkernel</span></h2>
<p>If a manual configuration looks too daunting, then using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel</span> is recommended. It will configure and build the kernel automatically.
</p><p><span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel</span> works by configuring a kernel nearly identically to the way the installation CD kernel is configured. This means that when <span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel</span> is used to build the kernel, the system will generally detect all  hardware at boot-time, just like the installation CD does. Because <span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel</span> doesn't require any manual kernel configuration, it is an ideal solution for those users who may not be comfortable compiling their own kernels.
</p><p>Now, let's see how to use genkernel. First, emerge the <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-kernel/genkernel">sys-kernel/genkernel</a> ebuild:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask sys-kernel/genkernel</code></div></div> 
<p>Next, edit the <span style="font-family: monospace; font-size: 95%">/etc/fstab</span> file so that the line containing <span style="font-family: monospace; font-size: 95%">/boot/</span> as second field has the first field pointing to the right device. If the partitioning example from the handbook is followed, then this device is most likely /dev/sda2 with the ext2 file system. This would make the entry in the file look like so:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/fstab</code></div></div>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/fstab</code></strong><strong>Configuring the /boot mountpoint</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
/dev/sda2	/boot	ext2	defaults	0 2
</pre>
</pre></div></pre>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />Further in the Gentoo installation, <span style="font-family: monospace; font-size: 95%">/etc/fstab</span> will be configured again. The <span style="font-family: monospace; font-size: 95%">/boot</span> setting is needed right now as the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel</span> application reads in this configuration.</div>
<p>Now, compile the kernel sources by running <span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel all</span>. Be aware though, as <span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel</span> compiles a kernel that supports almost all hardware, this compilation will take quite a while to finish!
</p>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />If the boot partition doesn't use ext2 or ext3 as filesystem it <i>might</i> be necessary to manually configure the kernel using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">genkernel --menuconfig all</span> and add support for this particular filesystem in the kernel (i.e. not as a module). Users of LVM2 will probably want to add <code>--lvm</code> as an argument as well.</div>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>genkernel all</code></div></div>
<p>Once genkernel completes, a kernel, full set of modules and initial ram disk (initramfs) will be created. We will use the kernel and initrd when configuring a boot loader later in this document. Write down the names of the kernel and initrd as this information is used when the boot loader configuration file is edited. The initrd will be started immediately after booting to perform hardware autodetection (just like on the installation CD) before the "real" system starts up.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ls /boot/kernel* /boot/initramfs*</code></div></div>
<h2><span class="mw-headline" id=".E5.86.85.E6.A0.B8.E6.A8.A1.E5.9D.97">内核模块</span></h2>
<h3><span class="mw-headline" id=".E9.85.8D.E7.BD.AE.E6.A8.A1.E5.9D.97">配置模块</span></h3>
<p>List the modules that need to be loaded automatically in <span style="font-family: monospace; font-size: 95%">/etc/conf.d/modules</span>. Extra options can be added to the modules too if necessary.
</p><p>To view all available modules, run the following <span style="font-family: monospace; font-size: 95%; font-weight: bold;">find</span> command. Don't forget to substitute "&lt;kernel version&gt;" with the version of the kernel just compiled:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>find /lib/modules/&lt;kernel version&gt;/ -type f -iname '*.o' -or -iname '*.ko' | less</code></div></div>
<p>For instance, to automatically load the <span style="font-family: monospace; font-size: 95%">3c59x.ko</span> module (which is the driver for a specific 3Com network card family), edit the <span style="font-family: monospace; font-size: 95%">/etc/conf.d/modules</span> file and enter the module name in it.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/conf.d/modules</code></div><pre>
modules=&quot;3c59x&quot;
</pre></div>
<p>Continue the installation with <a href="../../Installation/System.html" title="Handbook:AMD64/Installation/System">Configuring the system</a>.
</p>
<h3><span class="mw-headline" id=".E5.8F.AF.E9.80.89.EF.BC.9A.E5.AE.89.E8.A3.85.E5.9B.BA.E4.BB.B6">可选：安装固件</span></h3>
<p>Some drivers require additional firmware to be installed on the system before they work. This is often the case for network interfaces, especially wireless network interfaces. Most of the firmware is packaged in <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-kernel/linux-firmware">sys-kernel/linux-firmware</a>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask sys-kernel/linux-firmware</code></div></div> 
<p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../Installation/Base.html" title="Previous part" class="btn btn-default">&#8592; Installing base system</a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Installation/System.html" title="Next part" class="btn btn-default">Configuring the system &#8594;</a></div>
<p><br />
</p><p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Installation
</th></tr>
<tr>
<td> <a href="../../Installation/About.html" title="Handbook:AMD64/Installation/About">About the installation</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media.html" title="Handbook:AMD64/Installation/Media">Choosing the media</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking.html" title="Handbook:AMD64/Installation/Networking">Configuring the network</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks.html" title="Handbook:AMD64/Installation/Disks">Preparing the disks</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage.html" title="Handbook:AMD64/Installation/Stage">Installing stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base.html" title="Handbook:AMD64/Installation/Base">Installing base system</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel.html" title="Handbook:AMD64/Installation/Kernel">Configuring the kernel</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System.html" title="Handbook:AMD64/Installation/System">Configuring the system</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools.html" title="Handbook:AMD64/Installation/Tools">Installing tools</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader.html" title="Handbook:AMD64/Installation/Bootloader">Configuring the bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing.html" title="Handbook:AMD64/Installation/Finalizing">Finalizing</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Working with Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage.html" title="Handbook:AMD64/Working/Portage">Portage introduction</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE.html" title="Handbook:AMD64/Working/USE">USE flags</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features.html" title="Handbook:AMD64/Working/Features">Portage features</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts.html" title="Handbook:AMD64/Working/Initscripts">Initscript system</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar.html" title="Handbook:AMD64/Working/EnvVar">Environment variables</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Working with Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files.html" title="Handbook:AMD64/Portage/Files">Files and directories</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables.html" title="Handbook:AMD64/Portage/Variables">Variables</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches.html" title="Handbook:AMD64/Portage/Branches">Mixing software branches</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools.html" title="Handbook:AMD64/Portage/Tools">Additional tools</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree.html" title="Handbook:AMD64/Portage/CustomTree">Custom Portage tree</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced.html" title="Handbook:AMD64/Portage/Advanced">Advanced features</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Network configuration
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction.html" title="Handbook:AMD64/Networking/Introduction">Getting started</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced.html" title="Handbook:AMD64/Networking/Advanced">Advanced configuration</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular.html" title="Handbook:AMD64/Networking/Modular">Modular networking</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless.html" title="Handbook:AMD64/Networking/Wireless">Wireless</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending.html" title="Handbook:AMD64/Networking/Extending">Adding functionality</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic.html" title="Handbook:AMD64/Networking/Dynamic">Dynamic management</a>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id="Filesystem_information">Filesystem information</span></h2>
<h3><span class="mw-headline" id="About_fstab">About fstab</span></h3>
<p>Under Linux, all partitions used by the system must be listed in <span style="font-family: monospace; font-size: 95%">/etc/fstab</span>. This file contains the mount points of those partitions (where they are seen in the file system structure), how they should be mounted and with what special options (automatically or not, whether users can mount them or not, etc.)
</p>
<h3><span class="mw-headline" id="Creating_the_fstab_file">Creating the fstab file</span></h3>
<p>The <span style="font-family: monospace; font-size: 95%">/etc/fstab</span> file uses a table-like syntax. Every line consists of six fields, separated by whitespace (space(s), tabs or a mixture). Each field has its own meaning:
</p>
<ol><li> The first field shows the partition described (the path to the device file)</li>
<li> The second field shows the mount point at which the partition should be mounted</li>
<li> The third field shows the filesystem used by the partition</li>
<li> The fourth field shows the mount options used by <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mount</span> when it wants to mount the partition. As every filesystem has its own mount options, users are encouraged to read the mount man page (<span style="font-family: monospace; font-size: 95%; font-weight: bold;">man mount</span>) for a full listing. Multiple mount options are comma-separated.</li>
<li> The fifth field is used by dump to determine if the partition needs to be dumped or not. This can generally be left as 0 (zero).</li>
<li> The sixth field is used by <span style="font-family: monospace; font-size: 95%; font-weight: bold;">fsck</span> to determine the order in which filesystems should be checked if the system wasn't shut down properly. The root filesystem should have 1 while the rest should have 2 (or 0 if a filesystem check isn't necessary).</li></ol>
<div class="alert alert-warning gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-exclamation-circle"></i> Important</strong><br />The default <span style="font-family: monospace; font-size: 95%">/etc/fstab</span> file provided by Gentoo is not a valid fstab file but instead more of a template.</div>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/fstab</code></div></div>
<p>In the remainder of the text, we use the default <span style="font-family: monospace; font-size: 95%">/dev/sd*</span> block device files as partition. Users can also opt to use the symbolic links in the <span style="font-family: monospace; font-size: 95%">/dev/disk/by-id/</span> or <span style="font-family: monospace; font-size: 95%">/dev/disk/by-uuid/</span> locations. These names are not likely to change, whereas the default block device files naming depends on a number of factors (such as how and in what order the disks are attached to the system). However, unless someone intends to fiddle with the disk ordering, one can continue with the default block device files safely.
</p><p>Let us take a look at how to write down the options for the <span style="font-family: monospace; font-size: 95%">/boot/</span> partition. This is just an example, and should be modified according to the partitioning decisions made earlier in the installation.
In our amd64 partitioning example, <span style="font-family: monospace; font-size: 95%">/boot/</span> is usually the <span style="font-family: monospace; font-size: 95%">/dev/sda2</span> partition, with ext2 as filesystem. It needs to be checked during boot, so we would write down:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/fstab</code></strong><strong>An example /boot line for /etc/fstab</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
/dev/sda2   /boot     ext2    defaults        0 2
</pre>
</pre></div></pre>
<p>Some users don't want their <span style="font-family: monospace; font-size: 95%">/boot/</span> partition to be mounted automatically to improve their system's security. Those people should substitute <i>defaults</i> with <i>noauto</i>. This does mean that those users will need to manually mount this partition every time they want to use it.
</p><p>Add the rules that match the previously decided partitioning scheme and append rules for devices such as CD-ROM drive(s), and of course, if other partitions or drives are used, for those too.
</p><p>Below is a more elaborate example of an <span style="font-family: monospace; font-size: 95%">/etc/fstab</span> file:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/fstab</code></strong><strong>A full /etc/fstab example</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><pre>
/dev/sda2   /boot        ext2    defaults,noatime     0 2
/dev/sda3   none         swap    sw                   0 0
/dev/sda4   /            ext4    noatime              0 1
  
/dev/cdrom  /mnt/cdrom   auto    noauto,user          0 0
</pre>
</pre></div></pre>
<p>When <code>auto</code> is used in the third field, it makes the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">mount</span> command guess what the filesystem would be. This is recommended for removable media as they can be created with one of many filesystems. The <code>user</code> option in the fourth field makes it possible for non-root users to mount the CD.
</p><p>To improve performance, most users would want to add the <code>noatime</code> mount option, which results in a faster system since access times aren't registered (those are not needed generally anyway). This is also recommended for solid state drive (SSD) users, who should also enable the <code>discard</code> mount option (ext4 and btrfs only for now) which makes the <code>TRIM</code> command work.
</p><p>Double-check the <span style="font-family: monospace; font-size: 95%">/etc/fstab</span> file, save and quit to continue.
</p>
<h2><span class="mw-headline" id="Networking_information">Networking information</span></h2>
<h3><span class="mw-headline" id="Host_and_domain_information">Host and domain information</span></h3>
<p>One of the choices the user has to make is name his/her PC. This seems to be quite easy, but lots of users are having difficulties finding the appropriate name for their Linux PC. To speed things up, know that the decision is not final - it can be changed afterwards. In the examples below, the hostname <i>tux</i> is used within the domain <i>homenetwork</i>.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/conf.d/hostname</code></div><pre>
# Set the hostname variable to the selected host name
hostname=&quot;tux&quot;
</pre></div>
<p>Second, if a domain name is needed, set it in <span style="font-family: monospace; font-size: 95%">/etc/conf.d/net</span>. This is only necessary if the ISP or network administrator says so, or if the network has a DNS server but not a DHCP server. Don't worry about DNS or domain names if the system uses DHCP for dynamic IP address allocation and network configuration.
</p>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />The <span style="font-family: monospace; font-size: 95%">/etc/conf.d/net</span> file does not exist by default, so needs to be created.</div>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/conf.d/net</code></div><pre>
# Set the dns_domain_lo variable to the selected domain name
dns_domain_lo=&quot;homenetwork&quot;
</pre></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />If no domain name is configured, then users will notice they get "This is hostname.(none)" messages at their login screen. This should then be fixed by editing <span style="font-family: monospace; font-size: 95%">/etc/issue</span> and deleting the string <code>.\O</code> from that file.</div>
<p>If a NIS domain is needed (users that do not know this will not need one), define that one too:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/conf.d/net</code></div><pre>
# Set the nis_domain_lo variable to the selected NIS domain name
nis_domain_lo=&quot;my-nisdomain&quot;
</pre></div>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />For more information on configuring DNS and NIS, please read the examples provided in <span style="font-family: monospace; font-size: 95%">/usr/share/doc/netifrc-*/net.example.bz2</span> which can be read using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">bzless</span>. Also, it might be interesting to install <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/net-dns/openresolv">net-dns/openresolv</a> to help manage the DNS/NIS setup.</div>
<h3><span class="mw-headline" id="Configuring_the_network">Configuring the network</span></h3>
<p>During the Gentoo Linux installation, networking was already configured. However, that was for the installation CD itself and not for the installed environment. Right now, the network configuration is made for the installed Gentoo Linux system.
</p>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />More detailed information about networking, including advanced topics like bonding, bridging, 802.1Q VLANs or wireless networking is covered in the Gentoo Network Configuration section.</div>
<p>All networking information is gathered in <span style="font-family: monospace; font-size: 95%">/etc/conf.d/net</span>. It uses a straightforward yet perhaps not intuitive syntax. But don't fear, everything is explained below. A fully commented example that covers many different configurations is available in <span style="font-family: monospace; font-size: 95%">/usr/share/doc/netifrc-*/net.example.bz2</span>.
</p><p>First install <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/net-misc/netifrc">net-misc/netifrc</a>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask&#160;--noreplace net-misc/netifrc</code></div></div> 
<p>DHCP is used by default. For DHCP to work, a DHCP client needs to be installed. This is described later in Installing Necessary System Tools.
</p><p>If the network connection needs to be configured because of specific DHCP options or because DHCP is not used at all, then open <span style="font-family: monospace; font-size: 95%">/etc/conf.d/net</span>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/conf.d/net</code></div></div>
<p>Set both <var>config_eth0</var> and <var>routes_eth0</var> to enter IP address information and routing information:
</p>
<div class="alert alert-info gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-sticky-note-o fa-rotate-180"></i> Note</strong><br />This assumes that the network interface will be called eth0. This is, however, very system dependent. It is recommended to assume that the interface is named the same as the interface name when booted from the installation media if the installation media is sufficiently recent. More information can be found in Network Interface Naming.</div>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/conf.d/net</code></strong><strong>Static IP definition</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nv">config_eth0</span><span class="o">=</span><span class="s2">&quot;192.168.0.2 netmask 255.255.255.0 brd 192.168.0.255&quot;</span>
<span class="nv">routes_eth0</span><span class="o">=</span><span class="s2">&quot;default via 192.168.0.1&quot;</span>
</pre></div></pre>
<p>To use DHCP, define <var>config_eth0</var>:
</p>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/conf.d/net</code></strong><strong>DHCP definition</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre><span class="nv">config_eth0</span><span class="o">=</span><span class="s2">&quot;dhcp&quot;</span>
</pre></div></pre>
<p>Please read <span style="font-family: monospace; font-size: 95%">/usr/share/doc/netifrc-*/net.example.bz2</span> for a list of all available options. Be sure to also read up on the DHCP client man page if specific DHCP options need to be set.
</p><p>If the system has several network interfaces, then repeat the above steps for <var>config_eth1</var>, <var>config_eth2</var>, etc.
</p><p>Now save the configuration and exit to continue.
</p>
<h3><span class="mw-headline" id="Automatically_start_networking_at_boot">Automatically start networking at boot</span></h3>
<p>To have the network interfaces activated at boot, they need to be added to the default runlevel.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>cd /etc/init.d
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>ln -s net.lo net.eth0
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>rc-update add net.eth0 default</code></div></div>
<p>If the system has several network interfaces, then the appropriate <span style="font-family: monospace; font-size: 95%">net.*</span> files need to be created just like we did with <span style="font-family: monospace; font-size: 95%">net.eth0</span>.
</p><p>If after booting the system we find out that the assumption about the network interface name (which is currently documented as <code>eth0</code>) was wrong, then execute the following steps to rectify this:
</p>
<ol><li> Update the <span style="font-family: monospace; font-size: 95%">/etc/conf.d/net</span> file with the correct interface name (like <code>enp3s0</code> instead of <code>eth0</code>).</li>
<li> Create new symbolic link (like <span style="font-family: monospace; font-size: 95%">/etc/init.d/net.enp3s0</span>).</li>
<li> Remove the old symbolic link (<span style="font-family: monospace; font-size: 95%; font-weight: bold;">rm /etc/init.d/net.eth0</span>).</li>
<li> Add the new one to the default runlevel.</li>
<li> Remove the old one using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">rc-update del net.eth0 default</span>.</li></ol>
<h3><span class="mw-headline" id="The_hosts_file">The hosts file</span></h3>
<p>Next inform Linux about the network environment. This is defined in <span style="font-family: monospace; font-size: 95%">/etc/hosts</span> and helps in resolving host names to IP addresses for hosts that aren't resolved by the nameserver. 
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/hosts</code></div></div>
<div class="box-caption"><span class="label" style="margin-right: .5em; background-color: #54487A">FILE</span> <strong><code style="border: none; background: none; color: #54487A; margin-right: .5em;">/etc/hosts</code></strong><strong>Filling in the networking information</strong></div><pre class="captioned"><div class="mw-highlight mw-content-ltr" dir="ltr"><pre># This defines the current system and must be set
127.0.0.1     tux.homenetwork tux localhost
  
# Optional definition of extra systems on the network
192.168.0.5   jenny.homenetwork jenny
192.168.0.6   benny.homenetwork benny
</pre></div></pre>
<p>Save and exit the editor to continue.
</p>
<h3><span class="mw-headline" id="Optional:_Get_PCMCIA_working">Optional: Get PCMCIA working</span></h3>
<p>PCMCIA users should now install the <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-apps/pcmciautils">sys-apps/pcmciautils</a> package.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask sys-apps/pcmciautils</code></div></div> 
<h2><span class="mw-headline" id="System_information">System information</span></h2>
<h3><span class="mw-headline" id="Root_password">Root password</span></h3>
<p>Set the root password using the <span style="font-family: monospace; font-size: 95%; font-weight: bold;">passwd</span> command. 
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>passwd</code></div></div>
<p>The root Linux account is an all-powerful account, so pick a strong password. Later an additional regular user account will be created for daily operations.
</p>
<h3><span class="mw-headline" id="Init_and_boot_configuration">Init and boot configuration</span></h3>
<p>Gentoo (at least when using OpenRC) uses <span style="font-family: monospace; font-size: 95%">/etc/rc.conf</span> to configure the services, startup, and shutdown of a system. Open up <span style="font-family: monospace; font-size: 95%">/etc/rc.conf</span> and enjoy all the comments in the file. Review the settings and change where needed.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/rc.conf</code></div></div>
<p>Next, open <span style="font-family: monospace; font-size: 95%">/etc/conf.d/keymaps</span> to handle keyboard configuration. Edit it to configure and select the right keyboard.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/conf.d/keymaps</code></div></div>
<p>Take special care with the <var>keymap</var> variable. If the wrong keymap is selected, then weird results will come up when typing on the keyboard.
</p><p>Finally, edit <span style="font-family: monospace; font-size: 95%">/etc/conf.d/hwclock</span> to set the clock options. Edit it according to personal preference.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/conf.d/hwclock</code></div></div>
<p>If the hardware clock is not using UTC, then it is necessary to set <code>clock="local"</code> in the file. Otherwise the system might show clock skew behavior.
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../Installation/Kernel.html" title="Previous part" class="btn btn-default">&#8592; Configuring the kernel</a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Installation/Tools.html" title="Next part" class="btn btn-default">Installing tools &#8594;</a></div>
<p><br />
</p><p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Installation
</th></tr>
<tr>
<td> <a href="../../Installation/About.html" title="Handbook:AMD64/Installation/About">About the installation</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media.html" title="Handbook:AMD64/Installation/Media">Choosing the media</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking.html" title="Handbook:AMD64/Installation/Networking">Configuring the network</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks.html" title="Handbook:AMD64/Installation/Disks">Preparing the disks</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage.html" title="Handbook:AMD64/Installation/Stage">Installing stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base.html" title="Handbook:AMD64/Installation/Base">Installing base system</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel.html" title="Handbook:AMD64/Installation/Kernel">Configuring the kernel</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System.html" title="Handbook:AMD64/Installation/System">Configuring the system</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools.html" title="Handbook:AMD64/Installation/Tools">Installing tools</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader.html" title="Handbook:AMD64/Installation/Bootloader">Configuring the bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing.html" title="Handbook:AMD64/Installation/Finalizing">Finalizing</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Working with Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage.html" title="Handbook:AMD64/Working/Portage">Portage introduction</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE.html" title="Handbook:AMD64/Working/USE">USE flags</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features.html" title="Handbook:AMD64/Working/Features">Portage features</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts.html" title="Handbook:AMD64/Working/Initscripts">Initscript system</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar.html" title="Handbook:AMD64/Working/EnvVar">Environment variables</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Working with Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files.html" title="Handbook:AMD64/Portage/Files">Files and directories</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables.html" title="Handbook:AMD64/Portage/Variables">Variables</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches.html" title="Handbook:AMD64/Portage/Branches">Mixing software branches</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools.html" title="Handbook:AMD64/Portage/Tools">Additional tools</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree.html" title="Handbook:AMD64/Portage/CustomTree">Custom Portage tree</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced.html" title="Handbook:AMD64/Portage/Advanced">Advanced features</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> Network configuration
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction.html" title="Handbook:AMD64/Networking/Introduction">Getting started</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced.html" title="Handbook:AMD64/Networking/Advanced">Advanced configuration</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular.html" title="Handbook:AMD64/Networking/Modular">Modular networking</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless.html" title="Handbook:AMD64/Networking/Wireless">Wireless</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending.html" title="Handbook:AMD64/Networking/Extending">Adding functionality</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic.html" title="Handbook:AMD64/Networking/Dynamic">Dynamic management</a>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id="System_logger">System logger</span></h2>
<p>Some tools are missing from the stage3 archive because several packages provide the same functionality. It is now up to the user to choose which ones to install.
</p><p>The first tool to decide on has to provide logging facilities for the system. Unix and Linux have an excellent history of logging capabilities - if needed, everything that happens on the system can be logged in log files. This happens through the system logger.
</p><p>Gentoo offers several system logger utilities. A few of these include:
</p>
<ul><li> <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-admin/sysklogd">app-admin/sysklogd</a> - Offers the traditional set of system logging daemons. The default logging configuration works well for beginners which makes this package a good option for beginner.</li>
<li> <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-admin/syslog-ng">app-admin/syslog-ng</a> - An advanced system logger. Requires additional configuration in order to actually start logging. Some advanced users may choose this package.</li>
<li> <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-admin/metalog">app-admin/metalog</a> - A highly-configurable system logger.</li></ul>
<p>Others are available through Portage as well - the number of available packages increases on a daily basis.
</p><p>If sysklogd or syslog-ng are going to be used, it is recommended to install <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-admin/logrotate">app-admin/logrotate</a> afterwards as those system loggers don't provide any rotation mechanism for the log files.
</p><p>To install the system logger of choice, emerge it and have it added to the default runlevel using <span style="font-family: monospace; font-size: 95%; font-weight: bold;">rc-update</span>. The following example installs <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/app-admin/sysklogd">app-admin/sysklogd</a>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask app-admin/sysklogd</code></div></div> 
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>rc-update add sysklogd default</code></div></div>
<h2><span class="mw-headline" id="Optional:_Cron_daemon">Optional: Cron daemon</span></h2>
<p>Next is the cron daemon. Although it is optional and not required for every system, it is wise to install one.
</p><p>A cron daemon executes scheduled commands. It is very handy if some command needs to be executed regularly (for instance daily, weekly or monthly).
</p><p>Gentoo offers several possible cron daemons, including <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-process/bcron">sys-process/bcron</a>, <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-process/dcron">sys-process/dcron</a>, <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-process/fcron">sys-process/fcron</a>, and <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-process/cronie">sys-process/cronie</a>. Installing one of them is similar to installing a system logger. The following example uses <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-process/cronie">sys-process/cronie</a>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask sys-process/cronie</code></div></div> 
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>rc-update add cronie default</code></div></div>
<p>If dcron or fcron are used, an additional initialization command needs to be executed:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>crontab /etc/crontab</code></div></div>
<h2><span class="mw-headline" id="Optional:_File_indexing">Optional: File indexing</span></h2>
<p>In order to index the file system to provide faster file location capabilities, install <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-apps/mlocate">sys-apps/mlocate</a>.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask sys-apps/mlocate</code></div></div> 
<h2><span class="mw-headline" id="Optional:_Remote_access">Optional: Remote access</span></h2>
<p>To be able to access the system remotely after installation, add the <span style="font-family: monospace; font-size: 95%">sshd</span> init script to the default runlevel:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>rc-update add sshd default</code></div></div>
<p>If serial console access is needed (which is possible in case of remote servers), uncomment the serial console section in <span style="font-family: monospace; font-size: 95%">/etc/inittab</span>:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>nano -w /etc/inittab</code></div><pre>
# SERIAL CONSOLES
s0:12345:respawn:/sbin/agetty 9600 ttyS0 vt100
s1:12345:respawn:/sbin/agetty 9600 ttyS1 vt100
</pre></div>
<h2><span class="mw-headline" id="Filesystem_tools">Filesystem tools</span></h2>
<p>Depending on the filesystems used, it is necessary to install the necessary file system utilities (for checking the filesystem integrity, creating additional file systems etc.). Note that tools for managing ext2, ext3, or ext4 filesystems (e2fsprogs) are already installed as a part of the <a href="../../../System_set_(Portage).html" title="System set (Portage)">system set</a>.
</p><p>The following table lists the tools to install if a certain filesystem is used:
</p>
<table class="table table-condensed table-striped" style="text-align: left;">

<tr>
<th scope="col" width="20%"> Filesystem
</th>
<th> Package
</th></tr>
<tr>
<td> Ext2, 3, and 4
</td>
<td> <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-fs/e2fsprogs">sys-fs/e2fsprogs</a>
</td></tr>
<tr>
<td> XFS
</td>
<td> <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-fs/xfsprogs">sys-fs/xfsprogs</a>
</td></tr>
<tr>
<td> ReiserFS
</td>
<td> <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-fs/reiserfsprogs">sys-fs/reiserfsprogs</a>
</td></tr>
<tr>
<td> JFS
</td>
<td> <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-fs/jfsutils">sys-fs/jfsutils</a>
</td></tr>
<tr>
<td> VFAT (FAT32, ...)
</td>
<td> <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-fs/dosfstools">sys-fs/dosfstools</a>
</td></tr>
<tr>
<td> Btrfs
</td>
<td> <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/sys-fs/btrfs-progs">sys-fs/btrfs-progs</a>
</td></tr></table>
<div class="alert alert-success gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong>Tip</strong><br />For more information on filesystems in Gentoo see the <a href="../../../Filesystem.html" title="Filesystem">filesystem article</a>.</div>
<h2><span class="mw-headline" id="Networking_tools">Networking tools</span></h2>
<p>If there is no need for any additional networking tools, continue immediately with the section on <a href="../../Installation/Bootloader.html" title="Handbook:AMD64/Installation/Bootloader">Configuring a bootloader</a>.
</p>
<h3><span class="mw-headline" id="Installing_a_DHCP_client">Installing a DHCP client</span></h3>
<div class="alert alert-warning gw-box" style="padding-top: 8px; padding-bottom: 8px;"><strong><i class="fa fa-exclamation-circle"></i> Important</strong><br />Although optional, the majority of users will find that they need a DHCP client to connect to the DHCP server on their network. Please take this opportunity to install a DHCP client. If this step is forgotten, then the system might not be able to get on the network thus making it impossible to download a DHCP client afterward.</div>
<p>In order for the system to automatically obtain an IP address for one or more network interface(s) using netifrc scripts, it is necessary to install a DHCP client. We recommend the use of <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/net-misc/dhcpcd">net-misc/dhcpcd</a> although many other DHCP clients are available through the Portage tree:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask net-misc/dhcpcd</code></div></div> 
<p>More information on <span style="font-family: monospace; font-size: 95%; font-weight: bold;">dhcpcd</span> can be found in the <a href="../../../Dhcpcd.html" title="Dhcpcd">dhcpcd article</a>.
</p>
<h3><span class="mw-headline" id="Optional:_Installing_a_PPPoE_client">Optional: Installing a PPPoE client</span></h3>
<p>If PPP is used to connect to the internet, install the <a rel="nofollow" class="external text" href="https://packages.gentoo.org/packages/net-dialup/ppp">net-dialup/ppp</a> package:
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>emerge --ask net-dialup/ppp</code></div></div> 
<p>Now continue with <a href="../../Installation/Bootloader.html" title="Handbook:AMD64/Installation/Bootloader">Configuring the bootloader</a>.
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../Installation/System.html" title="Previous part" class="btn btn-default">&#8592; Configuring the system</a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Installation/Bootloader.html" title="Next part" class="btn btn-default">Configuring the bootloader &#8594;</a></div>
<p><br />
</p><p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 安装
</th></tr>
<tr>
<td> <a href="../../Installation/About/zh-cn.html" title="Handbook:AMD64/Installation/About/zh-cn">关于安装</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media/zh-cn.html" title="Handbook:AMD64/Installation/Media/zh-cn">选择安装媒介</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking/zh-cn.html" title="Handbook:AMD64/Installation/Networking/zh-cn">配置网络</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks/zh-cn.html" title="Handbook:AMD64/Installation/Disks/zh-cn">准备磁盘</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage/zh-cn.html" title="Handbook:AMD64/Installation/Stage/zh-cn">安装stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base/zh-cn.html" title="Handbook:AMD64/Installation/Base/zh-cn">安装基本系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel/zh-cn.html" title="Handbook:AMD64/Installation/Kernel/zh-cn">配置Linux内核</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System/zh-cn.html" title="Handbook:AMD64/Installation/System/zh-cn">配置系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools/zh-cn.html" title="Handbook:AMD64/Installation/Tools/zh-cn">安装系统工具</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader/zh-cn.html" title="Handbook:AMD64/Installation/Bootloader/zh-cn">配置系统引导程序Bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing/zh-cn.html" title="Handbook:AMD64/Installation/Finalizing/zh-cn">收尾安装工作</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage/zh-cn.html" title="Handbook:AMD64/Working/Portage/zh-cn">Portage介绍</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE/zh-cn.html" title="Handbook:AMD64/Working/USE/zh-cn">USE标记</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features/zh-cn.html" title="Handbook:AMD64/Working/Features/zh-cn">Portage功能特性</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts/zh-cn.html" title="Handbook:AMD64/Working/Initscripts/zh-cn">初始化脚本（Initscript）系统</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar/zh-cn.html" title="Handbook:AMD64/Working/EnvVar/zh-cn">环境变量</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files/zh-cn.html" title="Handbook:AMD64/Portage/Files/zh-cn">文件和目录</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables/zh-cn.html" title="Handbook:AMD64/Portage/Variables/zh-cn">变量</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches/zh-cn.html" title="Handbook:AMD64/Portage/Branches/zh-cn">混合使用不同的软件分支</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools/zh-cn.html" title="Handbook:AMD64/Portage/Tools/zh-cn">额外的工具</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree/zh-cn.html" title="Handbook:AMD64/Portage/CustomTree/zh-cn">定制Portage树</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced/zh-cn.html" title="Handbook:AMD64/Portage/Advanced/zh-cn">高级特性</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 网络配置
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction/zh-cn.html" title="Handbook:AMD64/Networking/Introduction/zh-cn">入门</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced/zh-cn.html" title="Handbook:AMD64/Networking/Advanced/zh-cn">高级配置</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular/zh-cn.html" title="Handbook:AMD64/Networking/Modular/zh-cn">模块化网络</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless/zh-cn.html" title="Handbook:AMD64/Networking/Wireless/zh-cn">无线</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending/zh-cn.html" title="Handbook:AMD64/Networking/Extending/zh-cn">添加功能</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic/zh-cn.html" title="Handbook:AMD64/Networking/Dynamic/zh-cn">动态管理</a>
</td></tr></table>
<p><br />
<a href="https://wiki.gentoo.org/index.php?title=Handbook:AMD64/Blocks/Bootloader/zh-cn&amp;action=edit&amp;redlink=1" class="new" title="Handbook:AMD64/Blocks/Bootloader/zh-cn (page does not exist)">Handbook:AMD64/Blocks/Bootloader/zh-cn</a>
</p>
<h2><span class="mw-headline" id=".E9.87.8D.E5.90.AF.E7.B3.BB.E7.BB.9F">重启系统</span></h2>
<p>退出chroot环境并unmount全部已持载分区。然后敲入一条有魔力的命令来初始化最终的、真实的测试：<span style="font-family: monospace; font-size: 95%; font-weight: bold;">reboot</span>。
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>exit</code></div></div>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">cdimage ~#</code><span class="tripleclick-separator"></span><code>cd
</code></div><div><code style="color: #ef2929; font-weight: bold;">cdimage ~#</code><span class="tripleclick-separator"></span><code>umount -l /mnt/gentoo/dev{/shm,/pts,}
</code></div><div><code style="color: #ef2929; font-weight: bold;">cdimage ~#</code><span class="tripleclick-separator"></span><code>umount /mnt/gentoo{/boot,/sys,/proc,}
</code></div><div><code style="color: #ef2929; font-weight: bold;">cdimage ~#</code><span class="tripleclick-separator"></span><code>reboot</code></div></div>
<p>当然，别忘了移除可引导CD，否则可能再次从CD启动，而不是新的Gentoo系统。
</p><p>当重启进全新安装的Gentoo环境，继续完成<a href="../../Installation/Finalizing.html" title="Handbook:AMD64/Installation/Finalizing">Finalizing the Gentoo installation</a>。
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../Installation/Tools.html" title="Previous part" class="btn btn-default">&#8592; Installing tools</a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Installation/Finalizing.html" title="Next part" class="btn btn-default">Finalizing &#8594;</a></div>
<p><br />
</p><p><br />
</p>
<div class="mw-pt-languages noprint" lang="en" dir="ltr"><div class="mw-pt-languages-label">Other languages:</div><div class="mw-pt-languages-list autonym"><a href="de.html" title="Handbuch:AMD64/Komplett/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">Deutsch</a> • ‎<a href="../Installation.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-languages-ui mw-pt-progress mw-pt-progress--complete">English</a> • ‎<a href="es.html" title="Handbook:AMD64/Full/Installation/es (100% translated)" class="mw-pt-progress mw-pt-progress--complete">español</a> • ‎<a href="fr.html" title="Handbook:AMD64/Full/Installation/fr (100% translated)" class="mw-pt-progress mw-pt-progress--complete">français</a> • ‎<a href="ja.html" title="ハンドブック:AMD64/フル/インストール (100% translated)" class="mw-pt-progress mw-pt-progress--complete">日本語</a> • ‎<a href="ko.html" title="Handbook:AMD64/Full/Installation/ko (100% translated)" class="mw-pt-progress mw-pt-progress--complete">한국어</a> • ‎<a href="pt-br.html" title="Manual:AMD64/Completo/Instalação (100% translated)" class="mw-pt-progress mw-pt-progress--complete">português do Brasil</a> • ‎<a href="ru.html" title="Handbook:AMD64/Full/Installation (100% translated)" class="mw-pt-progress mw-pt-progress--complete">русский</a> • ‎<span class="mw-pt-languages-selected mw-pt-progress mw-pt-progress--complete">中文（中国大陆）‎</span></div></div>
<table style="width: 15em; font-size: 90%; border: 1px solid #463c65; background-color: #f9f9f9; color: black; margin-bottom: 0.5em; margin-left: 1em; padding: 0.2em; float: right; clear: right; text-align:center;">
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 安装
</th></tr>
<tr>
<td> <a href="../../Installation/About/zh-cn.html" title="Handbook:AMD64/Installation/About/zh-cn">关于安装</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Media/zh-cn.html" title="Handbook:AMD64/Installation/Media/zh-cn">选择安装媒介</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Networking/zh-cn.html" title="Handbook:AMD64/Installation/Networking/zh-cn">配置网络</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Disks/zh-cn.html" title="Handbook:AMD64/Installation/Disks/zh-cn">准备磁盘</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Stage/zh-cn.html" title="Handbook:AMD64/Installation/Stage/zh-cn">安装stage3</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Base/zh-cn.html" title="Handbook:AMD64/Installation/Base/zh-cn">安装基本系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Kernel/zh-cn.html" title="Handbook:AMD64/Installation/Kernel/zh-cn">配置Linux内核</a>
</td></tr>
<tr>
<td> <a href="../../Installation/System/zh-cn.html" title="Handbook:AMD64/Installation/System/zh-cn">配置系统</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Tools/zh-cn.html" title="Handbook:AMD64/Installation/Tools/zh-cn">安装系统工具</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Bootloader/zh-cn.html" title="Handbook:AMD64/Installation/Bootloader/zh-cn">配置系统引导程序Bootloader</a>
</td></tr>
<tr>
<td> <a href="../../Installation/Finalizing/zh-cn.html" title="Handbook:AMD64/Installation/Finalizing/zh-cn">收尾安装工作</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Gentoo
</th></tr>
<tr>
<td> <a href="../../Working/Portage/zh-cn.html" title="Handbook:AMD64/Working/Portage/zh-cn">Portage介绍</a>
</td></tr>
<tr>
<td> <a href="../../Working/USE/zh-cn.html" title="Handbook:AMD64/Working/USE/zh-cn">USE标记</a>
</td></tr>
<tr>
<td> <a href="../../Working/Features/zh-cn.html" title="Handbook:AMD64/Working/Features/zh-cn">Portage功能特性</a>
</td></tr>
<tr>
<td> <a href="../../Working/Initscripts/zh-cn.html" title="Handbook:AMD64/Working/Initscripts/zh-cn">初始化脚本（Initscript）系统</a>
</td></tr>
<tr>
<td> <a href="../../Working/EnvVar/zh-cn.html" title="Handbook:AMD64/Working/EnvVar/zh-cn">环境变量</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 使用Portage
</th></tr>
<tr>
<td> <a href="../../Portage/Files/zh-cn.html" title="Handbook:AMD64/Portage/Files/zh-cn">文件和目录</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Variables/zh-cn.html" title="Handbook:AMD64/Portage/Variables/zh-cn">变量</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Branches/zh-cn.html" title="Handbook:AMD64/Portage/Branches/zh-cn">混合使用不同的软件分支</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Tools/zh-cn.html" title="Handbook:AMD64/Portage/Tools/zh-cn">额外的工具</a>
</td></tr>
<tr>
<td> <a href="../../Portage/CustomTree/zh-cn.html" title="Handbook:AMD64/Portage/CustomTree/zh-cn">定制Portage树</a>
</td></tr>
<tr>
<td> <a href="../../Portage/Advanced/zh-cn.html" title="Handbook:AMD64/Portage/Advanced/zh-cn">高级特性</a>
</td></tr>
<tr>
<th style="text-align: center; background-color:#54487a; color: white;"> 网络配置
</th></tr>
<tr>
<td> <a href="../../Networking/Introduction/zh-cn.html" title="Handbook:AMD64/Networking/Introduction/zh-cn">入门</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Advanced/zh-cn.html" title="Handbook:AMD64/Networking/Advanced/zh-cn">高级配置</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Modular/zh-cn.html" title="Handbook:AMD64/Networking/Modular/zh-cn">模块化网络</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Wireless/zh-cn.html" title="Handbook:AMD64/Networking/Wireless/zh-cn">无线</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Extending/zh-cn.html" title="Handbook:AMD64/Networking/Extending/zh-cn">添加功能</a>
</td></tr>
<tr>
<td> <a href="../../Networking/Dynamic/zh-cn.html" title="Handbook:AMD64/Networking/Dynamic/zh-cn">动态管理</a>
</td></tr></table>
<p><br />
</p>
<h2><span class="mw-headline" id="User_administration">User administration</span></h2>
<h3><span class="mw-headline" id="Adding_a_user_for_daily_use">Adding a user for daily use</span></h3>
<p>在Unix/Linux系统中，用root进行工作是一件危险的事情，应该尽量避免。因此我们强烈推荐您为日常使用添加一个普通用户。
</p><p>用户所属的组定义了其可以执行的活动。下表中列出了许多您可能希望使用的重要组：
</p>
<table class="table table-condensed table-striped" style="text-align: left; width: auto;">

<tr>
<th scope="col" width="25%"> Group
</th>
<th scope="col" width="75%"> Description
</th></tr>
<tr>
<td> audio
</td>
<td> 允许使用声音设备
</td></tr>
<tr>
<td> cdrom
</td>
<td> 允许直接使用光驱设备
</td></tr>
<tr>
<td> floppy
</td>
<td> 允许直接使用软驱
</td></tr>
<tr>
<td> games
</td>
<td> 允许运行游戏
</td></tr>
<tr>
<td> portage
</td>
<td> 能够访问portage受限资源。
</td></tr>
<tr>
<td> usb
</td>
<td> 允许使用USB设备
</td></tr>
<tr>
<td> video
</td>
<td> 允许使用视频采集设备和硬件加速
</td></tr>
<tr>
<td> wheel
</td>
<td> 可以使用<span style="font-family: monospace; font-size: 95%; font-weight: bold;">su</span>.
</td></tr></table>
<p>For instance, to create a user called <a href="../../../User_Larry.html" title="User:Larry">larry</a> who is member of the <i>wheel</i>, <i>users</i>, and <i>audio</i> groups, log in as root first (only root can create users) and run <span style="font-family: monospace; font-size: 95%; font-weight: bold;">useradd</span>:
</p>
<div class="cmd-box"><div><code style="color: white; font-weight: bold;">Login:</code><span class="tripleclick-separator"></span><code>root</code></div><pre>
Password: (输入root 密码)
</pre></div>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>useradd -m -G users,wheel,audio -s /bin/bash larry
</code></div><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>passwd larry</code></div><pre>
Password: (输入larry的密码)
Re-enter password: (重复输入密码)
</pre></div>
<p>If a user ever needs to perform some task as root, they can use <span style="font-family: monospace; font-size: 95%; font-weight: bold;">su -</span> to temporarily receive root privileges. Another way is to use the <a href="../../../Sudo.html" title="Sudo">sudo</a> package which is, if correctly configured, very secure.
</p>
<h2><span class="mw-headline" id=".E7.A3.81.E7.9B.98.E6.B8.85.E7.90.86">磁盘清理</span></h2>
<h3><span class="mw-headline" id="Removing_tarballs">Removing tarballs</span></h3>
<p>With the Gentoo installation finished and the system rebooted, if everything has gone well, we can now remove the downloaded stage3 tarball from the hard disk. Remember that they were downloaded to the <span style="font-family: monospace; font-size: 95%">/</span> directory.
</p>
<div class="cmd-box"><div><code style="color: #ef2929; font-weight: bold;">root #</code><span class="tripleclick-separator"></span><code>rm /stage3-*.tar.bz2*</code></div></div>
<h2><span class="mw-headline" id=".E4.B8.8B.E4.B8.80.E6.AD.A5.E8.AF.A5.E5.81.9A.E4.BB.80.E4.B9.88.EF.BC.9F">下一步该做什么？</span></h2>
<h3><span class="mw-headline" id=".E6.96.87.E6.A1.A3">文档</span></h3>
<p>但接下来往何处去？现在您拥有什么样的选择？先探索些什么？Gentoo为它的用户提供了大量的可能性，因此也有大量已经提供文档（少量没有）的特性。
</p><p>Definitely take a look at the next part of the Gentoo Handbook entitled <a href="../../Working/Portage.html" title="Handbook:AMD64/Working/Portage">Working with Gentoo</a> which explains how to keep the software up to date, how to install more software, what USE flags are, how the Gentoo init system works, etc.
</p><p>Apart from the handbook, you should also feel encouraged to explore other corners of the Gentoo Wiki to find additional, community-provided documentation. The Gentoo documentation team also offers a <a href="../../../Project_Documentation/Overview.html" title="Project:Documentation/Overview">Documentation overview</a> which lists a fine selection of Wiki articles. For instance, it refers to the <a href="../../../Localization/HOWTO.html" title="Localization/HOWTO" class="mw-redirect">localization guide</a> to make a system feel more at home.
</p>
<h3><span class="mw-headline" id=".E7.BA.BF.E4.B8.8AGentoo">线上Gentoo</span></h3>
<p>Everyone is of course always welcome on our <a rel="nofollow" class="external text" href="https://forums.gentoo.org/">Gentoo forums</a> or on one of our many <a rel="nofollow" class="external text" href="https://www.gentoo.org/get-involved/irc-channels/">Gentoo IRC channels</a>.
</p><p>We also have <a rel="nofollow" class="external text" href="https://www.gentoo.org/get-involved/mailing-lists/">several mailing lists</a> open to all our users. Information on how to join is contained in that page.
</p><p>Enjoy your installation!&#160;:)
</p><p><br />
</p>
<div class="btn-group btn-group-justified"><a href="../../Installation/Bootloader.html" title="Previous part" class="btn btn-default">&#8592; Configuring the bootloader</a> <a href="../../../Handbook_AMD64.html" title="Handbook:AMD64" class="btn btn-default">Home</a> <a href="../../Working/Portage.html" title="Next part" class="btn btn-default"> &#8594;</a></div>
<p><br />
</p><p><br />
<span class="error"><strong>Warning:</strong> Display title "Gentoo Linux  手册：安装Gentoo" overrides earlier display title "手册：AMD64/完整/安装".</span>
</p><p><br />
</p>
<!-- 
NewPP limit report
Cached time: 20160112144226
Cache expiry: 86400
Dynamic content: false
CPU time usage: 4.916 seconds
Real time usage: 5.212 seconds
Preprocessor visited node count: 22789/1000000
Preprocessor generated node count: 15827/1000000
Post‐expand include size: 1126800/2097152 bytes
Template argument size: 76492/2097152 bytes
Highest expansion depth: 17/40
Expensive parser function count: 0/100
-->

<!-- 
Transclusion expansion time report (%,ms,calls,template)
100.00% 3635.109      1 - -total
100.00% 3635.109      1 - Handbook:Parts/Full/Installation/zh-cn
 31.57% 1147.728    126 - Template:RootCmd
 29.83% 1084.507    151 - Template:GenericCmd
 15.90%  577.832      1 - Handbook:AMD64/Installation/Disks/zh-cn
 15.80%  574.451      1 - Handbook:Parts/Installation/Disks/zh-cn
 15.18%  551.874      8 - Handbook:Parts/TOC/zh-cn
 13.39%  486.686      1 - Handbook:AMD64/Installation/Base/zh-cn
 13.29%  483.016      1 - Handbook:Parts/Installation/Base/zh-cn
 11.69%  425.050      1 - Handbook:AMD64/Installation/Media/zh-cn
-->

<!-- Saved in parser cache with key gentoo-wiki:pcache:idhash:73576-0!*!0!!en!*!* and timestamp 20160112144221 and revision id 313126
 -->
</div><div class="printfooter">
Retrieved from "<a dir="ltr" href="http://wiki.gentoo.org/index.php?title=Handbook:AMD64/Full/Installation/zh-cn&amp;oldid=313126">http://wiki.gentoo.org/index.php?title=Handbook:AMD64/Full/Installation/zh-cn&amp;oldid=313126</a>"</div>
															<div id='catlinks' class='catlinks catlinks-allhidden'></div>														<!-- end content -->

													</div>
					</div>
				</div>
			</div>
		</div>

			<footer>
		<div class="container">
			<div class="row">
				<div class="col-xs-12 col-md-offset-2 col-md-7">
											<div class="spacer"></div>
						<ul id="f-list">
																							<li id="lastmod"> This page was last modified on 17 May 2015, at 18:58.</li>
																															<li id="privacy"><a href="../../../Gentoo_Wiki_Privacy_policy.html" title="Gentoo Wiki:Privacy policy">Privacy policy</a></li>
																							<li id="about"><a href="../../../Gentoo_Wiki_About.html" title="Gentoo Wiki:About">About Gentoo Wiki</a></li>
																							<li id="disclaimer"><a href="../../../Gentoo_Wiki_General_disclaimer.html" title="Gentoo Wiki:General disclaimer">Disclaimers</a></li>
													</ul>
									</div>
				<div class="col-xs-12 col-md-3">
					<!-- No questions or comments, the Wiki has enough information on how to contact us. -->
				</div>
			</div>
			<div class="row">
				<div class="col-xs-3 col-md-2">
					<ul class="footerlinks three-icons">
						<li><a href="https://twitter.com/gentoo" title="@Gentoo on Twitter"><span class="fa fa-twitter fa-fw"></span></a></li>
						<li><a href="https://plus.google.com/+Gentoo" title="+Gentoo on Google+"><span class="fa fa-google-plus fa-fw"></span></a></li>
						<li><a href="https://www.facebook.com/gentoo.org" title="Gentoo on Facebook"><span class="fa fa-facebook fa-fw"></span></a></li>
					</ul>
				</div>
				<div class="col-xs-9 col-md-9">
					<strong>&copy; 2001&ndash;2016 Gentoo Foundation, Inc.</strong><br />
					<small>
						Gentoo is a trademark of the Gentoo Foundation, Inc.
						The contents of this document, unless otherwise expressly stated, are licensed under the
						<a href="https://creativecommons.org/licenses/by-sa/3.0/" rel="license">CC-BY-SA-3.0</a> license.
						The <a href="https://www.gentoo.org/inside-gentoo/foundation/name-logo-guidelines.html">Gentoo Name and Logo Usage Guidelines</a> apply.
					</small>
				</div>
			</div>
		</div>
	</footer>
	
		<script>
			window.RLQ = window.RLQ || []; window.RLQ.push( function () {
				$.getScript("https://1b9a50f4f9de4348cd9f-e703bc50ba0aa66772a874f8c7698be7.ssl.cf5.rackcdn.com/bootstrap.min.js");
			} );
		</script>
		<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.state({"user":"ready","user.groups":"ready"});
} );</script>
<link rel="stylesheet" href="https://wiki.gentoo.org/load.php?debug=false&amp;lang=en&amp;modules=mediawiki.skinning.content.externallinks&amp;only=styles&amp;skin=tyrian" />
<script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.loader.load(["ext.smw.tooltips","mediawiki.toc","mediawiki.action.view.postEdit","site","mediawiki.user","mediawiki.hidpi","mediawiki.page.ready","mediawiki.searchSuggest","ext.uls.pt"]);
} );</script><script type="text/javascript">
  var _paq = _paq || [];
  _paq.push(['setDocumentTitle', "Handbook:AMD64/Full/Installation/zh-cn"]);
  _paq.push(['setIgnoreClasses', 'image']);
  _paq.push(['trackPageView']);
  _paq.push(['disableCookies']);
  _paq.push(['enableLinkTracking']);
  
  (function() {
    var u="http://piwik.gentoo.org//";
    _paq.push(['setTrackerUrl', u+'piwik.php']);
    _paq.push(['setSiteId', 1]);
    var d=document, g=d.createElement('script'), s=d.getElementsByTagName('script')[0];
    g.type='text/javascript'; g.async=true; g.defer=true; g.src=u+'piwik.js'; s.parentNode.insertBefore(g,s);
  })();
</script>
<noscript><p><img src="http://piwik.gentoo.org//piwik.php?idsite=1" style="border:0;" alt="" /></p></noscript><script>window.RLQ = window.RLQ || []; window.RLQ.push( function () {
mw.config.set({"wgBackendResponseTime":5458});
} );</script></body>
<!-- Mirrored from wiki.gentoo.org/wiki/Handbook:AMD64/Full/Installation/zh-cn by HTTrack Website Copier/3.x [XR&CO'2014], Tue, 12 Jan 2016 17:23:43 GMT -->
</html>